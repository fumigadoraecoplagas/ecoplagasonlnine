<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentaci贸n T茅cnica - EcoPlagas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="eco-plagas-styles.css" rel="stylesheet">
    <script src="check-permissions.js"></script>
    <script type="module" src="csrf-token.js"></script>
    
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --accent-color: #FF9800;
            --text-dark: #333;
            --text-light: #666;
            --bg-light: #f8f9fa;
            --border-color: #dee2e6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.7;
            color: var(--text-dark);
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .training-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .training-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #45a049 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .training-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .training-header p {
            font-size: 1.2rem;
            opacity: 0.95;
        }

        .sidebar {
            position: sticky;
            top: 20px;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .sidebar h3 {
            color: var(--primary-color);
            font-size: 1.3rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .sidebar .nav-link {
            color: var(--text-dark);
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 5px;
            transition: all 0.3s;
            text-decoration: none;
            display: block;
        }

        .sidebar .nav-link:hover {
            background: var(--bg-light);
            color: var(--primary-color);
            transform: translateX(5px);
        }

        .sidebar .nav-link.active {
            background: var(--primary-color);
            color: white;
        }

        .content-section {
            background: white;
            border-radius: 10px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            scroll-margin-top: 20px;
        }

        .content-section h2 {
            color: var(--primary-color);
            font-size: 2rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--primary-color);
        }

        .content-section h3 {
            color: var(--secondary-color);
            font-size: 1.5rem;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        .content-section h4 {
            color: var(--accent-color);
            font-size: 1.2rem;
            margin-top: 25px;
            margin-bottom: 12px;
        }

        .diagram-container {
            background: var(--bg-light);
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
            border: 2px dashed var(--border-color);
        }

        .diagram {
            text-align: center;
            margin: 20px 0;
        }

        .diagram-box {
            display: inline-block;
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            padding: 15px 25px;
            margin: 10px;
            min-width: 150px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .diagram-box.primary {
            background: var(--primary-color);
            color: white;
        }

        .diagram-box.secondary {
            background: var(--secondary-color);
            color: white;
        }

        .diagram-box.accent {
            background: var(--accent-color);
            color: white;
        }

        .diagram-arrow {
            font-size: 2rem;
            color: var(--primary-color);
            margin: 10px 0;
        }

        .info-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 5px solid var(--secondary-color);
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .warning-box {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left: 5px solid var(--accent-color);
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .success-box {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            border-left: 5px solid var(--primary-color);
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        .code-example {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .step-number {
            display: inline-block;
            width: 35px;
            height: 35px;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: bold;
            margin-right: 10px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            border-color: var(--primary-color);
        }

        .feature-card i {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--primary-color);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s;
            opacity: 0;
            visibility: hidden;
        }

        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }

        /* Estilos para Retos (Gamificados) */
        .quiz-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 3px solid #ffd700;
            border-radius: 16px;
            padding: 25px;
            margin: 30px 0;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4), 0 0 20px rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .quiz-container::before {
            content: '';
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 2.5rem;
            opacity: 0.2;
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .quiz-container:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5), 0 0 30px rgba(255, 215, 0, 0.4);
        }
        .quiz-container.quiz-cooldown-active {
            opacity: 0.6;
            pointer-events: none;
            position: relative;
        }
        .quiz-container.quiz-cooldown-active::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 16px;
            z-index: 1;
        }
        .quiz-container.quiz-cooldown-active .quiz-questions {
            opacity: 0.5 !important;
            pointer-events: none !important;
        }
        .quiz-container.quiz-cooldown-active .btn-reto {
            opacity: 0.5 !important;
            cursor: not-allowed !important;
        }
        .quiz-container h3 {
            color: #ffd700;
            margin-bottom: 20px;
            font-size: 1.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5), 0 0 10px rgba(255, 215, 0, 0.5);
            font-weight: 700;
        }
        .quiz-container .quiz-questions {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 12px;
            padding: 25px;
            margin-top: 15px;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }
        .quiz-question {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .quiz-question:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        .quiz-question p {
            font-weight: 700;
            margin-bottom: 15px;
            color: #333;
            font-size: 1.05rem;
        }
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .quiz-options label {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-weight: 500;
        }
        .quiz-options label:hover {
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            border-color: #667eea;
            transform: translateX(8px) scale(1.02);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }
        .quiz-options input[type="radio"] {
            margin-right: 12px;
            cursor: pointer;
            width: 20px;
            height: 20px;
            accent-color: #667eea;
        }
        .quiz-options input[type="radio"]:checked + label,
        .quiz-options label:has(input[type="radio"]:checked) {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #ffd700;
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        .quiz-result {
            margin-top: 20px;
            padding: 25px;
            border-radius: 12px;
            display: none;
            font-size: 1.2rem;
            font-weight: 700;
            text-align: center;
            animation: slideIn 0.5s ease;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        @keyframes celebrate {
            0%, 100% { transform: scale(1) rotate(0deg); }
            25% { transform: scale(1.1) rotate(-5deg); }
            50% { transform: scale(1.15) rotate(5deg); }
            75% { transform: scale(1.1) rotate(-5deg); }
        }
        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }
        .quiz-result.show {
            display: block;
        }
        .quiz-result.success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            border: 3px solid #ffd700;
            color: white;
            box-shadow: 0 8px 24px rgba(17, 153, 142, 0.4), 0 0 30px rgba(255, 215, 0, 0.5);
            animation: slideIn 0.5s ease, celebrate 0.6s ease 0.5s;
        }
        .quiz-result.error {
            background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            border: 3px solid #ff6b6b;
            color: white;
            box-shadow: 0 8px 24px rgba(235, 51, 73, 0.4);
        }
        .quiz-result.partial {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: 3px solid #ffa500;
            color: white;
            box-shadow: 0 8px 24px rgba(240, 147, 251, 0.4);
        }
        .reto-badge {
            display: inline-block;
            padding: 10px 18px;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            border-radius: 25px;
            font-weight: 700;
            font-size: 0.95rem;
            margin: 5px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .puntos-display {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 10px rgba(255, 215, 0, 0.5);
        }
        .estrella {
            color: #ffd700;
            font-size: 1.8rem;
            animation: spin 1s ease;
            display: inline-block;
        }
        @keyframes spin {
            from { transform: rotate(0deg) scale(0); }
            to { transform: rotate(360deg) scale(1); }
        }
        .btn-reto {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            color: #333;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .btn-reto:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.6);
        }
        .btn-reto:active {
            transform: translateY(0) scale(0.98);
        }

        .progress-container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .progress-bar-custom {
            height: 30px;
            background: #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color) 0%, #45a049 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: width 0.5s;
        }

        .quiz-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: bold;
            margin: 5px;
        }

        .quiz-badge.completed {
            background: #d4edda;
            color: #155724;
        }

        .quiz-badge.pending {
            background: #fff3cd;
            color: #856404;
        }

        .back-to-top:hover {
            transform: scale(1.1);
            background: #45a049;
        }

        /* Botones de Referencia a M贸dulos */
        .module-reference-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            margin: 10px 0;
            background: linear-gradient(135deg, var(--primary-color) 0%, #45a049 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .module-reference-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(76, 175, 80, 0.4);
            color: white;
            text-decoration: none;
        }

        .module-reference-btn i {
            font-size: 1.1rem;
        }

        .module-reference-btn-container {
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            border-radius: 5px;
        }

        /* Estilos para tarjetas de progreso de quizzes */
        .quiz-progress-card {
            background: white;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .quiz-progress-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .quiz-progress-card.quiz-pending {
            opacity: 0.7;
        }

        .quiz-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .quiz-progress-title {
            font-size: 0.85rem;
            font-weight: 600;
            margin: 0;
            color: var(--text-dark);
            flex: 1;
        }

        .quiz-progress-score {
            text-align: center;
            margin: 8px 0;
        }

        .quiz-progress-details {
            margin-top: auto;
            text-align: center;
            padding-top: 8px;
            border-top: 1px solid #eee;
        }

        .quiz-progress-details small {
            font-size: 0.75rem;
            line-height: 1.4;
        }

        .quiz-progress-card.quiz-average .quiz-progress-title {
            color: white;
        }

        .quiz-progress-card.quiz-average .quiz-progress-details {
            border-top-color: rgba(255,255,255,0.3);
        }

        @media (max-width: 768px) {
            .sidebar {
                position: relative;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Sistema de Autenticaci贸n -->
    <script type="module">
        import { auth } from './auth-secure.js';
        import { collection, query, where, getDocs, addDoc, doc, getDoc, setDoc, serverTimestamp, orderBy } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js';
        
        // Verificar autenticaci贸n
        (async function() {
            if (document.body) {
                document.body.style.display = 'none';
            }
            
            await new Promise(resolve => setTimeout(resolve, 500));
            
            if (window.location.pathname.includes('iniciar_sesion.html')) {
                return;
            }
            
            let retries = 0;
            const maxRetries = 100;
            
            while (retries < maxRetries) {
                if (auth.currentUser) {
                    if (document.body) {
                        document.body.style.display = 'block';
                    }
                    return;
                }
                await new Promise(resolve => setTimeout(resolve, 100));
                retries++;
            }
            
            if (!window.location.pathname.includes('iniciar_sesion.html')) {
                try {
                    sessionStorage.setItem('postLoginRedirect', window.location.href);
                } catch (e) {}
                window.location.replace('iniciar_sesion.html');
            }
        })();
    </script>

    <div class="training-container">
        <!-- Header -->
        <div class="training-header">
            <h1><i class="fas fa-code me-3"></i>Documentaci贸n T茅cnica</h1>
            <p>Para Desarrolladores y Administradores de ecoplagas.online</p>
            <p style="font-size: 1rem; margin-top: 10px; opacity: 0.9;">
                <i class="fas fa-info-circle me-2"></i>
                Esta documentaci贸n cubre el desarrollo, administraci贸n y mantenimiento del sistema ecoplagas.online.
            </p>
        </div>

        <!-- Dashboard de Quizzes -->
        <div id="mi-progreso" class="dashboard-quizzes-container" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 12px; padding: 25px; margin-bottom: 30px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); border: 1px solid #dee2e6;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0; color: var(--primary-color); font-weight: 600;">
                    <i class="fas fa-trophy me-2"></i>Mi Progreso en Retos
                </h3>
                <span class="badge bg-primary" style="font-size: 0.9rem; padding: 8px 12px;">20 Retos Disponibles</span>
            </div>
            <div id="dashboard-quizzes">
                <p class="text-muted text-center py-3">Cargando progreso...</p>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Navigation -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <h3><i class="fas fa-list me-2"></i>Contenido</h3>
                    <nav class="nav flex-column">
                        <a class="nav-link" href="#introduccion"><i class="fas fa-play-circle me-2"></i>Introducci贸n</a>
                        <a class="nav-link" href="#firebase"><i class="fas fa-fire me-2"></i>驴Qu茅 es Firebase?</a>
                        <a class="nav-link" href="#cursor-ai"><i class="fas fa-robot me-2"></i>驴Qu茅 es Cursor AI?</a>
                        <a class="nav-link" href="#sitio-web"><i class="fas fa-globe me-2"></i>El Sitio Web</a>
                        <a class="nav-link" href="#modulos"><i class="fas fa-cubes me-2"></i>M贸dulos del Sistema</a>
                        <a class="nav-link" href="#empezar"><i class="fas fa-rocket me-2"></i>C贸mo Empezar</a>
                        <a class="nav-link" href="#ejemplos"><i class="fas fa-code me-2"></i>Ejemplos Pr谩cticos</a>
                        <a class="nav-link" href="#casos-uso"><i class="fas fa-tasks me-2"></i>Casos de Uso Reales</a>
                        <a class="nav-link" href="#flujos-trabajo"><i class="fas fa-project-diagram me-2"></i>Flujos de Trabajo</a>
                        <a class="nav-link" href="#arquitectura"><i class="fas fa-sitemap me-2"></i>Arquitectura y Funcionamiento</a>
                        <a class="nav-link" href="#modulos-detalle"><i class="fas fa-list-alt me-2"></i>M贸dulos en Detalle</a>
                        <a class="nav-link" href="#colecciones-datos"><i class="fas fa-database me-2"></i>Colecciones de Datos</a>
                        <a class="nav-link" href="#seguridad-permisos"><i class="fas fa-shield-alt me-2"></i>Seguridad y Permisos</a>
                        <a class="nav-link" href="#inventario-avanzado"><i class="fas fa-warehouse me-2"></i>Inventario Avanzado</a>
                        <a class="nav-link" href="#reportes-analisis"><i class="fas fa-chart-bar me-2"></i>Reportes y An谩lisis</a>
                        <a class="nav-link" href="#encuestas-clientes"><i class="fas fa-clipboard-check me-2"></i>Encuestas de Clientes</a>
                        <a class="nav-link" href="#gestion-rutas"><i class="fas fa-route me-2"></i>Gesti贸n de Rutas</a>
                        <a class="nav-link" href="#desarrollo"><i class="fas fa-tools me-2"></i>Gu铆a de Desarrollo</a>
                        <a class="nav-link" href="#troubleshooting"><i class="fas fa-wrench me-2"></i>Troubleshooting</a>
                        <a class="nav-link" href="#prompts"><i class="fas fa-comments me-2"></i>Buenos y Malos Prompts</a>
                        <a class="nav-link" href="#recuperacion-emergencia"><i class="fas fa-ambulance me-2"></i>Recuperaci贸n de Emergencia</a>
                        <a class="nav-link" href="#faq"><i class="fas fa-question-circle me-2"></i>Preguntas Frecuentes</a>
                        <a class="nav-link" href="#glosario"><i class="fas fa-book me-2"></i>Glosario</a>
                        <a class="nav-link" href="#mi-progreso"><i class="fas fa-chart-line me-2"></i>Mi Progreso</a>
                    </nav>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-lg-9">
                <!-- Secci贸n: Introducci贸n -->
                <div id="introduccion" class="content-section">
                    <h2><i class="fas fa-play-circle me-2"></i>Introducci贸n</h2>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-lightbulb me-2"></i>隆Bienvenido/a!</h4>
                        <p>Esta documentaci贸n cubre el desarrollo, administraci贸n y mantenimiento del sistema ecoplagas.online.</p>
                    </div>

                    <h3>驴Qu茅 aprender谩s?</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <i class="fas fa-fire"></i>
                            <h4>Firebase</h4>
                            <p>C贸mo funciona nuestro almac茅n digital de informaci贸n</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-robot"></i>
                            <h4>Cursor AI</h4>
                            <p>Tu asistente inteligente para programar</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-globe"></i>
                            <h4>El Sitio Web</h4>
                            <p>C贸mo funciona ecoplagas.online</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-cubes"></i>
                            <h4>M贸dulos</h4>
                            <p>Todas las secciones del sistema</p>
                        </div>
                    </div>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i>Recuerda</h4>
                        <p>Esta documentaci贸n est谩 dise帽ada para ayudarte a entender, desarrollar y mantener el sistema ecoplagas.online.</p>
                    </div>
                </div>

                <!-- Secci贸n: Firebase -->
                <div id="firebase" class="content-section">
                    <h2><i class="fas fa-fire me-2"></i>驴Qu茅 es Firebase?</h2>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>En palabras simples</h4>
                        <p>Imagina que Firebase es como un <strong>almac茅n digital</strong> donde guardamos toda la informaci贸n de EcoPlagas. Es como un archivero gigante en internet donde podemos guardar y buscar datos de manera r谩pida y segura.</p>
                    </div>

                    <h3>驴Qu茅 hace Firebase por nosotros?</h3>
                    <div class="diagram-container">
                        <div class="diagram">
                            <div class="diagram-box primary">
                                <i class="fas fa-database fa-2x mb-2"></i><br>
                                <strong>Guarda Informaci贸n</strong><br>
                                <small>Citas, empleados, productos</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box secondary">
                                <i class="fas fa-shield-alt fa-2x mb-2"></i><br>
                                <strong>La Mantiene Segura</strong><br>
                                <small>Solo personas autorizadas</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box accent">
                                <i class="fas fa-sync fa-2x mb-2"></i><br>
                                <strong>Actualiza en Tiempo Real</strong><br>
                                <small>Cambios instant谩neos</small>
                            </div>
                        </div>
                    </div>

                    <h3>Conceptos Importantes</h3>
                    
                    <h4><i class="fas fa-database me-2"></i>Base de Datos (Database)</h4>
                    <ul>
                        <li>Es como una <strong>hoja de c谩lculo gigante</strong> en la nube</li>
                        <li>Tiene "colecciones" (como carpetas) que organizan la informaci贸n</li>
                        <li>Ejemplo: tenemos una colecci贸n "citas", otra "empleados", otra "productos"</li>
                    </ul>

                    <div class="diagram-container">
                        <h4>Estructura de la Base de Datos</h4>
                        <div class="diagram">
                            <div class="diagram-box primary">
                                <strong>Firebase</strong>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                                <div class="diagram-box"> Citas</div>
                                <div class="diagram-box"> Empleados</div>
                                <div class="diagram-box"> Productos</div>
                                <div class="diagram-box"> Bodegas</div>
                                <div class="diagram-box"> Reportes</div>
                            </div>
                        </div>
                    </div>

                    <h4><i class="fas fa-key me-2"></i>Autenticaci贸n (Authentication)</h4>
                    <ul>
                        <li>Es como el <strong>sistema de llaves</strong> del almac茅n</li>
                        <li>Cada persona tiene su usuario y contrase帽a</li>
                        <li>Solo puedes entrar a las partes que te corresponden</li>
                    </ul>

                    <h4><i class="fas fa-server me-2"></i>Hosting</h4>
                    <ul>
                        <li>Es donde "vive" nuestro sitio web en internet</li>
                        <li>Cuando alguien escribe <code>ecoplagas.online</code>, Firebase muestra nuestro sitio</li>
                    </ul>

                    <div class="warning-box">
                        <h4><i class="fas fa-exclamation-triangle me-2"></i>Importante</h4>
                        <p><strong>No necesitas ver Firebase directamente</strong>, solo usas el sitio web y Firebase hace el trabajo detr谩s de escena.</p>
                    </div>
                </div>

                <!-- Secci贸n: Cursor AI -->
                <div id="cursor-ai" class="content-section">
                    <h2><i class="fas fa-robot me-2"></i>驴Qu茅 es Cursor AI?</h2>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>En palabras simples</h4>
                        <p>Cursor AI es como tener un <strong>asistente inteligente</strong> que te ayuda a escribir c贸digo (instrucciones para la computadora). Es como tener un compa帽ero que sabe mucho de programaci贸n y te ayuda cuando tienes dudas.</p>
                    </div>

                    <h3>驴Para qu茅 lo usamos?</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <i class="fas fa-bolt"></i>
                            <h4>Escribir m谩s r谩pido</h4>
                            <p>Te sugiere c贸digo mientras escribes</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-bug"></i>
                            <h4>Encontrar errores</h4>
                            <p>Te ayuda a detectar problemas</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-graduation-cap"></i>
                            <h4>Aprender</h4>
                            <p>Te explica qu茅 hace cada parte</p>
                        </div>
                        <div class="feature-card">
                            <i class="fas fa-edit"></i>
                            <h4>Hacer cambios</h4>
                            <p>Modifica c贸digo seg煤n tus instrucciones</p>
                        </div>
                    </div>

                    <h3>驴C贸mo funciona Cursor AI?</h3>
                    
                    <h4><i class="fas fa-comments me-2"></i>Chat con el Asistente</h4>
                    <ul>
                        <li>Puedes escribirle en espa帽ol (o ingl茅s) lo que necesitas</li>
                        <li>Ejemplo: "Agrega un bot贸n para exportar reportes"</li>
                        <li>Cursor AI entiende y te ayuda a hacerlo</li>
                    </ul>

                    <div class="code-example">
// Ejemplo de pregunta a Cursor AI:
"驴C贸mo agrego un campo de observaciones en el formulario de citas?"
                    </div>

                    <h4><i class="fas fa-magic me-2"></i>Sugerencias Autom谩ticas</h4>
                    <ul>
                        <li>Mientras escribes c贸digo, Cursor AI sugiere c贸mo continuar</li>
                        <li>Es como el autocorrector del celular, pero para programaci贸n</li>
                    </ul>

                    <h4><i class="fas fa-search me-2"></i>B煤squeda Inteligente</h4>
                    <ul>
                        <li>Puedes preguntarle: "驴D贸nde est谩 el c贸digo que muestra las citas?"</li>
                        <li>Te muestra exactamente d贸nde est谩</li>
                    </ul>

                    <div class="success-box">
                        <h4><i class="fas fa-question-circle me-2"></i>驴Necesito saber programar?</h4>
                        <p>Cursor AI hace el trabajo pesado, t煤 le explicas qu茅 quieres hacer, y 茅l te muestra c贸mo hacerlo.</p>
                    </div>
                </div>

                <!-- Secci贸n: Sitio Web -->
                <div id="sitio-web" class="content-section">
                    <h2><i class="fas fa-globe me-2"></i>El Sitio Web de EcoPlagas</h2>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>驴Qu茅 es?</h4>
                        <p>Es nuestra <strong>herramienta principal</strong> para gestionar todo EcoPlagas. Es como un tablero de control donde puedes ver y manejar citas, empleados, inventario, reportes y mucho m谩s.</p>
                    </div>

                    <h3>驴C贸mo funciona?</h3>
                    
                    <div class="diagram-container">
                        <h4>Proceso de Acceso</h4>
                        <div class="diagram">
                            <div class="diagram-box">
                                <span class="step-number">1</span>
                                <strong>Abrir Navegador</strong><br>
                                <small>Chrome, Firefox, etc.</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <span class="step-number">2</span>
                                <strong>Escribir URL</strong><br>
                                <small>ecoplagas.online</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <span class="step-number">3</span>
                                <strong>Iniciar Sesi贸n</strong><br>
                                <small>Usuario y contrase帽a</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">
                                <span class="step-number">4</span>
                                <strong>隆Est谩s dentro!</strong><br>
                                <small>Acceso al sistema</small>
                            </div>
                        </div>
                    </div>

                    <h3>Estructura del Sitio</h3>
                    <div class="diagram-container">
                        <div class="diagram">
                            <div class="diagram-box primary" style="width: 100%;">
                                <strong>ecoplagas.online</strong>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
                                <div class="diagram-box">
                                    <i class="fas fa-calendar-alt fa-2x mb-2"></i><br>
                                    <strong>Calendario</strong><br>
                                    <small>Gestionar citas</small>
                                </div>
                                <div class="diagram-box">
                                    <i class="fas fa-clock fa-2x mb-2"></i><br>
                                    <strong>Registro Horas</strong><br>
                                    <small>Control de empleados</small>
                                </div>
                                <div class="diagram-box">
                                    <i class="fas fa-chart-bar fa-2x mb-2"></i><br>
                                    <strong>Reportes</strong><br>
                                    <small>Estad铆sticas</small>
                                </div>
                                <div class="diagram-box">
                                    <i class="fas fa-box fa-2x mb-2"></i><br>
                                    <strong>Inventario</strong><br>
                                    <small>Productos y bodegas</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h4><i class="fas fa-sync me-2"></i>Trabajo en Tiempo Real</h4>
                    <ul>
                        <li>Si alguien m谩s hace un cambio, t煤 lo ves al instante</li>
                        <li>No necesitas refrescar la p谩gina</li>
                        <li>Todo se actualiza autom谩ticamente</li>
                    </ul>

                    <!-- Quiz: Firebase -->
                    <div class="quiz-container" data-quiz-id="firebase">
                        <h3><i class="fas fa-fire me-2"></i> Reto: Dominio de Firebase</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Qu茅 es Firebase?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="firebase_q1" value="a"> Un lenguaje de programaci贸n</label>
                                    <label><input type="radio" name="firebase_q1" value="b"> Una plataforma de Google que guarda datos y autentica usuarios</label>
                                    <label><input type="radio" name="firebase_q1" value="c"> Un editor de c贸digo</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 es una colecci贸n en Firestore?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="firebase_q2" value="a"> Un archivo HTML</label>
                                    <label><input type="radio" name="firebase_q2" value="b"> Un grupo de documentos relacionados (como una carpeta)</label>
                                    <label><input type="radio" name="firebase_q2" value="c"> Un tipo de dato</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 significa que Firebase actualiza en tiempo real?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="firebase_q3" value="a"> Los cambios se ven inmediatamente sin refrescar la p谩gina</label>
                                    <label><input type="radio" name="firebase_q3" value="b"> Solo funciona durante el d铆a</label>
                                    <label><input type="radio" name="firebase_q3" value="c"> Los datos se actualizan cada hora</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 es un documento en Firestore?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="firebase_q4" value="a"> Un archivo HTML</label>
                                    <label><input type="radio" name="firebase_q4" value="b"> Un registro individual dentro de una colecci贸n (como una fila en una tabla)</label>
                                    <label><input type="radio" name="firebase_q4" value="c"> Una carpeta de archivos</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 componente de Firebase se usa para autenticar usuarios?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="firebase_q5" value="a"> Firestore</label>
                                    <label><input type="radio" name="firebase_q5" value="b"> Firebase Authentication</label>
                                    <label><input type="radio" name="firebase_q5" value="c"> Firebase Hosting</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴D贸nde se almacenan f铆sicamente los archivos del sitio web en Firebase?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="firebase_q6" value="a"> En Firestore</label>
                                    <label><input type="radio" name="firebase_q6" value="b"> En Firebase Hosting</label>
                                    <label><input type="radio" name="firebase_q6" value="c"> En Firebase Authentication</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto" onclick="enviarQuiz('firebase')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-firebase"></div>
                    </div>
                </div>

                <!-- Secci贸n: M贸dulos -->
                <div id="modulos" class="content-section">
                    <h2><i class="fas fa-cubes me-2"></i>M贸dulos del Sistema</h2>
                    
                    <div class="info-box">
                        <p>El sistema est谩 dividido en diferentes <strong>m贸dulos</strong>, cada uno con un prop贸sito espec铆fico. Aqu铆 te explicamos los principales:</p>
                    </div>

                    <h3><i class="fas fa-calendar-alt me-2"></i>1. Calendario de Servicios</h3>
                    <p><strong>Archivo:</strong> <code>calendario.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/calendario.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Calendario de Servicios
                        </a>
                    </div>
                    
                    <h4>驴Qu茅 hace?</h4>
                    <p>Gestiona todas las citas de servicio de EcoPlagas. Es el <strong>centro de operaciones</strong> donde se organizan todos los servicios que se realizar谩n cada d铆a.</p>

                    <h4>Funcionalidades principales:</h4>
                    <ul>
                        <li><strong>Ver citas del d铆a:</strong> Muestra todas las citas programadas</li>
                        <li><strong>Crear nuevas citas:</strong> Agregar citas de clientes</li>
                        <li><strong>Editar citas:</strong> Modificar informaci贸n de citas existentes</li>
                        <li><strong>Asignar rutas:</strong> Organizar citas por ruta (Ruta 1, Ruta 2, etc.)</li>
                        <li><strong>Asignar t茅cnicos:</strong> Decidir qu茅 empleado atiende cada cita</li>
                        <li><strong>Ver en mapa:</strong> Visualizar la ruta de las citas en un mapa</li>
                    </ul>

                    <!-- Quiz: M贸dulos -->
                    <div class="quiz-container" data-quiz-id="modulos">
                        <h3><i class="fas fa-cubes me-2"></i> Reto: Maestro de M贸dulos</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Qu茅 es un m贸dulo en el sistema?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="modulos_q1" value="a"> Un archivo JavaScript</label>
                                    <label><input type="radio" name="modulos_q1" value="b"> Una colecci贸n de Firestore</label>
                                    <label><input type="radio" name="modulos_q1" value="c"> Una secci贸n o p谩gina del sistema con una funci贸n espec铆fica</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴D贸nde se gestionan las citas de servicio?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="modulos_q2" value="a"> En calendario.html</label>
                                    <label><input type="radio" name="modulos_q2" value="b"> En registro_horas.html</label>
                                    <label><input type="radio" name="modulos_q2" value="c"> En admin_inventario_productos.html</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Cu谩ntas rutas hay disponibles en el sistema?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="modulos_q3" value="a"> 10 rutas</label>
                                    <label><input type="radio" name="modulos_q3" value="b"> 20 rutas (1-10 diurnas, 11-20 nocturnas)</label>
                                    <label><input type="radio" name="modulos_q3" value="c"> 5 rutas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 funcionalidad principal tiene el m贸dulo de Registro de Horas?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="modulos_q4" value="a"> Gestionar citas de clientes</label>
                                    <label><input type="radio" name="modulos_q4" value="b"> Controlar las horas trabajadas por cada empleado e iniciar/finalizar turnos</label>
                                    <label><input type="radio" name="modulos_q4" value="c"> Ver reportes de facturaci贸n</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴En qu茅 m贸dulo puedes ver estad铆sticas y an谩lisis del negocio?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="modulos_q5" value="a"> Calendario de Servicios</label>
                                    <label><input type="radio" name="modulos_q5" value="b"> Reportes Gerenciales</label>
                                    <label><input type="radio" name="modulos_q5" value="c"> Registro de Horas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 m贸dulo permite gestionar productos (insumos) y herramientas?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="modulos_q6" value="a"> M贸dulos de Inventario (admin_inventario_*.html)</label>
                                    <label><input type="radio" name="modulos_q6" value="b"> Calendario</label>
                                    <label><input type="radio" name="modulos_q6" value="c"> Reportes</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto" onclick="enviarQuiz('modulos')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-modulos"></div>
                    </div>

                    <div class="diagram-container">
                        <h4>Flujo de Trabajo en Calendario</h4>
                        <div class="diagram">
                            <div class="diagram-box">Cliente llama</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Crear cita</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Asignar ruta</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Asignar t茅cnico</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">Cita programada</div>
                        </div>
                    </div>

                    <h3><i class="fas fa-clock me-2"></i>2. Registro de Horas</h3>
                    <p><strong>Archivo:</strong> <code>registro_horas.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/registro_horas.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Registro de Horas
                        </a>
                    </div>
                    
                    <h4>驴Qu茅 hace?</h4>
                    <p>Controla las horas trabajadas por cada empleado. Es el <strong>sistema de control de asistencia</strong> que registra cu谩ndo cada t茅cnico inicia y finaliza su turno de trabajo.</p>

                    <h4>Funcionalidades Principales</h4>
                    <ul>
                        <li><strong>Iniciar Turno:</strong> Marcar el inicio del turno de trabajo (prender la app)</li>
                        <li><strong>Finalizar Turno:</strong> Marcar el final del turno (apagar la app)</li>
                        <li><strong>Ver Salario Acumulado:</strong> Muestra cu谩nto se ha devengado en el mes actual</li>
                        <li><strong>Reportes del Mes:</strong> Resumen de horas trabajadas por d铆a</li>
                        <li><strong>Competencia Paniagua:</strong> Sistema de incentivos basado en horas trabajadas</li>
                        <li><strong>Ranking:</strong> Comparaci贸n de horas trabajadas entre empleados</li>
                        <li><strong>Solicitar Vacaciones:</strong> Enviar solicitudes de d铆as libres</li>
                        <li><strong>Verificaci贸n de Inventario:</strong> Al iniciar turno, verifica inventario de APV y bodega personal</li>
                    </ul>

                    <h4>Conceptos importantes:</h4>
                    <ul>
                        <li><strong>D铆a laborable:</strong> Va de 5:00 AM a 4:59 AM del d铆a siguiente (no es un d铆a calendario normal)</li>
                        <li><strong>Jornada diurna:</strong> Trabajo durante el d铆a (5:00 AM - 5:00 PM)</li>
                        <li><strong>Jornada nocturna:</strong> Trabajo durante la noche (5:00 PM - 5:00 AM siguiente)</li>
                        <li><strong>Sesi贸n de trabajo:</strong> Cada vez que un empleado marca entrada (work_session en Firestore)</li>
                        <li><strong>Neteo Especial:</strong> Verificaci贸n de productos con saldo positivo en bodegas especiales</li>
                    </ul>

                    <h4>Ejemplo Pr谩ctico: Iniciar un Turno</h4>
                    <div class="info-box">
                        <p><strong>Escenario:</strong> Un t茅cnico llega a las 6:00 AM para iniciar su jornada diurna.</p>
                        <ol>
                            <li><strong>Abrir Registro de Horas:</strong> Ir a <code>registro_horas.html</code></li>
                            <li><strong>Seleccionar Bodega APV:</strong> Elegir el veh铆culo/bodega donde trabajar谩</li>
                            <li><strong>Click en "Iniciar Turno":</strong> Esto marca el inicio del turno</li>
                            <li><strong>Verificaci贸n de Inventario APV:</strong> El sistema muestra productos que deben estar en el veh铆culo</li>
                            <li><strong>Confirmar Inventario:</strong> Verificar que todos los productos est茅n presentes</li>
                            <li><strong>Verificaci贸n de Neteo Especial:</strong> Confirmar que productos con neteo positivo est茅n en bodega especial</li>
                            <li><strong>Turno Iniciado:</strong> El sistema comienza a contar las horas trabajadas</li>
                        </ol>
                        <p><strong>Al finalizar:</strong> Click en "Finalizar Turno" marca el fin del turno y calcula las horas totales trabajadas.</p>
                    </div>

                    <h4>Caracter铆sticas Especiales</h4>
                    <ul>
                        <li><strong>Sistema de Premios:</strong> Incentivos semanales basados en horas trabajadas</li>
                        <li><strong>Presupuesto del Mes:</strong> Muestra el salario objetivo y el progreso hacia 茅l</li>
                        <li><strong>ltimos 7 D铆as:</strong> Gr谩fico de horas trabajadas en la 煤ltima semana</li>
                        <li><strong>Liquidaci贸n de Inventario:</strong> Al finalizar turno, opci贸n de liquidar inventario usado</li>
                    </ul>

                    <h3><i class="fas fa-warehouse me-2"></i>3. Administrador de Bodega</h3>
                    <p><strong>Archivo:</strong> <code>administrador_bodega.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/administrador_bodega.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Administrador de Bodega
                        </a>
                    </div>
                    
                    <h4>驴Qu茅 es el Administrador de Bodega?</h4>
                    <p>El <strong>Administrador de Bodega</strong> es el <strong>centro de control principal</strong> para toda la gesti贸n de inventario de EcoPlagas. Es el m贸dulo m谩s completo y poderoso del sistema de inventario, dise帽ado para administradores que necesitan control total sobre productos, herramientas, bodegas, transacciones y reportes.</p>

                    <h4>驴Qui茅n puede acceder?</h4>
                    <div class="info-box">
                        <p>Para acceder a este m贸dulo, el empleado debe tener el permiso <code>administrador_bodega: true</code> en su documento de Firestore (colecci贸n <code>empleados</code>).</p>
                    </div>

                    <h4>Estructura del M贸dulo</h4>
                    <p>El m贸dulo est谩 organizado en <strong>3 grupos principales</strong> de funcionalidades:</p>

                    <h5><i class="fas fa-tasks me-2"></i>Grupo 1: Operaciones Diarias</h5>
                    <p>Funciones que se usan frecuentemente en el d铆a a d铆a:</p>
                    <ul>
                        <li><strong> Pedidos Especiales:</strong> Crear y gestionar pedidos especiales de productos o herramientas para bodegas especiales (asignadas a t茅cnicos)</li>
                        <li><strong> Liquidar Especiales:</strong> Liquidar (devolver o consumir) productos/herramientas que fueron asignados a bodegas especiales</li>
                        <li><strong> Compras:</strong> Registrar compras de productos o herramientas desde proveedores</li>
                        <li><strong> Revisar Gastos:</strong> Revisar y aprobar gastos reportados por operarios</li>
                        <li><strong> Transferencias:</strong> Mover productos/herramientas entre bodegas</li>
                    </ul>

                    <h5><i class="fas fa-cog me-2"></i>Grupo 2: Cat谩logos y Configuraci贸n</h5>
                    <p>Funciones para configurar y mantener el sistema:</p>
                    <ul>
                        <li><strong> Cat谩logo Inventario:</strong> Crear y editar productos e herramientas del inventario</li>
                        <li><strong> Bodegas:</strong> Crear y administrar ubicaciones de almacenamiento (bodegas principales, especiales, etc.)</li>
                        <li><strong> Proveedores:</strong> Crear y administrar proveedores de productos/herramientas</li>
                        <li><strong> Cuentas de Gasto:</strong> Crear y configurar cuentas contables para clasificar gastos</li>
                    </ul>

                    <h5><i class="fas fa-chart-bar me-2"></i>Grupo 3: Reportes y An谩lisis</h5>
                    <p>Funciones para analizar y auditar el inventario:</p>
                    <ul>
                        <li><strong> Dashboard:</strong> Resumen y m茅tricas clave del inventario (visualizaci贸n general)</li>
                        <li><strong> Historial:</strong> Bit谩cora completa de todos los movimientos de inventario (transacciones)</li>
                        <li><strong> Auditor铆a:</strong> Validar y revisar movimientos para detectar inconsistencias</li>
                        <li><strong> Comparaci贸n de Saldos:</strong> Ver saldos por bodega y producto en formato pivot</li>
                        <li><strong> Gastos Semanales:</strong> Ver gasto por semana por t茅cnico</li>
                        <li><strong> Recuperar Bodegas:</strong> Buscar y recrear bodegas que fueron eliminadas</li>
                        <li><strong>锔 Anomal铆as:</strong> Detectar bodegas y productos con saldo negativo (problemas de stock)</li>
                        <li><strong> Ayuda:</strong> Gu铆a de uso del sistema</li>
                    </ul>

                    <h4>Componentes Principales</h4>

                    <h5>1. Sistema de Navegaci贸n por Tarjetas</h5>
                    <p>El m贸dulo usa un sistema de <strong>tarjetas (cards)</strong> organizadas en una cuadr铆cula:</p>
                    <ul>
                        <li><strong>Dise帽o responsive:</strong> Se adapta a diferentes tama帽os de pantalla</li>
                        <li><strong>Iconos visuales:</strong> Cada funci贸n tiene un 铆cono que la identifica</li>
                        <li><strong>Colores por categor铆a:</strong> 
                            <ul>
                                <li><span style="color: #007bff;">Azul</span>: Operaciones diarias</li>
                                <li><span style="color: #28a745;">Verde</span>: Cat谩logos y configuraci贸n</li>
                                <li><span style="color: #6f42c1;">Morado</span>: Reportes y an谩lisis</li>
                                <li><span style="color: #dc3545;">Rojo</span>: Alertas y anomal铆as</li>
                                <li><span style="color: #6c757d;">Gris</span>: Ayuda</li>
                            </ul>
                        </li>
                    </ul>

                    <h5>2. Verificaci贸n de Permisos</h5>
                    <p>Al cargar la p谩gina:</p>
                    <ol>
                        <li>Se ejecuta <code>check-permissions.js</code></li>
                        <li>Verifica que el usuario tenga <code>administrador_bodega: true</code></li>
                        <li>Si no tiene permiso, muestra "Acceso Denegado" y redirige al login</li>
                        <li>Si tiene permiso, carga el contenido normalmente</li>
                    </ol>

                    <h5>3. Integraci贸n con Header</h5>
                    <p>El m贸dulo incluye el header del sistema (<code>load-headersecure.js</code>) que muestra:</p>
                    <ul>
                        <li>Men煤 de navegaci贸n a otros m贸dulos (seg煤n permisos)</li>
                        <li>Informaci贸n del usuario autenticado</li>
                        <li>Bot贸n de cerrar sesi贸n</li>
                    </ul>

                    <h4>Flujos de Trabajo Comunes</h4>

                    <h5>Flujo 1: Asignar Productos a un T茅cnico</h5>
                    <div class="diagram-container">
                        <div class="diagram">
                            <div class="diagram-box">Administrador de Bodega</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Pedidos Especiales</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Crear Pedido</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Seleccionar Bodega Especial</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">Producto asignado</div>
                        </div>
                    </div>

                    <h5>Flujo 2: Registrar una Compra</h5>
                    <div class="diagram-container">
                        <div class="diagram">
                            <div class="diagram-box">Administrador de Bodega</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Compras</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Seleccionar Proveedor</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Agregar Productos</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">Stock actualizado</div>
                        </div>
                    </div>

                    <h5>Flujo 3: Detectar Anomal铆as</h5>
                    <div class="diagram-container">
                        <div class="diagram">
                            <div class="diagram-box">Administrador de Bodega</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Anomal铆as</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Ver productos con saldo negativo</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">Revisar Historial</div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">Corregir problema</div>
                        </div>
                    </div>

                    <h4>Conceptos Importantes</h4>

                    <h5>Bodegas</h5>
                    <ul>
                        <li><strong>Bodega Principal Productos:</strong> Almac茅n principal de productos (insumos)</li>
                        <li><strong>Bodega Principal Herramientas:</strong> Almac茅n principal de herramientas</li>
                        <li><strong>Bodegas Especiales:</strong> Bodegas asignadas a t茅cnicos espec铆ficos (ej: "Sebasti谩n G. (Especial)")</li>
                        <li><strong>Bodegas de Gasto:</strong> Cuentas contables donde se registran consumos</li>
                    </ul>

                    <h5>Tipos de Transacciones</h5>
                    <ul>
                        <li><strong>compra:</strong> Compra de productos/herramientas desde proveedores</li>
                        <li><strong>gasto:</strong> Consumo de productos (se registra en cuenta de gasto)</li>
                        <li><strong>transferencia:</strong> Movimiento entre bodegas</li>
                        <li><strong>reversion:</strong> Revertir una transacci贸n anterior</li>
                        <li><strong>ajuste_entrada:</strong> Ajuste manual de stock (aumento)</li>
                        <li><strong>ajuste_salida:</strong> Ajuste manual de stock (disminuci贸n)</li>
                    </ul>

                    <h5>Productos vs Herramientas</h5>
                    <ul>
                        <li><strong>Productos:</strong> Identificados por <code>productoId</code>, son consumibles (insumos gastables)</li>
                        <li><strong>Herramientas:</strong> Identificadas por <code>herramientaId</code>, son equipos reutilizables</li>
                        <li><strong>Ambos:</strong> Se gestionan en el mismo sistema pero tienen colecciones separadas en Firestore</li>
                    </ul>

                    <h4>Mejores Pr谩cticas</h4>
                    <div class="info-box">
                        <ul>
                            <li><strong>Revisar Anomal铆as regularmente:</strong> Verifica semanalmente si hay productos con saldo negativo</li>
                            <li><strong>Usar Historial para auditor铆a:</strong> El historial muestra todas las transacciones, 煤til para rastrear problemas</li>
                            <li><strong>Validar stock antes de asignar:</strong> El sistema valida autom谩ticamente que haya stock disponible antes de crear pedidos especiales</li>
                            <li><strong>Recalcular saldos si hay discrepancias:</strong> Usa la funci贸n "Recalcular Saldos" en la p谩gina de Bodegas si los saldos no coinciden</li>
                        </ul>
                    </div>

                    <h3><i class="fas fa-chart-bar me-2"></i>4. Reportes Gerenciales</h3>
                    <p><strong>Archivo:</strong> <code>reportes_gerenciales.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/reportes_gerenciales.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Reportes Gerenciales
                        </a>
                    </div>
                    
                    <h4>驴Qu茅 hace?</h4>
                    <p>Muestra estad铆sticas y an谩lisis del negocio. Es el <strong>centro de an谩lisis</strong> donde los gerentes pueden ver el desempe帽o de la empresa, empleados y operaciones.</p>

                    <h4>Reportes Disponibles:</h4>
                    
                    <h5>Reporte de Horas por D铆a</h5>
                    <ul>
                        <li><strong>Horas por empleado por d铆a:</strong> Tabla detallada con horas trabajadas de cada t茅cnico cada d铆a</li>
                        <li><strong>Horas por empleado por d铆a por hora laborada:</strong> Desglose horario mostrando en qu茅 horas del d铆a trabaj贸 cada empleado</li>
                        <li><strong>Filtros:</strong> Por mes, semana, o empleado espec铆fico</li>
                        <li><strong>Indicadores visuales:</strong> Color morado y "V" si el empleado estaba de vacaciones</li>
                        <li><strong>D铆as especiales:</strong> Domingos y feriados se colorean en morado claro</li>
                    </ul>

                    <h5>Reporte de Facturaci贸n por Empleado</h5>
                    <ul>
                        <li><strong>Facturaci贸n por empleado por d铆a:</strong> Monto facturado por cada t茅cnico cada d铆a</li>
                        <li><strong>Facturaci贸n por empleado por d铆a por hora laborada:</strong> Desglose por hora del d铆a</li>
                        <li><strong>Divisi贸n proporcional:</strong> Si varios t茅cnicos atienden una cita, el monto se divide entre ellos</li>
                        <li><strong>Mismo formato visual:</strong> Colores, vacaciones, feriados igual que el reporte de horas</li>
                        <li><strong>Formato compacto:</strong> Montos redondeados a miles (ej: "22k" para 22,000)</li>
                    </ul>

                    <h4>Ejemplo Pr谩ctico: Analizar Desempe帽o del Mes</h4>
                    <div class="info-box">
                        <p><strong>Escenario:</strong> Un gerente quiere revisar el desempe帽o de enero 2026.</p>
                        <ol>
                            <li><strong>Abrir Reportes:</strong> Ir a <code>reportes_gerenciales.html</code></li>
                            <li><strong>Seleccionar mes:</strong> En el filtro, elegir "Enero 2026"</li>
                            <li><strong>Revisar horas:</strong> Ver qu茅 t茅cnicos trabajaron m谩s horas y en qu茅 d铆as</li>
                            <li><strong>Revisar facturaci贸n:</strong> Ver qu茅 t茅cnicos generaron m谩s ingresos</li>
                            <li><strong>Comparar:</strong> Identificar t茅cnicos con buen balance horas/facturaci贸n</li>
                            <li><strong>Detectar patrones:</strong> Ver si hay d铆as de la semana con m谩s/menos actividad</li>
                        </ol>
                    </div>

                    <h4>Uso de los Reportes</h4>
                    <ul>
                        <li><strong>Planificaci贸n:</strong> Identificar d铆as de alta/baja actividad para planificar recursos</li>
                        <li><strong>Evaluaci贸n:</strong> Evaluar desempe帽o individual de t茅cnicos</li>
                        <li><strong>Incentivos:</strong> Basar premios y reconocimientos en datos objetivos</li>
                        <li><strong>An谩lisis de tendencias:</strong> Ver patrones a lo largo del tiempo</li>
                    </ul>

                    <h3><i class="fas fa-box me-2"></i>4. M贸dulos de Inventario</h3>
                    
                    <h4>4.1. Productos</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_productos.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_productos.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Cat谩logo de Productos
                        </a>
                    </div>
                    
                    <ul>
                        <li>Gestiona todos los productos (insumos) que usamos</li>
                        <li>Ver cat谩logo, agregar, editar productos</li>
                        <li>Ver stock (cantidad disponible)</li>
                    </ul>

                    <h4>4.2. Herramientas</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_productos.html</code> (Tab Herramientas)</p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_productos.html#herramientas" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Cat谩logo de Herramientas
                        </a>
                    </div>
                    
                    <ul>
                        <li>Gestiona las herramientas que usan los t茅cnicos</li>
                        <li>Asignar herramientas a empleados</li>
                        <li>Devolver herramientas a bodega</li>
                    </ul>

                    <h4>4.3. Bodegas</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_bodegas.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_bodegas.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Gesti贸n de Bodegas
                        </a>
                    </div>
                    
                    <ul>
                        <li>Gestiona las bodegas donde guardamos productos</li>
                        <li>Ver stock por bodega</li>
                        <li>Recalcular saldos</li>
                    </ul>

                    <h4>4.4. Pedidos Especiales</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_pedidos_especiales.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_pedidos_especiales.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Pedidos Especiales
                        </a>
                    </div>
                    
                    <ul>
                        <li>Asignar productos/herramientas a bodegas especiales (de empleados)</li>
                        <li>Crear pedidos especiales</li>
                        <li>Ver pedidos pendientes</li>
                    </ul>

                    <h4>4.5. Liquidaci贸n</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_liquidar_especiales.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_liquidar_especiales.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Liquidaci贸n de Pedidos Especiales
                        </a>
                    </div>
                    
                    <ul>
                        <li>Cierra los pedidos especiales</li>
                        <li>Marcar productos como devueltos o consumidos</li>
                        <li>Actualizar saldos de bodegas</li>
                    </ul>

                    <h4>4.6. Transacciones</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_transacciones.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_transacciones.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Historial de Transacciones
                        </a>
                    </div>
                    
                    <ul>
                        <li>Muestra el historial de todos los movimientos de inventario</li>
                        <li>Filtrar por fecha, producto, bodega, etc.</li>
                        <li>Revertir transacciones (si hay un error)</li>
                    </ul>
                </div>

                <!-- Secci贸n: C贸mo Empezar -->
                <div id="empezar" class="content-section">
                    <h2><i class="fas fa-rocket me-2"></i>C贸mo Empezar a Trabajar</h2>
                    
                    <h3>Paso 1: Configurar tu Entorno</h3>
                    
                    <h4><span class="step-number">1</span>Instalar Cursor AI</h4>
                    <ol>
                        <li>Ve a: <a href="https://cursor.sh" target="_blank">https://cursor.sh</a></li>
                        <li>Descarga Cursor AI para tu sistema operativo</li>
                        <li>Inst谩lalo siguiendo las instrucciones</li>
                        <li>Abre Cursor AI</li>
                    </ol>

                    <h4><span class="step-number">2</span>Conectar con el Proyecto</h4>
                    <ol>
                        <li>En Cursor AI, abre la carpeta del proyecto</li>
                        <li>La carpeta se llama <code>cursorai</code> (o similar)</li>
                        <li>Ahora puedes ver todos los archivos del proyecto</li>
                    </ol>

                    <h4><span class="step-number">3</span>Configurar Firebase</h4>
                    <ul>
                        <li>Necesitas acceso a la cuenta de Firebase</li>
                        <li>El proyecto se llama <code>cursorwebapp-f376d</code></li>
                        <li>No necesitas instalar nada, Firebase funciona en internet</li>
                    </ul>

                    <h3>Paso 2: Entender la Estructura</h3>
                    
                    <div class="diagram-container">
                        <h4>Estructura de Archivos</h4>
                        <div class="code-example" style="background: white; color: #333; border: 2px solid var(--border-color);">
cursorai/

 public/                     Aqu铆 est谩n todas las p谩ginas web
    calendario.html   Calendario
    registro_horas.html  Registro de horas
    admin_inventario_*.html  M贸dulos de inventario
    ...

 firebase.json               Configuraci贸n de Firebase
 package.json               Informaci贸n del proyecto
                        </div>
                    </div>

                    <h4>Tipos de Archivos</h4>
                    <ul>
                        <li><strong>.html</strong>: P谩ginas web (lo que ves en el navegador)</li>
                        <li><strong>.js</strong>: C贸digo JavaScript (la l贸gica que hace funcionar las p谩ginas)</li>
                        <li><strong>.css</strong>: Estilos (colores, tama帽os, dise帽o)</li>
                    </ul>

                    <h3>Paso 3: Hacer tu Primera Modificaci贸n</h3>
                    
                    <div class="success-box">
                        <h4><i class="fas fa-lightbulb me-2"></i>Ejemplo: Cambiar el texto de un bot贸n</h4>
                        <ol>
                            <li><strong>Abre el archivo</strong> en Cursor AI (ej: <code>calendario.html</code>)</li>
                            <li><strong>Busca el texto</strong> que quieres cambiar (usa <code>Ctrl + F</code>)</li>
                            <li><strong>Modifica el texto</strong> (ej: "Guardar Cambios"  "Guardar")</li>
                            <li><strong>Guarda el archivo</strong> (<code>Ctrl + S</code>)</li>
                            <li><strong>Despliega los cambios</strong>:
                                <div class="code-example" style="margin-top: 10px;">
firebase deploy --only hosting
                                </div>
                            </li>
                        </ol>
                    </div>

                    <!-- Quiz: C贸mo Empezar -->
                    <div class="quiz-container" data-quiz-id="empezar">
                        <h3><i class="fas fa-rocket me-2"></i> Reto: Iniciador Pro</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴D贸nde est谩n todas las p谩ginas web del proyecto?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="empezar-q1" value="a"> En la carpeta ra铆z del proyecto</label>
                                    <label><input type="radio" name="empezar-q1" value="b"> En la carpeta public/</label>
                                    <label><input type="radio" name="empezar-q1" value="c"> En la carpeta firebase/</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 comando se usa para publicar cambios en Firebase?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="empezar-q2" value="a"> firebase update</label>
                                    <label><input type="radio" name="empezar-q2" value="b"> firebase deploy --only hosting</label>
                                    <label><input type="radio" name="empezar-q2" value="c"> firebase publish</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 tipo de archivo contiene la l贸gica que hace funcionar las p谩ginas?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="empezar-q3" value="a"> .html</label>
                                    <label><input type="radio" name="empezar-q3" value="b"> .js (JavaScript)</label>
                                    <label><input type="radio" name="empezar-q3" value="c"> .css</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Cu谩l es el nombre del proyecto de Firebase que usamos?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="empezar-q4" value="a"> ecoplagas-online</label>
                                    <label><input type="radio" name="empezar-q4" value="b"> cursorwebapp-f376d</label>
                                    <label><input type="radio" name="empezar-q4" value="c"> firebase-project</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 archivo contiene la configuraci贸n de Firebase Hosting?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="empezar-q5" value="a"> package.json</label>
                                    <label><input type="radio" name="empezar-q5" value="b"> firebase.json</label>
                                    <label><input type="radio" name="empezar-q5" value="c"> config.js</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 debes hacer despu茅s de modificar un archivo en Cursor AI?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="empezar-q6" value="a"> Nada, los cambios se guardan autom谩ticamente</label>
                                    <label><input type="radio" name="empezar-q6" value="b"> Guardar el archivo (Ctrl + S) y luego desplegar con firebase deploy --only hosting</label>
                                    <label><input type="radio" name="empezar-q6" value="c"> Solo cerrar Cursor AI</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('empezar')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-empezar"></div>
                    </div>

                    <h3>Paso 4: Trabajar con Cursor AI</h3>
                    
                    <h4><i class="fas fa-comments me-2"></i>Pedir ayuda a Cursor AI</h4>
                    <ol>
                        <li><strong>Abre el chat</strong> de Cursor AI (<code>Ctrl + L</code> o <code>Cmd + L</code> en Mac)</li>
                        <li><strong>Escribe tu pregunta</strong> en espa帽ol:
                            <div class="code-example" style="margin-top: 10px;">
驴C贸mo agrego un nuevo bot贸n en el calendario?
                            </div>
                        </li>
                        <li><strong>Cursor AI te ayudar谩</strong>:
                            <ul>
                                <li>Te mostrar谩 el c贸digo necesario</li>
                                <li>Te explicar谩 qu茅 hace cada parte</li>
                                <li>Te guiar谩 paso a paso</li>
                            </ul>
                        </li>
                    </ol>

                    <h4>Ejemplos de preguntas 煤tiles:</h4>
                    <ul>
                        <li>"驴D贸nde est谩 el c贸digo que muestra las citas del d铆a?"</li>
                        <li>"驴C贸mo agrego un filtro por empleado?"</li>
                        <li>"驴C贸mo cambio el color de este bot贸n?"</li>
                        <li>"驴Por qu茅 no funciona este bot贸n?"</li>
                    </ul>
                </div>

                <!-- Secci贸n: Ejemplos Pr谩cticos -->
                <div id="ejemplos" class="content-section">
                    <h2><i class="fas fa-code me-2"></i>Ejemplos Pr谩cticos</h2>
                    
                    <h3>Ejemplo 1: Agregar un Nuevo Campo en el Formulario de Citas</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n</h4>
                        <p>Quieres agregar un campo para "Observaciones" en el formulario de crear citas.</p>
                    </div>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Abre</strong> <code>calendario.html</code> en Cursor AI</li>
                        <li><strong>Busca</strong> el formulario de nueva cita (busca: "Nueva Cita" o "newCita")</li>
                        <li><strong>Pregunta a Cursor AI</strong>:
                            <div class="code-example">
驴D贸nde est谩 el formulario para crear una nueva cita?
                            </div>
                        </li>
                        <li><strong>Agrega el campo</strong>:
                            <div class="code-example">
&lt;div class="mb-3"&gt;
    &lt;label&gt;Observaciones&lt;/label&gt;
    &lt;textarea id="newObservaciones" class="form-control"&gt;&lt;/textarea&gt;
&lt;/div&gt;
                            </div>
                        </li>
                        <li><strong>Guarda y despliega</strong>:
                            <div class="code-example">
firebase deploy --only hosting
                            </div>
                        </li>
                    </ol>

                    <h3>Ejemplo 2: Cambiar el Color de un Bot贸n</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n</h4>
                        <p>Quieres que el bot贸n "Guardar" sea verde en lugar de azul.</p>
                    </div>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Busca</strong> el bot贸n en el archivo HTML (busca: "Guardar" o "btnGuardar")</li>
                        <li><strong>Encuentra</strong> el estilo del bot贸n (puede estar en el mismo archivo o en un archivo CSS)</li>
                        <li><strong>Cambia el color</strong>:
                            <div class="code-example">
background-color: green;  /* En lugar de blue */
                            </div>
                        </li>
                        <li><strong>Guarda y despliega</strong></li>
                    </ol>

                    <h3>Ejemplo 3: Agregar una Nueva Columna en una Tabla</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n</h4>
                        <p>Quieres agregar una columna "Tel茅fono" en la tabla de empleados.</p>
                    </div>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Busca</strong> la tabla en el c贸digo (busca: "tabla" o "table")</li>
                        <li><strong>Agrega</strong> la columna en el encabezado:
                            <div class="code-example">
&lt;th&gt;Tel茅fono&lt;/th&gt;
                            </div>
                        </li>
                        <li><strong>Agrega</strong> la columna en cada fila:
                            <div class="code-example">
&lt;td&gt;${empleado.telefono || 'N/A'}&lt;/td&gt;
                            </div>
                        </li>
                        <li><strong>Guarda y despliega</strong></li>
                    </ol>

                    <h3>Ejemplo 4: Agregar un Filtro por Fecha en un Reporte</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n</h4>
                        <p>Quieres agregar un filtro de fecha "Desde" y "Hasta" en el reporte de facturaci贸n por empleado.</p>
                    </div>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Abre</strong> <code>reportes_gerenciales.html</code></li>
                        <li><strong>Busca</strong> la secci贸n "Reporte de Facturaci贸n por Empleado"</li>
                        <li><strong>Agrega los campos de fecha</strong> antes de la tabla:
                            <div class="code-example">
&lt;div class="row mb-3"&gt;
    &lt;div class="col-md-4"&gt;
        &lt;label&gt;Desde:&lt;/label&gt;
        &lt;input type="date" id="fechaDesde" class="form-control"&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;label&gt;Hasta:&lt;/label&gt;
        &lt;input type="date" id="fechaHasta" class="form-control"&gt;
    &lt;/div&gt;
    &lt;div class="col-md-4"&gt;
        &lt;button onclick="filtrarReporte()" class="btn btn-primary"&gt;Filtrar&lt;/button&gt;
    &lt;/div&gt;
&lt;/div&gt;
                            </div>
                        </li>
                        <li><strong>Modifica la funci贸n</strong> que carga los datos para usar estos filtros:
                            <div class="code-example">
const fechaDesde = document.getElementById('fechaDesde').value;
const fechaHasta = document.getElementById('fechaHasta').value;
// Agregar where() a la consulta de Firestore
                            </div>
                        </li>
                        <li><strong>Guarda y despliega</strong></li>
                    </ol>

                    <h3>Ejemplo 5: Agregar Validaci贸n de Stock Antes de Crear Pedido</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n</h4>
                        <p>Quieres que el sistema valide que haya stock disponible antes de permitir crear un pedido especial.</p>
                    </div>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Abre</strong> <code>admin_inventario_pedidos_especiales.js</code></li>
                        <li><strong>Busca</strong> la funci贸n que procesa el pedido (ej: <code>procesarPedidoEspeciales</code>)</li>
                        <li><strong>Agrega validaci贸n</strong> antes de crear el movimiento:
                            <div class="code-example">
// Verificar stock disponible
const stockRef = collection(db, 'stock_bodegas');
const stockQuery = query(stockRef, 
    where('bodegaId', '==', bodegaPrincipalId),
    where('productoId', '==', productoId)
);
const stockSnapshot = await getDocs(stockQuery);
const stockActual = stockSnapshot.docs[0]?.data()?.cantidad || 0;

if (stockActual < cantidad) {
    alert(`Stock insuficiente. Disponible: ${stockActual}, Solicitado: ${cantidad}`);
    return; // Detener el proceso
}
                            </div>
                        </li>
                        <li><strong>Guarda y despliega</strong></li>
                    </ol>

                    <h3>Ejemplo 6: Agregar un Bot贸n de Exportar a Excel</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n</h4>
                        <p>Quieres agregar un bot贸n que exporte los datos de una tabla a un archivo Excel.</p>
                    </div>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Agrega la librer铆a</strong> de Excel en el HTML (en la secci贸n &lt;head&gt;):
                            <div class="code-example">
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"&gt;&lt;/script&gt;
                            </div>
                        </li>
                        <li><strong>Agrega el bot贸n</strong> en la p谩gina:
                            <div class="code-example">
&lt;button onclick="exportarAExcel()" class="btn btn-success"&gt;
    &lt;i class="fas fa-file-excel"&gt;&lt;/i&gt; Exportar a Excel
&lt;/button&gt;
                            </div>
                        </li>
                        <li><strong>Crea la funci贸n</strong> de exportaci贸n:
                            <div class="code-example">
function exportarAExcel() {
    // Obtener datos de la tabla
    const datos = obtenerDatosTabla(); // Tu funci贸n que obtiene los datos
    
    // Crear workbook
    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.json_to_sheet(datos);
    XLSX.utils.book_append_sheet(wb, ws, "Datos");
    
    // Descargar
    XLSX.writeFile(wb, "reporte.xlsx");
}
                            </div>
                        </li>
                        <li><strong>Guarda y despliega</strong></li>
                    </ol>

                    <h3>Ejemplo 7: Agregar Confirmaci贸n Antes de Eliminar</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n</h4>
                        <p>Quieres que aparezca un mensaje de confirmaci贸n antes de eliminar una transacci贸n de inventario.</p>
                    </div>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Busca</strong> la funci贸n que elimina (ej: <code>eliminarMovimiento</code>)</li>
                        <li><strong>Agrega confirmaci贸n</strong> al inicio de la funci贸n:
                            <div class="code-example">
async function eliminarMovimiento(movimientoId) {
    // Confirmar antes de eliminar
    const confirmar = confirm('驴Est谩s seguro de eliminar esta transacci贸n? Esta acci贸n actualizar谩 los saldos de stock.');
    
    if (!confirmar) {
        return; // Cancelar si el usuario no confirma
    }
    
    // Continuar con la eliminaci贸n...
}
                            </div>
                        </li>
                        <li><strong>Guarda y despliega</strong></li>
                    </ol>

                    <!-- Quiz: Ejemplos Pr谩cticos -->
                    <div class="quiz-container" data-quiz-id="ejemplos">
                        <h3><i class="fas fa-code me-2"></i> Reto: Maestro de Ejemplos Pr谩cticos</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. Para agregar un nuevo campo en un formulario, 驴qu茅 debes hacer primero?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="ejemplos-q1" value="a"> Eliminar el formulario y crear uno nuevo</label>
                                    <label><input type="radio" name="ejemplos-q1" value="b"> Buscar el formulario en el archivo HTML y agregar el campo con su label e input</label>
                                    <label><input type="radio" name="ejemplos-q1" value="c"> Pedir a Cursor AI que lo haga todo autom谩ticamente</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. Si quieres cambiar el color de un bot贸n de azul a verde, 驴d贸nde debes hacer el cambio?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="ejemplos-q2" value="a"> En el archivo JavaScript</label>
                                    <label><input type="radio" name="ejemplos-q2" value="b"> En el archivo HTML (atributo style) o en el archivo CSS (regla de estilo)</label>
                                    <label><input type="radio" name="ejemplos-q2" value="c"> En Firebase Console</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. Para agregar una nueva columna en una tabla, 驴qu茅 debes hacer?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="ejemplos-q3" value="a"> Solo agregar &lt;th&gt; en el encabezado</label>
                                    <label><input type="radio" name="ejemplos-q3" value="b"> Agregar &lt;th&gt; en el encabezado Y &lt;td&gt; en cada fila de datos</label>
                                    <label><input type="radio" name="ejemplos-q3" value="c"> Eliminar la tabla y crear una nueva</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. Si quieres validar stock antes de crear un pedido, 驴d贸nde debes agregar la validaci贸n?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="ejemplos-q4" value="a"> En el archivo HTML</label>
                                    <label><input type="radio" name="ejemplos-q4" value="b"> En la funci贸n JavaScript que procesa el pedido, antes de crear el movimiento en Firestore</label>
                                    <label><input type="radio" name="ejemplos-q4" value="c"> En Firebase Console</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. Para agregar un bot贸n de exportar a Excel, 驴qu茅 necesitas hacer primero?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="ejemplos-q5" value="a"> Instalar Excel en la computadora</label>
                                    <label><input type="radio" name="ejemplos-q5" value="b"> Agregar la librer铆a de Excel (XLSX) en el HTML y crear una funci贸n que convierta los datos a formato Excel</label>
                                    <label><input type="radio" name="ejemplos-q5" value="c"> Pedirle a un programador que lo haga</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Cu谩l es el comando para desplegar cambios a Firebase Hosting?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="ejemplos-q6" value="a"> firebase update</label>
                                    <label><input type="radio" name="ejemplos-q6" value="b"> firebase deploy --only hosting</label>
                                    <label><input type="radio" name="ejemplos-q6" value="c"> firebase save</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('ejemplos')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-ejemplos"></div>
                    </div>
                </div>

                <!-- Secci贸n: Casos de Uso Reales -->
                <div id="casos-uso" class="content-section">
                    <h2><i class="fas fa-tasks me-2"></i>Casos de Uso Reales del Sitio</h2>
                    
                    <div class="info-box">
                        <p>Aqu铆 te mostramos <strong>ejemplos reales</strong> de c贸mo se usan los m贸dulos en el d铆a a d铆a de EcoPlagas:</p>
                    </div>

                    <h3><i class="fas fa-calendar-check me-2"></i>Caso 1: Un Cliente Llama para Agendar una Cita</h3>
                    
                    <div class="diagram-container">
                        <h4>Flujo Completo</h4>
                        <div class="diagram">
                            <div class="diagram-box">
                                <span class="step-number">1</span>
                                <strong>Cliente llama</strong><br>
                                <small>Tel: 8333-1234</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <span class="step-number">2</span>
                                <strong>Abrir Calendario</strong><br>
                                <small>calendario.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <span class="step-number">3</span>
                                <strong>Crear Nueva Cita</strong><br>
                                <small>Llenar formulario</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <span class="step-number">4</span>
                                <strong>Asignar Ruta</strong><br>
                                <small>Ej: Ruta 3</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">
                                <span class="step-number">5</span>
                                <strong>Guardar</strong><br>
                                <small>Cita creada</small>
                            </div>
                        </div>
                    </div>

                    <h4>Pasos Detallados:</h4>
                    <ol>
                        <li><strong>Ir a Calendario:</strong> Abre <code>calendario.html</code> en el navegador</li>
                        <li><strong>Click en "Nueva Cita":</strong> Bot贸n verde en la parte superior</li>
                        <li><strong>Llenar el formulario:</strong>
                            <ul>
                                <li>Tel茅fono: 83331234 (8 d铆gitos, se agrega 506 autom谩ticamente)</li>
                                <li>Sucursal: Seleccionar o crear nueva</li>
                                <li>Fecha y Hora: Ej: 15 de enero, 9:00 AM</li>
                                <li>Duraci贸n: Ej: 1 hora</li>
                                <li>Ruta: Ej: Ruta 3</li>
                                <li>Monto de Venta: Ej: 45,000</li>
                            </ul>
                        </li>
                        <li><strong>Guardar:</strong> Click en "Guardar Cita"</li>
                        <li><strong>Verificar:</strong> La cita aparece en el calendario del d铆a seleccionado</li>
                    </ol>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i>Resultado</h4>
                        <p>La cita queda guardada en Firebase y aparece en el calendario. El t茅cnico asignado a esa ruta puede verla en su vista del d铆a.</p>
                    </div>

                    <h3><i class="fas fa-clock me-2"></i>Caso 2: Un Empleado Marca su Entrada</h3>
                    
                    <div class="diagram-container">
                        <h4>Flujo de Registro de Horas</h4>
                        <div class="diagram">
                            <div class="diagram-box">
                                <strong>Empleado llega</strong><br>
                                <small>5:30 AM</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <strong>Abrir Registro</strong><br>
                                <small>registro_horas.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <strong>Click "Iniciar Turno"</strong><br>
                                <small>Jornada Diurna</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">
                                <strong>Turno Activo</strong><br>
                                <small>Hora registrada</small>
                            </div>
                        </div>
                    </div>

                    <h4>Conceptos Importantes:</h4>
                    <ul>
                        <li><strong>D铆a laborable:</strong> Va de 5:00 AM a 4:59 AM del d铆a siguiente</li>
                        <li><strong>Si marca a las 4:30 AM:</strong> Pertenece al d铆a laborable anterior</li>
                        <li><strong>Jornada Diurna:</strong> 5:00 AM - 5:00 PM</li>
                        <li><strong>Jornada Nocturna:</strong> 5:00 PM - 5:00 AM siguiente</li>
                        <li><strong>Verificaci贸n de Inventario APV:</strong> Al iniciar turno, el sistema muestra productos que deben estar en el veh铆culo</li>
                        <li><strong>Neteo Especial:</strong> Verifica productos con saldo positivo en bodegas especiales</li>
                    </ul>

                    <h3><i class="fas fa-box me-2"></i>Caso 3: Asignar Productos a un T茅cnico para una Ruta</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n Real</h4>
                        <p>Sebasti谩n G. tiene 8 citas ma帽ana y necesita 5 litros de insecticida y 2 termonebulizadoras.</p>
                    </div>

                    <h4>Pasos Detallados:</h4>
                    <ol>
                        <li><strong>Abrir Administrador de Bodega:</strong> <code>administrador_bodega.html</code></li>
                        <li><strong>Click en "Pedidos Especiales"</strong></li>
                        <li><strong>Llenar el formulario:</strong>
                            <ul>
                                <li>Empleado: Seleccionar "Sebasti谩n G."</li>
                                <li>Fecha del Pedido: Ma帽ana (usar botones de fecha r谩pida)</li>
                                <li>Agregar Producto: Buscar "insecticida", seleccionar, cantidad: 5</li>
                                <li>Agregar Herramienta: Buscar "termonebulizadora", seleccionar, cantidad: 2</li>
                            </ul>
                        </li>
                        <li><strong>Verificar Stock:</strong> El sistema valida autom谩ticamente que haya stock disponible</li>
                        <li><strong>Click en "Alistar Productos/Herramientas"</strong></li>
                        <li><strong>Resultado:</strong>
                            <ul>
                                <li>Se crean movimientos de tipo "transferencia" desde bodega principal a bodega especial</li>
                                <li>El stock se actualiza en ambas bodegas</li>
                                <li>Sebasti谩n puede ver los productos en <code>operario_bodega.html</code></li>
                            </ul>
                        </li>
                    </ol>

                    <h3><i class="fas fa-undo me-2"></i>Caso 4: Revertir una Transacci贸n Incorrecta</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n Real</h4>
                        <p>Se cre贸 una transacci贸n de compra por error. Se compraron 10 unidades pero se registraron 100.</p>
                    </div>

                    <h4>Pasos para Corregir:</h4>
                    <ol>
                        <li><strong>Identificar la Transacci贸n:</strong>
                            <ul>
                                <li>Abrir <code>admin_inventario_transacciones.html</code></li>
                                <li>Filtrar por producto, fecha, o tipo de transacci贸n</li>
                                <li>Encontrar la transacci贸n incorrecta</li>
                            </ul>
                        </li>
                        <li><strong>Eliminar la Transacci贸n:</strong>
                            <ul>
                                <li>Click en el bot贸n de eliminar (icono de basura)</li>
                                <li>Confirmar la eliminaci贸n</li>
                                <li><strong>Importante:</strong> El sistema autom谩ticamente revierte el stock</li>
                            </ul>
                        </li>
                        <li><strong>Crear la Transacci贸n Correcta:</strong>
                            <ul>
                                <li>Ir a "Compras" en <code>administrador_bodega.html</code></li>
                                <li>Crear la compra con la cantidad correcta (10 unidades)</li>
                            </ul>
                        </li>
                        <li><strong>Verificar:</strong>
                            <ul>
                                <li>Revisar el stock en <code>admin_inventario_productos.html</code></li>
                                <li>Verificar que el saldo sea correcto</li>
                            </ul>
                        </li>
                    </ol>

                    <h3><i class="fas fa-clipboard-list me-2"></i>Caso 5: Revisar y Aprobar Gastos de Operarios</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n Real</h4>
                        <p>Los operarios han reportado gastos durante la semana. El administrador debe revisarlos y aprobarlos.</p>
                    </div>

                    <h4>Proceso:</h4>
                    <ol>
                        <li><strong>Abrir Revisar Gastos:</strong>
                            <ul>
                                <li>Ir a <code>admin_inventario_revisar_gastos.html</code></li>
                                <li>Ver lista de gastos pendientes</li>
                            </ul>
                        </li>
                        <li><strong>Revisar Cada Gasto:</strong>
                            <ul>
                                <li>Ver producto consumido</li>
                                <li>Ver cantidad</li>
                                <li>Ver cuenta de gasto seleccionada</li>
                                <li>Ver fecha y t茅cnico que report贸</li>
                            </ul>
                        </li>
                        <li><strong>Aprobar o Rechazar:</strong>
                            <ul>
                                <li>Si es correcto: Click en "Aprobar"</li>
                                <li>Si es incorrecto: Click en "Rechazar" (esto revierte el stock)</li>
                            </ul>
                        </li>
                        <li><strong>Resultado:</strong>
                            <ul>
                                <li>Al aprobar, el gasto queda registrado permanentemente</li>
                                <li>El stock ya fue decrementado cuando el operario lo report贸</li>
                                <li>Al rechazar, el stock se incrementa de vuelta</li>
                            </ul>
                        </li>
                    </ol>

                    <h3><i class="fas fa-sync me-2"></i>Caso 6: Actualizar Calendario desde Google Sheets</h3>
                    
                    <div class="info-box">
                        <h4>Situaci贸n Real</h4>
                        <p>Las citas se crean en Google Sheets y luego se sincronizan con el sistema.</p>
                    </div>

                    <h4>Proceso:</h4>
                    <ol>
                        <li><strong>Preparar Datos en Google Sheets:</strong>
                            <ul>
                                <li>Asegurar que la hoja "vaciado" tenga el formato correcto</li>
                                <li>Columnas requeridas: tel茅fono, fecha, hora, cliente, monto, ruta, etc.</li>
                            </ul>
                        </li>
                        <li><strong>Actualizar desde Sheets:</strong>
                            <ul>
                                <li>Abrir <code>calendario.html</code></li>
                                <li>Click en "Actualizar desde Sheets Oficial"</li>
                                <li>El sistema descarga los datos de la hoja "vaciado"</li>
                            </ul>
                        </li>
                        <li><strong>Procesamiento:</strong>
                            <ul>
                                <li>El sistema parsea el CSV</li>
                                <li>Normaliza tel茅fonos (agrega prefijo 506 si falta)</li>
                                <li>Convierte fechas al formato correcto</li>
                                <li>Crea o actualiza citas en Firestore</li>
                            </ul>
                        </li>
                        <li><strong>Verificar:</strong>
                            <ul>
                                <li>Revisar el calendario del d铆a</li>
                                <li>Verificar que las citas aparezcan correctamente</li>
                            </ul>
                        </li>
                    </ol>

                    <!-- Quiz: Casos de Uso Reales -->
                    <div class="quiz-container" data-quiz-id="casos-uso">
                        <h3><i class="fas fa-tasks me-2"></i> Reto: Maestro de Casos de Uso</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. Para crear una nueva cita desde calendario.html, 驴qu茅 informaci贸n es obligatoria?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="casos-uso-q1" value="a"> Solo el tel茅fono</label>
                                    <label><input type="radio" name="casos-uso-q1" value="b"> Tel茅fono, fecha, hora, ruta y monto de venta</label>
                                    <label><input type="radio" name="casos-uso-q1" value="c"> Solo la fecha</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. Si un t茅cnico marca entrada a las 4:30 AM, 驴a qu茅 d铆a laborable pertenece?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="casos-uso-q2" value="a"> Al d铆a actual</label>
                                    <label><input type="radio" name="casos-uso-q2" value="b"> Al d铆a laborable anterior (porque el d铆a laborable va de 5:00 AM a 4:59 AM del siguiente d铆a)</label>
                                    <label><input type="radio" name="casos-uso-q2" value="c"> No se puede marcar entrada a esa hora</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. Al asignar productos a un t茅cnico mediante Pedidos Especiales, 驴qu茅 sucede con el stock?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="casos-uso-q3" value="a"> El stock no cambia</label>
                                    <label><input type="radio" name="casos-uso-q3" value="b"> Se crea una transferencia: el stock disminuye en la bodega principal y aumenta en la bodega especial del t茅cnico</label>
                                    <label><input type="radio" name="casos-uso-q3" value="c"> Solo aumenta en la bodega especial</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. Si eliminas una transacci贸n incorrecta en admin_inventario_transacciones.html, 驴qu茅 sucede?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="casos-uso-q4" value="a"> Solo se elimina el registro, el stock no cambia</label>
                                    <label><input type="radio" name="casos-uso-q4" value="b"> Se elimina el registro Y el stock se revierte autom谩ticamente seg煤n el tipo de transacci贸n</label>
                                    <label><input type="radio" name="casos-uso-q4" value="c"> El stock aumenta siempre</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. Cuando un operario reporta un gasto, 驴qu茅 sucede inmediatamente?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="casos-uso-q5" value="a"> El stock se decrementa inmediatamente y el gasto queda pendiente de aprobaci贸n</label>
                                    <label><input type="radio" name="casos-uso-q5" value="b"> El stock no cambia hasta que se apruebe</label>
                                    <label><input type="radio" name="casos-uso-q5" value="c"> Solo se crea el registro, el stock nunca cambia</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. Al actualizar el calendario desde Google Sheets, 驴qu茅 hoja se usa?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="casos-uso-q6" value="a"> La hoja "mes_completo"</label>
                                    <label><input type="radio" name="casos-uso-q6" value="b"> La hoja "vaciado" que contiene las citas a sincronizar</label>
                                    <label><input type="radio" name="casos-uso-q6" value="c"> Cualquier hoja del spreadsheet</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('casos-uso')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-casos-uso"></div>
                    </div>
                </div>
                        <li><strong>Jornada Nocturna:</strong> 5:00 PM - 5:00 AM</li>
                    </ul>

                    <h3><i class="fas fa-box me-2"></i>Caso 3: Asignar Productos a un T茅cnico</h3>
                    
                    <div class="diagram-container">
                        <h4>Flujo de Pedido Especial</h4>
                        <div class="diagram">
                            <div class="diagram-box">
                                <strong>T茅cnico necesita</strong><br>
                                <small>Productos para ruta</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <strong>Crear Pedido</strong><br>
                                <small>admin_inventario_pedidos_especiales.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <strong>Seleccionar productos</strong><br>
                                <small>Verificar stock</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box">
                                <strong>Alistar</strong><br>
                                <small>Transferir a bodega especial</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-right"></i></div>
                            <div class="diagram-box primary">
                                <strong>T茅cnico recibe</strong><br>
                                <small>Ve en operario_bodega.html</small>
                            </div>
                        </div>
                    </div>

                    <h4>Pasos Detallados:</h4>
                    <ol>
                        <li><strong>Abrir Pedidos Especiales:</strong> <code>admin_inventario_pedidos_especiales.html</code></li>
                        <li><strong>Seleccionar empleado:</strong> Ej: "Sebasti谩n G."</li>
                        <li><strong>Seleccionar fecha:</strong> Usar botones de fecha (hoy, ma帽ana, etc.)</li>
                        <li><strong>Agregar productos:</strong>
                            <ul>
                                <li>Click en "Agregar Producto"</li>
                                <li>Seleccionar producto de la lista</li>
                                <li>Verificar que hay stock disponible</li>
                                <li>Ingresar cantidad (solo n煤meros enteros)</li>
                            </ul>
                        </li>
                        <li><strong>Procesar pedido:</strong> Click en "Alistar Productos"</li>
                        <li><strong>Verificar:</strong> El t茅cnico puede ver los productos en <code>operario_bodega.html</code></li>
                    </ol>

                    <div class="warning-box">
                        <h4><i class="fas fa-exclamation-triangle me-2"></i>Importante</h4>
                        <p>El sistema <strong>no permite</strong> alistar productos con stock 0 o negativo. Siempre verifica el stock antes de crear el pedido.</p>
                    </div>

                    <h3><i class="fas fa-undo me-2"></i>Caso 4: Devolver Productos a Bodega</h3>
                    
                    <h4>Escenario:</h4>
                    <p>Un t茅cnico termin贸 su ruta y quiere devolver los productos que no us贸.</p>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>El t茅cnico abre:</strong> <code>operario_bodega.html</code></li>
                        <li><strong>Ve sus productos asignados:</strong> En la secci贸n "Mi Inventario"</li>
                        <li><strong>Click en "Devolver":</strong> Para cada producto que quiere devolver</li>
                        <li><strong>Ingresar cantidad:</strong> Cu谩ntas unidades devuelve</li>
                        <li><strong>Confirmar:</strong> El producto vuelve a la bodega principal</li>
                    </ol>

                    <h4>O desde Administraci贸n:</h4>
                    <ol>
                        <li><strong>Abrir Liquidaci贸n:</strong> <code>admin_inventario_liquidar_especiales.html</code></li>
                        <li><strong>Ver pedidos pendientes:</strong> Lista de productos asignados</li>
                        <li><strong>Seleccionar tipo:</strong> "Devoluci贸n Sobrante"</li>
                        <li><strong>Seleccionar destino:</strong> Bodega Principal</li>
                        <li><strong>Liquidar:</strong> El stock se actualiza autom谩ticamente</li>
                    </ol>

                    <h3><i class="fas fa-chart-line me-2"></i>Caso 5: Generar un Reporte de Facturaci贸n</h3>
                    
                    <h4>Objetivo:</h4>
                    <p>Ver cu谩nto se factur贸 en enero de 2026 y comparar con diciembre de 2025.</p>

                    <h4>Pasos:</h4>
                    <ol>
                        <li><strong>Abrir Reportes:</strong> <code>reportes_gerenciales.html</code></li>
                        <li><strong>Seleccionar filtros:</strong>
                            <ul>
                                <li>Mes: Enero 2026</li>
                                <li>Semana: (opcional, dejar en "Todas")</li>
                                <li>Empleado: (opcional, para ver por t茅cnico)</li>
                            </ul>
                        </li>
                        <li><strong>Ver "Reporte de Facturaci贸n por Empleado":</strong>
                            <ul>
                                <li>Tabla 1: Facturaci贸n total por d铆a</li>
                                <li>Tabla 2: Facturaci贸n por hora laborada</li>
                            </ul>
                        </li>
                        <li><strong>Analizar datos:</strong>
                            <ul>
                                <li>Ver qu茅 d铆as fueron m谩s productivos</li>
                                <li>Comparar entre t茅cnicos</li>
                                <li>Ver facturaci贸n por hora trabajada</li>
                            </ul>
                        </li>
                    </ol>

                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>Datos Importantes</h4>
                        <ul>
                            <li>La facturaci贸n se <strong>divide proporcionalmente</strong> entre los t茅cnicos asignados a cada cita</li>
                            <li>El d铆a operacional va de <strong>5:00 AM a 4:59 AM</strong> del d铆a siguiente</li>
                            <li>Los montos se muestran en <strong>miles</strong> (ej: 22k = 22,000)</li>
                            <li>Los domingos y feriados se colorean en <strong>morado claro</strong></li>
                        </ul>
                    </div>
                </div>

                <!-- Secci贸n: Flujos de Trabajo -->
                <div id="flujos-trabajo" class="content-section">
                    <h2><i class="fas fa-project-diagram me-2"></i>Flujos de Trabajo Completos</h2>
                    
                    <div class="info-box">
                        <p>Estos son los <strong>procesos completos</strong> que se realizan en el sistema, desde el inicio hasta el final:</p>
                    </div>

                    <h3><i class="fas fa-route me-2"></i>Flujo 1: Preparar una Ruta Completa</h3>
                    
                    <h4>Objetivo:</h4>
                    <p>Preparar todo lo necesario para que un t茅cnico salga a atender citas en su ruta.</p>

                    <h4>Proceso Completo:</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">1</span>
                                <strong>Revisar Citas del D铆a</strong><br>
                                <small>Calendario  Ver citas asignadas a la ruta</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">2</span>
                                <strong>Asignar T茅cnico y Veh铆culo</strong><br>
                                <small>Calendario  Click en ruta  Asignar t茅cnicos y veh铆culos</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">3</span>
                                <strong>Preparar Productos</strong><br>
                                <small>Pedidos Especiales  Crear pedido para el t茅cnico</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">4</span>
                                <strong>Preparar Herramientas</strong><br>
                                <small>Pedidos Especiales  Agregar herramientas necesarias</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">5</span>
                                <strong>隆Ruta Lista!</strong><br>
                                <small>T茅cnico tiene todo lo necesario</small>
                            </div>
                        </div>
                    </div>

                    <h4>Detalles de Cada Paso:</h4>
                    
                    <h5>Paso 1: Revisar Citas</h5>
                    <ul>
                        <li>Abrir <code>calendario.html</code></li>
                        <li>Seleccionar el d铆a</li>
                        <li>Ver citas de la ruta (ej: Ruta 3)</li>
                        <li>Verificar cantidad de citas y facturaci贸n total</li>
                    </ul>

                    <h5>Paso 2: Asignar T茅cnico</h5>
                    <ul>
                        <li>Click en el header de la ruta</li>
                        <li>Click en "Editar" (icono de l谩piz)</li>
                        <li>Seleccionar uno o m谩s t茅cnicos</li>
                        <li>Seleccionar veh铆culo</li>
                        <li>Guardar</li>
                    </ul>

                    <h5>Paso 3 y 4: Preparar Inventario</h5>
                    <ul>
                        <li>Abrir <code>admin_inventario_pedidos_especiales.html</code></li>
                        <li>Seleccionar empleado (el t茅cnico asignado)</li>
                        <li>Seleccionar fecha (el d铆a de la ruta)</li>
                        <li>Agregar productos necesarios (insecticidas, etc.)</li>
                        <li>Agregar herramientas si se necesitan</li>
                        <li>Click en "Alistar Productos/Herramientas"</li>
                    </ul>

                    <h3><i class="fas fa-check-circle me-2"></i>Flujo 2: Cerrar el D铆a de un T茅cnico</h3>
                    
                    <h4>Objetivo:</h4>
                    <p>Registrar todo lo que hizo el t茅cnico durante el d铆a y devolver lo que no us贸.</p>

                    <h4>Proceso:</h4>
                    <ol>
                        <li><strong>Marcar Salida:</strong>
                            <ul>
                                <li>T茅cnico abre <code>registro_horas.html</code></li>
                                <li>Click en "Finalizar Turno"</li>
                                <li>Se registra la hora de salida</li>
                            </ul>
                        </li>
                        <li><strong>Devolver Productos:</strong>
                            <ul>
                                <li>T茅cnico abre <code>operario_bodega.html</code></li>
                                <li>Ve "Mi Inventario"</li>
                                <li>Para cada producto no usado, click en "Devolver"</li>
                                <li>Ingresa cantidad a devolver</li>
                                <li>Confirma</li>
                            </ul>
                        </li>
                        <li><strong>Devolver Herramientas:</strong>
                            <ul>
                                <li>En la misma p谩gina, secci贸n "Herramientas Asignadas"</li>
                                <li>Click en "Devolver Herramienta"</li>
                                <li>Seleccionar herramienta</li>
                                <li>Confirmar devoluci贸n</li>
                            </ul>
                        </li>
                        <li><strong>Liquidar desde Admin (Opcional):</strong>
                            <ul>
                                <li>Admin abre <code>admin_inventario_liquidar_especiales.html</code></li>
                                <li>Ve pedidos pendientes del t茅cnico</li>
                                <li>Para productos usados: Tipo "Gasto (Consumo)"</li>
                                <li>Para productos devueltos: Tipo "Devoluci贸n Sobrante"</li>
                                <li>Liquidar cada 铆tem</li>
                            </ul>
                        </li>
                    </ol>

                    <h3><i class="fas fa-shopping-cart me-2"></i>Flujo 3: Registrar una Compra de Productos</h3>
                    
                    <h4>Objetivo:</h4>
                    <p>Cuando compramos productos nuevos, registrarlos en el inventario.</p>

                    <h4>Proceso:</h4>
                    <ol>
                        <li><strong>Abrir Inventario:</strong> <code>administrador_bodega.html</code></li>
                        <li><strong>Ir a "Compras":</strong> Secci贸n en el men煤</li>
                        <li><strong>Crear Nueva Compra:</strong>
                            <ul>
                                <li>Seleccionar proveedor</li>
                                <li>Seleccionar fecha de compra</li>
                                <li>Agregar productos comprados</li>
                                <li>Ingresar cantidades</li>
                                <li>Ingresar precios</li>
                            </ul>
                        </li>
                        <li><strong>Guardar Compra:</strong> El stock se actualiza autom谩ticamente</li>
                        <li><strong>Verificar:</strong> Revisar que el stock aument贸 correctamente</li>
                    </ol>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i>Resultado</h4>
                        <p>Los productos quedan disponibles en la bodega principal y pueden ser asignados a t茅cnicos o usados en servicios.</p>
                    </div>
                </div>

                <!-- Secci贸n: Arquitectura del Sitio -->
                <div id="arquitectura" class="content-section">
                    <h2><i class="fas fa-sitemap me-2"></i>Arquitectura y Funcionamiento del Sitio</h2>
                    
                    <div class="info-box">
                        <p>Esta secci贸n explica <strong>c贸mo est谩 construido el sitio</strong>, c贸mo funcionan las partes internamente y c贸mo se comunican entre s铆:</p>
                    </div>

                    <h3><i class="fas fa-building me-2"></i>Estructura General del Sitio</h3>
                    
                    <div class="diagram-container">
                        <h4>Arquitectura del Sistema</h4>
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box primary" style="width: 90%; margin: 10px 0;">
                                <strong>Navegador (Cliente)</strong><br>
                                <small>HTML, CSS, JavaScript</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 90%; margin: 10px 0; display: flex; justify-content: space-around;">
                                <div style="flex: 1; margin: 0 5px;">
                                    <strong>Firebase Hosting</strong><br>
                                    <small>Sitio Web</small>
                                </div>
                                <div style="flex: 1; margin: 0 5px;">
                                    <strong>Firebase Auth</strong><br>
                                    <small>Autenticaci贸n</small>
                                </div>
                                <div style="flex: 1; margin: 0 5px;">
                                    <strong>Firestore</strong><br>
                                    <small>Base de Datos</small>
                                </div>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 90%; margin: 10px 0;">
                                <strong>Colecciones de Datos</strong><br>
                                <small>citas, empleados, productos, etc.</small>
                            </div>
                        </div>
                    </div>

                    <h4>Componentes Principales:</h4>
                    <ul>
                        <li><strong>Frontend (Cliente):</strong> Todo lo que el usuario ve y con lo que interact煤a (HTML, CSS, JavaScript)</li>
                        <li><strong>Firebase Hosting:</strong> Donde est谩n alojados los archivos del sitio web</li>
                        <li><strong>Firebase Authentication:</strong> Sistema que verifica qui茅n es el usuario</li>
                        <li><strong>Firestore Database:</strong> Donde se guardan todos los datos</li>
                    </ul>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-shield-alt me-2"></i>Sistema de Autenticaci贸n y Permisos</h3>
                    
                    <h4>驴C贸mo Funciona la Autenticaci贸n?</h4>
                    <p>El sitio tiene un <strong>sistema de seguridad de dos niveles</strong>:</p>

                    <h5>1. Autenticaci贸n (驴Qui茅n eres?)</h5>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">1</span>
                                <strong>Usuario ingresa credenciales</strong><br>
                                <small>Username y password en iniciar_sesion.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">2</span>
                                <strong>Firebase Auth verifica</strong><br>
                                <small>Comprueba si el usuario existe</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">3</span>
                                <strong>Se crea una sesi贸n</strong><br>
                                <small>Token JWT que identifica al usuario</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">4</span>
                                <strong>Usuario autenticado</strong><br>
                                <small>Puede acceder al sitio</small>
                            </div>
                        </div>
                    </div>

                    <h5>2. Autorizaci贸n (驴Qu茅 puedes hacer?)</h5>
                    <p>Una vez autenticado, el sistema verifica <strong>qu茅 permisos tiene el usuario</strong>:</p>
                    
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Usuario intenta acceder</strong><br>
                                <small>Ej: calendario.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>check-permissions.js verifica</strong><br>
                                <small>驴Tiene permiso para "calendario"?</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Consulta permisos del usuario</strong><br>
                                <small>En colecci贸n "users" o "empleados"</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>Permite o deniega acceso</strong><br>
                                <small>Seg煤n los permisos</small>
                            </div>
                        </div>
                    </div>

                    <h4>Archivos Clave del Sistema de Seguridad:</h4>
                    <ul>
                        <li><strong><code>auth-secure.js</code>:</strong> Gestiona la autenticaci贸n con Firebase Auth</li>
                        <li><strong><code>check-permissions.js</code>:</strong> Verifica permisos antes de cargar cada p谩gina</li>
                        <li><strong><code>iniciar_sesion.html</code>:</strong> P谩gina de inicio de sesi贸n</li>
                    </ul>

                    <h4>Flujo de Verificaci贸n de Permisos:</h4>
                    <ol>
                        <li><strong>Cada p谩gina carga</strong> <code>check-permissions.js</code> al inicio</li>
                        <li><strong>check-permissions.js verifica:</strong>
                            <ul>
                                <li>驴Est谩 el usuario autenticado?</li>
                                <li>驴Qu茅 p谩gina est谩 intentando abrir?</li>
                                <li>驴Qu茅 permiso requiere esa p谩gina?</li>
                                <li>驴Tiene el usuario ese permiso?</li>
                            </ul>
                        </li>
                        <li><strong>Si no tiene permiso:</strong> Muestra mensaje de "Acceso Denegado"</li>
                        <li><strong>Si tiene permiso:</strong> La p谩gina se carga normalmente</li>
                    </ol>

                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>Mapeo de P谩ginas a Permisos</h4>
                        <p>En <code>check-permissions.js</code> hay un objeto que mapea cada p谩gina con el permiso que requiere:</p>
                        <div class="code-example">
PAGE_PERMISSIONS = {
    'calendario.html': 'calendario',
    'registro_horas.html': 'registro_horas',
    'reportes_gerenciales.html': 'reportes_gerenciales',
    'administrador_bodega.html': 'administrador_bodega',
    // ... m谩s p谩ginas
}
                        </div>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-puzzle-piece me-2"></i>Componentes Compartidos</h3>
                    
                    <p>El sitio tiene <strong>componentes que se reutilizan</strong> en m煤ltiples p谩ginas:</p>

                    <h4>1. Header (Encabezado)</h4>
                    <p><strong>Archivo:</strong> <code>header.html</code></p>
                    <p><strong>驴Qu茅 hace?</strong> Muestra el men煤 de navegaci贸n en la parte superior de cada p谩gina.</p>
                    
                    <h5>Componentes del Header:</h5>
                    <ul>
                        <li><strong>Logo de EcoPlagas:</strong> Siempre visible</li>
                        <li><strong>Men煤 de navegaci贸n:</strong> Lista de m贸dulos disponibles</li>
                        <li><strong>Informaci贸n del usuario:</strong> Nombre y foto (si est谩 disponible)</li>
                        <li><strong>Bot贸n de cerrar sesi贸n:</strong> Para salir del sistema</li>
                    </ul>

                    <h5>驴C贸mo se carga?</h5>
                    <p>Cada p谩gina incluye el header al inicio:</p>
                    <div class="code-example">
&lt;div id="header-container"&gt;&lt;/div&gt;
&lt;script&gt;
    // Cargar header din谩micamente
    fetch('header.html')
        .then(response => response.text())
        .then(html => {
            document.getElementById('header-container').innerHTML = html;
        });
&lt;/script&gt;
                    </div>

                    <h4>2. Footer (Pie de P谩gina)</h4>
                    <p><strong>Archivo:</strong> <code>footer.html</code> (si existe)</p>
                    <p><strong>驴Qu茅 hace?</strong> Muestra informaci贸n adicional en la parte inferior (copyright, enlaces, etc.)</p>

                    <h4>3. Scripts Compartidos</h4>
                    <p>Hay varios archivos JavaScript que se usan en m煤ltiples p谩ginas:</p>
                    <ul>
                        <li><strong><code>auth-secure.js</code>:</strong> Autenticaci贸n (todas las p谩ginas secure)</li>
                        <li><strong><code>check-permissions.js</code>:</strong> Verificaci贸n de permisos (todas las p谩ginas)</li>
                        <li><strong><code>inventario-movimientos-utils.js</code>:</strong> Funciones compartidas para inventario</li>
                        <li><strong><code>eco-plagas-styles.css</code>:</strong> Estilos compartidos</li>
                    </ul>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-exchange-alt me-2"></i>Flujo de Datos entre M贸dulos</h3>
                    
                    <h4>Ejemplo 1: Crear una Cita y Asignarla a una Ruta</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Usuario crea cita</strong><br>
                                <small>calendario.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Se guarda en Firestore</strong><br>
                                <small>Colecci贸n "citas"</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Usuario asigna ruta</strong><br>
                                <small>Click en "Editar Ruta"</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Se actualiza "ruteador"</strong><br>
                                <small>Colecci贸n "ruteador"</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>Reportes usan estos datos</strong><br>
                                <small>reportes_gerenciales.html</small>
                            </div>
                        </div>
                    </div>

                    <h4>Ejemplo 2: Registro de Horas y Reportes</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Empleado marca entrada</strong><br>
                                <small>registro_horas.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Se crea work_session</strong><br>
                                <small>Colecci贸n "work_sessions"</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Empleado marca salida</strong><br>
                                <small>Se actualiza work_session</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>Reportes leen work_sessions</strong><br>
                                <small>Calculan horas trabajadas</small>
                            </div>
                        </div>
                    </div>

                    <h4>Ejemplo 3: Inventario - Flujo Completo</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Admin crea pedido especial</strong><br>
                                <small>admin_inventario_pedidos_especiales.html</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Se crea movimiento_inventario</strong><br>
                                <small>tipo: "transferencia"</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>Se actualiza stock_bodegas</strong><br>
                                <small>Disminuye en origen, aumenta en destino</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>T茅cnico ve en operario_bodega.html</strong><br>
                                <small>Puede devolver o reportar gasto</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>Admin liquida desde admin_inventario_liquidar_especiales.html</strong><br>
                                <small>Se actualiza stock nuevamente</small>
                            </div>
                        </div>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-folder-open me-2"></i>Estructura de Archivos del Proyecto</h3>
                    
                    <h4>Organizaci贸n de Carpetas:</h4>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
cursorai/

 public/                           Todos los archivos del sitio web
    *.html                       P谩ginas principales
    *.js                         C贸digo JavaScript
    *.css                        Estilos
   
    calendario.html        M贸dulo de calendario
    registro_horas.html   M贸dulo de horas
    reportes_gerenciales.html  M贸dulo de reportes
   
    admin_inventario_*.html      M贸dulos de inventario (admin)
    operario_bodega.html   M贸dulo de inventario (operario)
   
    auth-secure.js               Sistema de autenticaci贸n
    check-permissions.js         Sistema de permisos
    header.html            Header compartido
   
    inventario-movimientos-utils.js  Utilidades compartidas

 firebase.json                     Configuraci贸n de Firebase
 firestore.rules                   Reglas de seguridad de Firestore
 package.json                      Informaci贸n del proyecto
                    </div>

                    <h4>Convenciones de Nombres:</h4>
                    <ul>
                        <li><strong>Archivos "secure":</strong> Versiones con autenticaci贸n Firebase (ej: <code>calendario.html</code>)</li>
                        <li><strong>Archivos sin "secure":</strong> Versiones legacy (antiguas, sin Firebase Auth)</li>
                        <li><strong>admin_inventario_*:</strong> M贸dulos de administraci贸n de inventario</li>
                        <li><strong>operario_*:</strong> M贸dulos para operarios (empleados)</li>
                    </ul>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-cogs me-2"></i>C贸mo Funcionan los M贸dulos Internamente</h3>
                    
                    <h4>Patr贸n Com煤n de Funcionamiento:</h4>
                    <p>Casi todos los m贸dulos siguen este patr贸n:</p>

                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">1</span>
                                <strong>P谩gina se carga</strong><br>
                                <small>HTML se renderiza</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">2</span>
                                <strong>Verificar autenticaci贸n</strong><br>
                                <small>check-permissions.js</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">3</span>
                                <strong>Cargar datos de Firestore</strong><br>
                                <small>onSnapshot o getDocs</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">4</span>
                                <strong>Mostrar datos en la p谩gina</strong><br>
                                <small>Crear HTML din谩micamente</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">5</span>
                                <strong>Escuchar cambios en tiempo real</strong><br>
                                <small>Actualizar autom谩ticamente</small>
                            </div>
                        </div>
                    </div>

                    <h4>Ejemplo de C贸digo T铆pico:</h4>
                    <div class="code-example">
// 1. Esperar autenticaci贸n
await waitForAuth();

// 2. Conectar con Firestore
const db = getFirestore();

// 3. Cargar datos
const citasRef = collection(db, 'citas');
onSnapshot(citasRef, (snapshot) => {
    const citas = [];
    snapshot.forEach(doc => {
        citas.push({ id: doc.id, ...doc.data() });
    });
    
    // 4. Mostrar en la p谩gina
    mostrarCitas(citas);
});

// 5. Los cambios se actualizan autom谩ticamente
                    </div>

                    <h4>Escucha en Tiempo Real (onSnapshot):</h4>
                    <p>Una caracter铆stica importante es que el sitio usa <strong>escucha en tiempo real</strong>:</p>
                    <ul>
                        <li><strong>onSnapshot:</strong> Escucha cambios en Firestore</li>
                        <li><strong>Actualizaci贸n autom谩tica:</strong> Si alguien m谩s hace un cambio, todos lo ven al instante</li>
                        <li><strong>Sin refrescar:</strong> No necesitas recargar la p谩gina</li>
                    </ul>

                    <div class="info-box">
                        <h4><i class="fas fa-lightbulb me-2"></i>Ejemplo Pr谩ctico</h4>
                        <p>Si dos personas est谩n viendo el calendario al mismo tiempo:</p>
                        <ol>
                            <li>Persona A crea una nueva cita</li>
                            <li>La cita se guarda en Firestore</li>
                            <li>Persona B ve la cita aparecer autom谩ticamente en su pantalla</li>
                            <li>No necesita refrescar la p谩gina</li>
                        </ol>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-link me-2"></i>Interconexi贸n entre M贸dulos</h3>
                    
                    <h4>M贸dulos que se Relacionan:</h4>
                    
                    <h5>1. Calendario  Ruteador  Reportes</h5>
                    <ul>
                        <li><strong>Calendario:</strong> Crea citas y las asigna a rutas</li>
                        <li><strong>Ruteador:</strong> Asigna t茅cnicos a las rutas</li>
                        <li><strong>Reportes:</strong> Lee citas y ruteador para calcular facturaci贸n por t茅cnico</li>
                    </ul>

                    <h5>2. Registro de Horas  Reportes</h5>
                    <ul>
                        <li><strong>Registro de Horas:</strong> Crea work_sessions cuando empleados marcan entrada/salida</li>
                        <li><strong>Reportes:</strong> Lee work_sessions para calcular horas trabajadas</li>
                    </ul>

                    <h5>3. Inventario (M煤ltiples M贸dulos)</h5>
                    <ul>
                        <li><strong>Pedidos Especiales:</strong> Crea movimientos_inventario y actualiza stock_bodegas</li>
                        <li><strong>Liquidaci贸n:</strong> Lee pedidos pendientes y crea nuevos movimientos</li>
                        <li><strong>Operario Bodega:</strong> Lee stock de bodegas especiales y crea movimientos de devoluci贸n</li>
                        <li><strong>Transacciones:</strong> Muestra todos los movimientos_inventario</li>
                        <li><strong>Productos:</strong> Muestra cat谩logo y stock global</li>
                    </ul>

                    <h5>4. Calendario  Encuestas</h5>
                    <ul>
                        <li><strong>Calendario:</strong> Genera links de encuestas para cada cita</li>
                        <li><strong>Reporte de Encuestas:</strong> Lee respuestas de encuestas y las vincula con citas</li>
                    </ul>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-database me-2"></i>C贸mo se Actualizan los Datos</h3>
                    
                    <h4>Operaciones B谩sicas en Firestore:</h4>
                    
                    <h5>1. Leer Datos (Read)</h5>
                    <div class="code-example">
// Leer una vez
const doc = await getDoc(doc(db, 'empleados', 'pablo.paniagua'));

// Leer m煤ltiples documentos
const snapshot = await getDocs(collection(db, 'citas'));

// Escuchar cambios en tiempo real
onSnapshot(collection(db, 'citas'), (snapshot) => {
    // Se ejecuta cada vez que hay cambios
});
                    </div>

                    <h5>2. Crear Datos (Create)</h5>
                    <div class="code-example">
// Crear nuevo documento
await addDoc(collection(db, 'citas'), {
    telefono: '50683331234',
    inicio_gmt6: Timestamp.now(),
    metadata: { ... }
});
                    </div>

                    <h5>3. Actualizar Datos (Update)</h5>
                    <div class="code-example">
// Actualizar documento existente
await updateDoc(doc(db, 'citas', 'citaId123'), {
    'metadata.estado': 'completada',
    fecha_actualizacion: serverTimestamp()
});
                    </div>

                    <h5>4. Eliminar Datos (Delete)</h5>
                    <div class="code-example">
// Eliminar documento
await deleteDoc(doc(db, 'citas', 'citaId123'));
                    </div>

                    <h5>5. Operaciones en Lote (Batch)</h5>
                    <div class="code-example">
// Hacer m煤ltiples operaciones a la vez
const batch = writeBatch(db);
batch.update(doc(db, 'stock_bodegas', 'stock1'), { stockActual: 10 });
batch.update(doc(db, 'stock_bodegas', 'stock2'), { stockActual: 5 });
await batch.commit();
                    </div>

                    <h4>Actualizaciones At贸micas:</h4>
                    <p>Para evitar problemas cuando dos personas actualizan al mismo tiempo, se usan <strong>operaciones at贸micas</strong>:</p>
                    <div class="code-example">
// Incrementar/decrementar de forma segura
await updateDoc(doc(db, 'stock_bodegas', 'stockId'), {
    stockActual: increment(-1)  // Resta 1 de forma at贸mica
});
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-mobile-alt me-2"></i>Responsive Design (Dise帽o Adaptable)</h3>
                    
                    <p>El sitio est谩 dise帽ado para funcionar en diferentes dispositivos:</p>
                    <ul>
                        <li><strong>Computadoras:</strong> Vista completa con todas las funcionalidades</li>
                        <li><strong>Tablets:</strong> Dise帽o adaptado para pantallas medianas</li>
                        <li><strong>M贸viles:</strong> Men煤 simplificado, botones m谩s grandes</li>
                    </ul>

                    <h4>Caracter铆sticas Responsive:</h4>
                    <ul>
                        <li><strong>Men煤 hamburguesa:</strong> En m贸viles, el men煤 se convierte en un bot贸n de hamburguesa ()</li>
                        <li><strong>Tablas scrollables:</strong> Las tablas grandes tienen scroll horizontal en m贸viles</li>
                        <li><strong>Botones t谩ctiles:</strong> Botones m谩s grandes para facilitar el toque</li>
                        <li><strong>Footer m贸vil:</strong> Men煤 de navegaci贸n en la parte inferior en m贸viles</li>
                    </ul>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-bolt me-2"></i>Optimizaciones y Mejores Pr谩cticas</h3>
                    
                    <h4>1. Carga de Datos:</h4>
                    <ul>
                        <li><strong>Lazy Loading:</strong> Algunos datos se cargan solo cuando se necesitan</li>
                        <li><strong>Cach茅:</strong> Los datos se guardan en memoria para evitar consultas repetidas</li>
                        <li><strong>Filtros en Firestore:</strong> Se filtran datos en la base de datos, no en el cliente</li>
                    </ul>

                    <h4>2. Rendimiento:</h4>
                    <ul>
                        <li><strong>ndices:</strong> Firestore usa 铆ndices para consultas r谩pidas</li>
                        <li><strong>Paginaci贸n:</strong> Algunas listas grandes se cargan por partes</li>
                        <li><strong>Debounce:</strong> Los buscadores esperan a que dejes de escribir antes de buscar</li>
                    </ul>

                    <h4>3. Seguridad:</h4>
                    <ul>
                        <li><strong>Validaci贸n en cliente y servidor:</strong> Se valida tanto en JavaScript como en Firestore Rules</li>
                        <li><strong>Tokens JWT:</strong> Las sesiones usan tokens seguros que expiran</li>
                        <li><strong>HTTPS:</strong> Toda la comunicaci贸n es encriptada</li>
                    </ul>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i>Resumen</h4>
                        <p>El sitio est谩 construido con una <strong>arquitectura modular</strong> donde:</p>
                        <ul>
                            <li> Cada m贸dulo tiene una funci贸n espec铆fica</li>
                            <li> Los m贸dulos se comunican a trav茅s de Firestore</li>
                            <li> Hay componentes compartidos (header, auth, permisos)</li>
                            <li> Todo funciona en tiempo real</li>
                            <li> El sistema es seguro y escalable</li>
                        </ul>
                    </div>

                    <!-- Quiz: Arquitectura -->
                    <div class="quiz-container" data-quiz-id="arquitectura">
                        <h3><i class="fas fa-sitemap me-2"></i>锔 Reto: Arquitecto del Sistema</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Qu茅 archivo verifica los permisos antes de cargar una p谩gina?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="arquitectura_q1" value="a"> auth-secure.js</label>
                                    <label><input type="radio" name="arquitectura_q1" value="b"> check-permissions.js</label>
                                    <label><input type="radio" name="arquitectura_q1" value="c"> iniciar_sesion.html</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 es onSnapshot en Firestore?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="arquitectura_q2" value="a"> Un m茅todo que escucha cambios en tiempo real</label>
                                    <label><input type="radio" name="arquitectura_q2" value="b"> Un tipo de dato</label>
                                    <label><input type="radio" name="arquitectura_q2" value="c"> Un archivo de configuraci贸n</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 diferencia hay entre autenticaci贸n y autorizaci贸n?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="arquitectura_q3" value="a"> Son lo mismo</label>
                                    <label><input type="radio" name="arquitectura_q3" value="b"> Autenticaci贸n verifica qui茅n eres, autorizaci贸n verifica qu茅 puedes hacer</label>
                                    <label><input type="radio" name="arquitectura_q3" value="c"> Autenticaci贸n es para m贸viles, autorizaci贸n para computadoras</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 archivo maneja la autenticaci贸n de usuarios en el sistema?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="arquitectura_q4" value="a"> check-permissions.js</label>
                                    <label><input type="radio" name="arquitectura_q4" value="b"> auth-secure.js</label>
                                    <label><input type="radio" name="arquitectura_q4" value="c"> iniciar_sesion.html</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 significa que el sitio es "responsive"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="arquitectura_q5" value="a"> Solo funciona en computadoras</label>
                                    <label><input type="radio" name="arquitectura_q5" value="b"> Se adapta a diferentes tama帽os de pantalla (computadoras, tablets, m贸viles)</label>
                                    <label><input type="radio" name="arquitectura_q5" value="c"> Responde r谩pido a los clics</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 es una operaci贸n at贸mica en Firestore?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="arquitectura_q6" value="a"> Una operaci贸n que solo funciona con 谩tomos</label>
                                    <label><input type="radio" name="arquitectura_q6" value="b"> Una operaci贸n que se ejecuta de forma segura para evitar problemas cuando dos personas actualizan al mismo tiempo</label>
                                    <label><input type="radio" name="arquitectura_q6" value="c"> Una operaci贸n muy r谩pida</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto" onclick="enviarQuiz('arquitectura')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-arquitectura"></div>
                    </div>
                </div>

                <!-- Secci贸n: M贸dulos en Detalle -->
                <div id="modulos-detalle" class="content-section">
                    <h2><i class="fas fa-list-alt me-2"></i>M贸dulos en Detalle</h2>
                    
                    <div class="info-box">
                        <p>Aqu铆 encontrar谩s una explicaci贸n <strong>detallada</strong> de cada m贸dulo: su objetivo, funcionalidades espec铆ficas y c贸mo usarlo:</p>
                    </div>

                    <h3><i class="fas fa-calendar-alt me-2"></i>1. Calendario de Servicios</h3>
                    <p><strong>Archivo:</strong> <code>calendario.html</code></p>
                    <p><strong>URL:</strong> <code>https://ecoplagas.online/calendario.html</code></p>
                    
                    <h4> Objetivo Principal</h4>
                    <p>Gestionar todas las citas de servicio de manera eficiente, organiz谩ndolas por rutas, asignando t茅cnicos y visualizando el trabajo del d铆a.</p>

                    <h4>锔 Funcionalidades Espec铆ficas</h4>
                    
                    <h5>Vista de D铆a</h5>
                    <ul>
                        <li><strong>Ver citas por ruta:</strong> Cada ruta muestra sus citas en columnas</li>
                        <li><strong>Facturaci贸n total del d铆a:</strong> Se muestra en la parte superior</li>
                        <li><strong>Cantidad de citas por ruta:</strong> Aparece en el header de cada ruta</li>
                        <li><strong>Citas lado a lado:</strong> Si hay 2+ citas a la misma hora, se muestran juntas</li>
                        <li><strong>Navegaci贸n:</strong> Botones "D铆a Anterior" y "D铆a Siguiente"</li>
                    </ul>

                    <h5>Vista de Cronograma</h5>
                    <ul>
                        <li><strong>Timeline visual:</strong> Ver citas en una l铆nea de tiempo</li>
                        <li><strong>Arrastrar y soltar:</strong> Mover citas cambiando su hora</li>
                        <li><strong>Crear citas arrastrando:</strong> Arrastrar en 谩rea vac铆a para crear nueva cita</li>
                        <li><strong>Rutas diurnas y nocturnas:</strong> Separadas en secciones</li>
                    </ul>

                    <h5>Gesti贸n de Citas</h5>
                    <ul>
                        <li><strong>Crear:</strong> Formulario completo con todos los datos</li>
                        <li><strong>Editar:</strong> Modificar cualquier campo de la cita</li>
                        <li><strong>Eliminar:</strong> Con confirmaci贸n de seguridad</li>
                        <li><strong>Duplicar:</strong> Crear citas similares r谩pidamente</li>
                    </ul>

                    <h5>Asignaci贸n de Recursos</h5>
                    <ul>
                        <li><strong>T茅cnicos:</strong> Asignar uno o m谩s t茅cnicos a una ruta</li>
                        <li><strong>Veh铆culos:</strong> Asignar veh铆culo a cada ruta</li>
                        <li><strong>Rutas:</strong> 20 rutas disponibles (1-10 diurnas, 11-20 nocturnas)</li>
                    </ul>

                    <h5>Integraciones</h5>
                    <ul>
                        <li><strong>Google Sheets:</strong> Actualizar citas desde una hoja de c谩lculo</li>
                        <li><strong>Mapas:</strong> Ver rutas en mapa interactivo</li>
                        <li><strong>Encuestas:</strong> Generar y enviar encuestas a clientes</li>
                    </ul>

                    <h4> Datos que Muestra</h4>
                    <ul>
                        <li>Facturaci贸n total del d铆a seleccionado</li>
                        <li>Cantidad de citas por ruta</li>
                        <li>Facturaci贸n por ruta</li>
                        <li>Duraci贸n total de citas</li>
                        <li>Estado de cada cita (Agendada, Confirmada, Completada, Cancelada)</li>
                    </ul>

                    <h4> Ejemplo Pr谩ctico: Crear una Cita Completa</h4>
                    <ol>
                        <li>Cliente: "Mar铆a Gonz谩lez", Tel: 8333-4567</li>
                        <li>Servicio: Fumigaci贸n residencial</li>
                        <li>Fecha: 20 de enero, 10:00 AM</li>
                        <li>Duraci贸n: 1 hora</li>
                        <li>Ruta: Ruta 5</li>
                        <li>Monto: 50,000</li>
                        <li>Ubicaci贸n: San Jos茅, Escaz煤</li>
                    </ol>
                    <p><strong>Resultado:</strong> La cita aparece en el calendario del 20 de enero, en la columna de Ruta 5, y se puede asignar un t茅cnico.</p>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-clock me-2"></i>2. Registro de Horas</h3>
                    <p><strong>Archivo:</strong> <code>registro_horas.html</code></p>
                    <p><strong>URL:</strong> <code>https://ecoplagas.online/registro_horas.html</code></p>
                    
                    <h4> Objetivo Principal</h4>
                    <p>Controlar las horas trabajadas por cada empleado, diferenciando entre jornadas diurnas y nocturnas, y calculando horas trabajadas correctamente.</p>

                    <h4>锔 Funcionalidades Espec铆ficas</h4>
                    
                    <h5>Gesti贸n de Turnos</h5>
                    <ul>
                        <li><strong>Iniciar Turno:</strong> Marcar entrada (autom谩tico o manual)</li>
                        <li><strong>Finalizar Turno:</strong> Marcar salida</li>
                        <li><strong>Jornada Diurna:</strong> 5:00 AM - 5:00 PM</li>
                        <li><strong>Jornada Nocturna:</strong> 5:00 PM - 5:00 AM</li>
                        <li><strong>Turnos M煤ltiples:</strong> Un empleado puede tener varios turnos en un d铆a</li>
                    </ul>

                    <h5>D铆a Laborable Especial</h5>
                    <ul>
                        <li><strong>Inicio:</strong> 5:00 AM del d铆a</li>
                        <li><strong>Fin:</strong> 4:59 AM del d铆a siguiente</li>
                        <li><strong>Ejemplo:</strong> Si alguien marca a las 4:30 AM, pertenece al d铆a laborable anterior</li>
                    </ul>

                    <h5>Visualizaci贸n</h5>
                    <ul>
                        <li><strong>Pulso de Horas:</strong> Animaci贸n que muestra actividad</li>
                        <li><strong>Colaboradores Conectados:</strong> Quienes tienen turnos activos</li>
                        <li><strong>Colaboradores Desconectados:</strong> Quienes no tienen turnos</li>
                        <li><strong>Mapa GPS:</strong> Ver ubicaciones de empleados en tiempo real</li>
                    </ul>

                    <h4> Datos que Registra</h4>
                    <ul>
                        <li>Hora de inicio de cada turno</li>
                        <li>Hora de fin de cada turno</li>
                        <li>Total de horas trabajadas</li>
                        <li>Tipo de jornada (diurna/nocturna)</li>
                        <li>Ubicaci贸n GPS (si est谩 disponible)</li>
                    </ul>

                    <h4> Ejemplo Pr谩ctico: Jornada Completa</h4>
                    <ol>
                        <li><strong>5:30 AM:</strong> T茅cnico marca entrada (Jornada Diurna)</li>
                        <li><strong>1:00 PM:</strong> T茅cnico marca salida (almuerzo)</li>
                        <li><strong>2:00 PM:</strong> T茅cnico marca entrada nuevamente</li>
                        <li><strong>5:00 PM:</strong> T茅cnico marca salida</li>
                    </ol>
                    <p><strong>Resultado:</strong> Sistema registra 2 turnos diurnos: 7.5 horas + 3 horas = 10.5 horas totales.</p>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-chart-bar me-2"></i>3. Reportes Gerenciales</h3>
                    <p><strong>Archivo:</strong> <code>reportes_gerenciales.html</code></p>
                    <p><strong>URL:</strong> <code>https://ecoplagas.online/reportes_gerenciales.html</code></p>
                    
                    <h4> Objetivo Principal</h4>
                    <p>Proporcionar an谩lisis detallados del negocio para tomar decisiones informadas sobre horas trabajadas, facturaci贸n y rendimiento de empleados.</p>

                    <h4>锔 Funcionalidades Espec铆ficas</h4>
                    
                    <h5>Reporte de Horas por D铆a</h5>
                    <ul>
                        <li><strong>Tabla 1:</strong> Horas trabajadas por empleado por d铆a</li>
                        <li><strong>Tabla 2:</strong> Horas trabajadas por empleado por d铆a por hora laborada</li>
                        <li><strong>Colores:</strong> Verde = muchas horas, Rojo = pocas horas</li>
                        <li><strong>Vacaciones:</strong> Celda morada con "V"</li>
                        <li><strong>Domingos/Feriados:</strong> Fondo morado claro</li>
                    </ul>

                    <h5>Reporte de Facturaci贸n por Empleado</h5>
                    <ul>
                        <li><strong>Tabla 1:</strong> Facturaci贸n total por empleado por d铆a</li>
                        <li><strong>Tabla 2:</strong> Facturaci贸n por empleado por d铆a por hora laborada</li>
                        <li><strong>Divisi贸n proporcional:</strong> Si 2 t茅cnicos atienden una cita, el monto se divide entre ellos</li>
                        <li><strong>Formato:</strong> Montos en miles (22k = 22,000)</li>
                        <li><strong>Colores invertidos:</strong> Verde = alto monto, Rojo = bajo monto</li>
                    </ul>

                    <h5>Filtros Disponibles</h5>
                    <ul>
                        <li><strong>Mes:</strong> Seleccionar cualquier mes</li>
                        <li><strong>Semana:</strong> Filtrar por semana espec铆fica</li>
                        <li><strong>Empleado:</strong> Ver reporte de un empleado espec铆fico</li>
                    </ul>

                    <h4> Datos que Analiza</h4>
                    <ul>
                        <li>Horas trabajadas por cada empleado</li>
                        <li>Facturaci贸n atribuida a cada t茅cnico</li>
                        <li>Rendimiento por hora trabajada</li>
                        <li>Comparaciones entre d铆as/semanas/meses</li>
                        <li>D铆as de vacaciones</li>
                    </ul>

                    <h4> Ejemplo Pr谩ctico: An谩lisis Mensual</h4>
                    <p><strong>Pregunta:</strong> "驴Cu谩nto factur贸 Juan en enero comparado con diciembre?"</p>
                    <ol>
                        <li>Abrir Reportes Gerenciales</li>
                        <li>Filtrar por: Mes = Enero 2026, Empleado = Juan P茅rez</li>
                        <li>Ver tabla de facturaci贸n por d铆a</li>
                        <li>Sumar totales</li>
                        <li>Repetir para Diciembre 2025</li>
                        <li>Comparar resultados</li>
                    </ol>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-warehouse me-2"></i>4. M贸dulos de Inventario</h3>
                    
                    <h4>4.1. Administrador de Bodega</h4>
                    <p><strong>Archivo:</strong> <code>administrador_bodega.html</code></p>
                    
                    <h5> Objetivo</h5>
                    <p>Gestionar todo el inventario: productos, herramientas, bodegas, compras, gastos y movimientos.</p>

                    <h5>锔 Funcionalidades</h5>
                    <ul>
                        <li><strong>Ver Stock:</strong> Cantidad disponible en cada bodega</li>
                        <li><strong>Compras:</strong> Registrar compras de productos</li>
                        <li><strong>Gastos:</strong> Registrar consumo de productos</li>
                        <li><strong>Transferencias:</strong> Mover productos entre bodegas</li>
                        <li><strong>Recalcular Saldos:</strong> Verificar que los n煤meros est茅n correctos</li>
                        <li><strong>Anomal铆as:</strong> Ver productos con stock negativo</li>
                    </ul>

                    <h4>4.2. Operario de Bodega</h4>
                    <p><strong>Archivo:</strong> <code>operario_bodega.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/operario_bodega.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Mi Bodeguita (Operario)
                        </a>
                    </div>
                    
                    <h5> Objetivo</h5>
                    <p>Permitir que cada empleado vea y gestione su inventario personal (bodega especial).</p>

                    <h5>锔 Funcionalidades</h5>
                    <ul>
                        <li><strong>Mi Inventario:</strong> Ver productos asignados</li>
                        <li><strong>Herramientas Asignadas:</strong> Ver herramientas prestadas</li>
                        <li><strong>Devolver Productos:</strong> Devolver a bodega principal</li>
                        <li><strong>Devolver Herramientas:</strong> Devolver herramientas</li>
                        <li><strong>Reportar Gasto:</strong> Marcar productos como consumidos</li>
                        <li><strong>Gastos Recientes:</strong> Ver y revertir transacciones recientes</li>
                    </ul>

                    <h4>4.3. Productos y Herramientas</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_productos.html</code></p>
                    
                    <h5> Objetivo</h5>
                    <p>Gestionar el cat谩logo completo de productos e herramientas del sistema.</p>

                    <h5>锔 Funcionalidades</h5>
                    <ul>
                        <li><strong>Cat谩logo de Productos:</strong> Ver todos los productos</li>
                        <li><strong>Cat谩logo de Herramientas:</strong> Ver todas las herramientas</li>
                        <li><strong>Crear/Editar:</strong> Agregar o modificar 铆tems</li>
                        <li><strong>Ver Stock Global:</strong> Cantidad total en todas las bodegas</li>
                        <li><strong>Ver Transacciones:</strong> Cu谩ntas veces se ha usado cada 铆tem</li>
                        <li><strong>Resumen Pivot:</strong> Comparar productos vs herramientas</li>
                    </ul>

                    <h4>4.4. Pedidos Especiales</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_pedidos_especiales.html</code></p>
                    
                    <h5> Objetivo</h5>
                    <p>Asignar productos y herramientas a bodegas especiales (de empleados) de manera organizada.</p>

                    <h5>锔 Funcionalidades</h5>
                    <ul>
                        <li><strong>Crear Pedido:</strong> Seleccionar empleado y fecha</li>
                        <li><strong>Agregar Productos:</strong> Seleccionar de bodega principal</li>
                        <li><strong>Agregar Herramientas:</strong> Seleccionar de bodega principal herramientas</li>
                        <li><strong>Validaci贸n de Stock:</strong> No permite alistar si no hay stock</li>
                        <li><strong>Fecha del Pedido:</strong> Botones para seleccionar fecha f谩cilmente</li>
                        <li><strong>Cantidad:</strong> Solo n煤meros enteros, incrementos de 1</li>
                    </ul>

                    <h4>4.5. Liquidaci贸n</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_liquidar_especiales.html</code></p>
                    
                    <h5> Objetivo</h5>
                    <p>Cerrar los pedidos especiales cuando el empleado devuelve o consume los productos/herramientas.</p>

                    <h5>锔 Funcionalidades</h5>
                    <ul>
                        <li><strong>Ver Pedidos Pendientes:</strong> Lista de productos/herramientas asignados</li>
                        <li><strong>Liquidar Individual:</strong> Procesar cada 铆tem por separado</li>
                        <li><strong>Tipos de Liquidaci贸n:</strong>
                            <ul>
                                <li><strong>Gasto (Consumo):</strong> Solo para productos, descuenta del inventario</li>
                                <li><strong>Devoluci贸n Sobrante:</strong> Devuelve a bodega, aumenta stock</li>
                            </ul>
                        </li>
                        <li><strong>Para Herramientas:</strong> Solo permite "Devoluci贸n Sobrante"</li>
                        <li><strong>Destino:</strong> Seleccionar bodega de destino (para herramientas, solo bodegas de herramientas)</li>
                        <li><strong>Fecha Contable:</strong> Usa la fecha del pedido original</li>
                    </ul>

                    <h4>4.6. Transacciones</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_transacciones.html</code></p>
                    
                    <h5> Objetivo</h5>
                    <p>Ver el historial completo de todos los movimientos de inventario para auditor铆a y verificaci贸n.</p>

                    <h5>锔 Funcionalidades</h5>
                    <ul>
                        <li><strong>Ver Todas las Transacciones:</strong> Historial completo</li>
                        <li><strong>Filtros:</strong> Por fecha, producto, herramienta, bodega, tipo, usuario</li>
                        <li><strong>Detalles:</strong> Ver informaci贸n completa de cada transacci贸n</li>
                        <li><strong>Revertir:</strong> Deshacer transacciones incorrectas</li>
                    </ul>

                    <h4>4.7. Bodegas</h4>
                    <p><strong>Archivo:</strong> <code>admin_inventario_bodegas.html</code></p>
                    
                    <h5> Objetivo</h5>
                    <p>Gestionar las bodegas del sistema y verificar que los saldos est茅n correctos.</p>

                    <h5>锔 Funcionalidades</h5>
                    <ul>
                        <li><strong>Ver Bodegas:</strong> Lista de todas las bodegas</li>
                        <li><strong>Crear/Editar:</strong> Agregar o modificar bodegas</li>
                        <li><strong>Tipos:</strong> Principal, Especial, Herramientas</li>
                        <li><strong>Ver Stock:</strong> Cantidad de cada producto/herramienta por bodega</li>
                        <li><strong>Recalcular Saldos:</strong> Recalcular todos los saldos desde cero (煤til si hay discrepancias)</li>
                    </ul>
                </div>

                <!-- Secci贸n: Colecciones de Datos -->
                <div id="colecciones-datos" class="content-section">
                    <h2><i class="fas fa-database me-2"></i>Colecciones de Datos (Esquema de Base de Datos)</h2>
                    
                    <div class="info-box">
                        <p>Esta secci贸n explica <strong>c贸mo est谩 organizada la informaci贸n</strong> en Firebase. Es como un "mapa" de todas las "carpetas" donde guardamos datos y qu茅 informaci贸n contiene cada una.</p>
                    </div>

                    <h3><i class="fas fa-info-circle me-2"></i>驴Qu茅 es una Colecci贸n?</h3>
                    <p>Imagina que Firebase es como un <strong>archivero gigante</strong>. Cada <strong>colecci贸n</strong> es como una <strong>gaveta</strong> donde guardamos un tipo espec铆fico de informaci贸n:</p>
                    <ul>
                        <li><strong>Colecci贸n "citas":</strong> Guarda todas las citas de servicio</li>
                        <li><strong>Colecci贸n "empleados":</strong> Guarda informaci贸n de todos los empleados</li>
                        <li><strong>Colecci贸n "productos":</strong> Guarda el cat谩logo de productos</li>
                    </ul>
                    <p>Cada "documento" dentro de una colecci贸n es como una <strong>ficha</strong> con informaci贸n espec铆fica.</p>

                    <h3><i class="fas fa-calendar-alt me-2"></i>Colecciones de Citas y Clientes</h3>
                    
                    <h4>1. <code>citas</code> - Citas de Servicio</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Todas las citas agendadas para servicios de fumigaci贸n.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                        <strong>Datos B谩sicos:</strong><br>
                         <code>telefono</code>: Tel茅fono del cliente normalizado (ej: "50683331234") - Identifica al cliente<br>
                         <code>inicio_gmt6</code>: Fecha y hora de inicio de la cita en zona horaria GMT-6 (Costa Rica)<br>
                         <code>duracion_minutos</code>: Duraci贸n del servicio en minutos (15, 30, 45, 60, etc.)<br>
                         <code>fecha_creacion</code>: Timestamp de cu谩ndo se cre贸 el registro en el sistema<br>
                         <code>fecha_actualizacion</code>: Timestamp de la 煤ltima vez que se modific贸 la cita<br>
                         <code>version_esquema</code>: N煤mero de versi贸n del formato de datos (para migraciones futuras)<br><br>
                        
                        <strong>Datos Adicionales (metadata):</strong><br>
                         <code>metadata.cliente_nombre</code>: Nombre completo del cliente (para mostrar r谩pido sin consultar)<br>
                         <code>metadata.ruta</code>: Ruta asignada para el servicio ("Ruta 1", "Ruta 2", ..., "Sin asignar")<br>
                         <code>metadata.estado</code>: Estado actual de la cita ('agendada', 'confirmada', 'completada', 'cancelada')<br>
                         <code>metadata.monto</code>: Monto de venta en colones () - Usado para facturaci贸n<br>
                         <code>metadata.costo_servicio</code>: Costo interno del servicio en colones<br>
                         <code>metadata.direccion</code>: Direcci贸n completa donde se realizar谩 el servicio<br>
                         <code>metadata.observaciones</code>: Notas y observaciones adicionales sobre la cita<br>
                         <code>metadata.sucursalIndice</code>: ndice de la sucursal del cliente (0 = primera, 1 = segunda, etc.)<br>
                         <code>metadata.vendedores</code>: Array con IDs de los vendedores que atendieron al cliente<br>
                         <code>metadata.servicios</code>: Array con IDs de los servicios a realizar en esta cita<br>
                         <code>metadata.productos</code>: Array de productos de inventario a usar [{productoId, cantidad}]<br>
                         <code>metadata.equipo</code>: Array con IDs de equipo/herramientas necesarias<br>
                         <code>metadata.certificados</code>: Texto para generar certificados (cada l铆nea = 1 certificado)<br>
                         <code>metadata.whatsapp</code>: Link de WhatsApp para contactar al cliente<br>
                         <code>metadata.otras_se帽as</code>: Otras se帽as o indicaciones para llegar<br>
                         <code>metadata.turno</code>: Turno del d铆a ('diurno' o 'nocturno')<br>
                         <code>metadata.turno_emoji</code>: Emoji representativo del turno ( o )<br>
                         <code>metadata.provinciaId</code>: ID de la provincia donde est谩 la cita<br>
                         <code>metadata.cantonId</code>: ID del cant贸n donde est谩 la cita<br>
                         <code>metadata.distritoId</code>: ID del distrito donde est谩 la cita
                    </div>

                    <h5>Ejemplo de Documento:</h5>
                    <div class="code-example">
{
  "telefono": "50683331234",
  "inicio_gmt6": "2026-01-15T09:00:00-06:00",
  "duracion_minutos": 60,
  "metadata": {
    "cliente_nombre": "Mar铆a Gonz谩lez",
    "ruta": "Ruta 3",
    "estado": "agendada",
    "monto": 50000,
    "direccion": "San Jos茅, Escaz煤"
  },
  "fecha_creacion": "2026-01-10T14:30:00Z"
}
                    </div>

                    <h4>2. <code>clientes</code> - Informaci贸n de Clientes</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Datos maestros de cada cliente.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>telefono</code>: Tel茅fono normalizado sin guiones (ej: "50683331234") - Es el ID del documento<br>
                         <code>telefonoFormateado</code>: Tel茅fono con formato legible para mostrar (ej: "506-1234-5678")<br>
                         <code>nombre</code>: Nombre completo del cliente<br>
                         <code>totalCitas</code>: Contador de cu谩ntas citas ha tenido este cliente en total<br>
                         <code>sucursales</code>: Array num茅rico con 铆ndices de sucursales [0, 1, 2, ...] - Indica cu谩ntas direcciones tiene<br>
                         <code>fechaCreacion</code>: Timestamp de cu谩ndo se registr贸 el cliente por primera vez<br>
                         <code>fechaUltimaActualizacion</code>: Timestamp de la 煤ltima vez que se actualiz贸 la informaci贸n
                    </div>

                    <div class="info-box">
                        <h5><i class="fas fa-lightbulb me-2"></i>Nota Importante</h5>
                        <p>El <strong>ID del documento</strong> es el tel茅fono normalizado. Por ejemplo, si el tel茅fono es "8333-1234", el ID ser谩 "50683331234" (con c贸digo de pa铆s y sin guiones).</p>
                    </div>

                    <h4>3. <code>sucursales</code> - Direcciones de Clientes</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Cada cliente puede tener m煤ltiples direcciones (sucursales).</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>clienteTelefono</code>: Tel茅fono del cliente propietario (para vincular con la colecci贸n clientes)<br>
                         <code>indice</code>: N煤mero secuencial de la sucursal (0 = primera, 1 = segunda, 2 = tercera, etc.)<br>
                         <code>nombre</code>: Nombre descriptivo de la sucursal (ej: "Hogar principal", "Oficina", "Casa 2")<br>
                         <code>direccion</code>: Direcci贸n completa donde est谩 ubicada la sucursal<br>
                         <code>coordenadas</code>: Objeto con GPS {lat: n煤mero, lng: n煤mero, texto: "lat, lng"} - Opcional<br>
                         <code>provinciaId</code>: ID de la provincia donde est谩 la sucursal<br>
                         <code>cantonId</code>: ID del cant贸n donde est谩 la sucursal<br>
                         <code>distritoId</code>: ID del distrito donde est谩 la sucursal<br>
                         <code>otrasSenas</code>: Otras se帽as o indicaciones adicionales para llegar<br>
                         <code>fechaCreacion</code>: Timestamp de cu谩ndo se cre贸 esta sucursal<br>
                         <code>fechaUltimaFumigacion</code>: Timestamp de la 煤ltima vez que se fumig贸 (null si nunca)<br>
                         <code>totalFumigaciones</code>: Contador de cu谩ntas veces se ha fumigado en esta sucursal
                    </div>

                    <div class="info-box">
                        <h5><i class="fas fa-lightbulb me-2"></i>ID del Documento</h5>
                        <p>El ID se forma as铆: <code>"{telefono}_{indice}"</code>. Por ejemplo: <code>"50683331234_001"</code> (tel茅fono + 铆ndice con 3 d铆gitos).</p>
                    </div>

                    <h4>4. <code>ruteador</code> - Asignaci贸n de Rutas</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Qu茅 t茅cnicos y veh铆culos est谩n asignados a cada ruta en cada d铆a.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>ruta</code>: Nombre de la ruta ("Ruta 1", "Ruta 2", ..., "Ruta 20") - Identifica la ruta<br>
                         <code>fecha</code>: Fecha en formato string "YYYY-MM-DD" (ej: "2026-01-15") - D铆a de la asignaci贸n<br>
                         <code>tecnicos</code>: Array de strings con IDs (username) de t茅cnicos asignados a esta ruta<br>
                         <code>vehiculos</code>: Array de strings con IDs de veh铆culos asignados a esta ruta
                    </div>

                    <div class="info-box">
                        <h5><i class="fas fa-lightbulb me-2"></i>ID del Documento</h5>
                        <p>Formato: <code>"{ruta}_{fecha}"</code>. Ejemplo: <code>"Ruta 3_2026-01-15"</code></p>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-clock me-2"></i>Colecciones de Horas y Empleados</h3>
                    
                    <h4>5. <code>work_sessions</code> - Sesiones de Trabajo</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Cada vez que un empleado marca entrada y salida.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>username</code>: ID 煤nico del empleado (ej: "pablo.paniagua") - Vincula con colecci贸n empleados<br>
                         <code>userId</code>: Campo adicional para compatibilidad con sistema legacy<br>
                         <code>firebaseAuthUID</code>: ID 煤nico de autenticaci贸n de Firebase Auth - Para seguridad<br>
                         <code>startTime</code>: Timestamp de la hora exacta de inicio del turno<br>
                         <code>endTime</code>: Timestamp de la hora de fin del turno (null si el turno est谩 activo)<br>
                         <code>status</code>: Estado del turno - 'working' (activo/en curso) o 'completed' (cerrado/finalizado)<br>
                         <code>bodegaAPV</code>: ID de la bodega APV asignada al empleado (null si no tiene)<br>
                         <code>bodegaAPVNombre</code>: Nombre de la bodega APV (para mostrar r谩pido)<br>
                         <code>gpsStart</code>: Objeto con coordenadas GPS al iniciar {latitude, longitude, accuracy}<br>
                         <code>gpsEnd</code>: Objeto con coordenadas GPS al finalizar {latitude, longitude, accuracy}<br>
                         <code>inicioFueraRadio</code>: Boolean - true si inici贸 fuera del radio permitido desde Central Guachipelin<br>
                         <code>distanciaInicio</code>: N煤mero - Distancia en metros desde Central Guachipelin al iniciar<br>
                         <code>distanciaFin</code>: N煤mero - Distancia en metros desde Central Guachipelin al finalizar
                    </div>

                    <h4>6. <code>empleados</code> - Informaci贸n de Empleados</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Datos maestros de cada empleado.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>username</code>: ID 煤nico del empleado (ej: "pablo.paniagua") - Es el ID del documento<br>
                         <code>primerNombre</code>: Primer nombre del empleado<br>
                         <code>primerApellido</code>: Primer apellido del empleado<br>
                         <code>nombre</code>: Nombre completo formateado (para mostrar)<br>
                         <code>fechaIngreso</code>: Fecha de ingreso a la empresa en formato string "YYYY-MM-DD" (null si no aplica)<br>
                         <code>diasVacacionesAntes2025</code>: N煤mero de d铆as de vacaciones acumulados antes del a帽o 2025
                    </div>

                    <h4>7. <code>vacaciones</code> - Solicitudes de Vacaciones</h4>
                    <p><strong>驴Qu茅 guarda?</strong> D铆as que los empleados solicitan vacaciones.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>empleadoId</code>: ID (username) del empleado que solicita las vacaciones<br>
                         <code>empleadoNombre</code>: Nombre completo del empleado (para mostrar r谩pido)<br>
                         <code>estado</code>: Estado de la solicitud - 'pendiente' (esperando aprobaci贸n), 'aprobada' o 'rechazada'<br>
                         <code>fechaInicio</code>: Timestamp del primer d铆a de vacaciones<br>
                         <code>fechaFin</code>: Timestamp del 煤ltimo d铆a de vacaciones<br>
                         <code>fechaSolicitud</code>: Timestamp de cu谩ndo se hizo la solicitud<br>
                         <code>fechaHoraSolicitud</code>: String ISO de la fecha y hora de la solicitud<br>
                         <code>dias</code>: Array de Timestamps con cada d铆a individual de vacaci贸n (solo d铆as h谩biles)<br>
                         <code>totalDias</code>: N煤mero total de d铆as h谩biles solicitados<br>
                         <code>motivo</code>: Texto opcional con el motivo de la solicitud (null si no se especifica)
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-box me-2"></i>Colecciones de Inventario</h3>
                    
                    <h4>8. <code>productos</code> - Cat谩logo de Productos</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Todos los productos (insumos) que se usan en los servicios.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>nombre</code>: Nombre descriptivo del producto (ej: "Insecticida X", "Gel Bait")<br>
                         <code>categoria</code>: Categor铆a del producto (ej: "Insumos Gastables", "Equipos", "Gastables")<br>
                         <code>activo</code>: Boolean - true si el producto est谩 disponible para usar, false si est谩 desactivado<br>
                         <code>unidad</code>: Unidad de medida del producto (ej: "litro", "kg", "unidad", "gal贸n")<br>
                         <code>precio</code>: Precio unitario en colones (opcional, puede ser null)
                    </div>

                    <h4>9. <code>herramientas</code> - Cat谩logo de Herramientas</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Todas las herramientas que usan los t茅cnicos.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>nombre</code>: Nombre descriptivo de la herramienta (ej: "Termonebulizadora", "Aspiradora")<br>
                         <code>categoria</code>: Categor铆a de la herramienta (ej: "Herramientas", "Equipos")<br>
                         <code>activo</code>: Boolean - true si la herramienta est谩 disponible para usar, false si est谩 desactivada
                    </div>

                    <div class="warning-box">
                        <h5><i class="fas fa-exclamation-triangle me-2"></i>Importante</h5>
                        <p>Los <strong>productos</strong> se identifican con <code>productoId</code> y las <strong>herramientas</strong> con <code>herramientaId</code>. Son colecciones separadas pero funcionan de manera similar.</p>
                    </div>

                    <h4>10. <code>bodegas</code> - Bodegas de Almacenamiento</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Informaci贸n de todas las bodegas donde se guarda inventario.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>nombre</code>: Nombre descriptivo de la bodega (ej: "Bodega Principal", "Bodega Principal Herramientas")<br>
                         <code>tipo</code>: Tipo de bodega - 'principal' (productos), 'especial' (asignada a empleado), 'herramientas' (solo herramientas), 'apv' (personal de venta)<br>
                         <code>empleadoId</code>: ID (username) del empleado propietario (solo para bodegas tipo 'especial', null en otros casos)<br>
                         <code>sinInventario</code>: Boolean - true si es "Trabajo en Oficina Sin Inventario" (no lleva control de stock)
                    </div>

                    <h5>Tipos de Bodegas:</h5>
                    <ul>
                        <li><strong>Principal:</strong> Bodega principal de productos</li>
                        <li><strong>Principal Herramientas:</strong> Bodega principal de herramientas</li>
                        <li><strong>Especial:</strong> Bodega asignada a un empleado espec铆fico</li>
                        <li><strong>APV:</strong> Bodega asignada a personal de venta</li>
                        <li><strong>Herramientas:</strong> Bodegas solo para herramientas</li>
                    </ul>

                    <h4>11. <code>stock_bodegas</code> - Stock por Bodega</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Cu谩ntas unidades de cada producto/herramienta hay en cada bodega.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>bodegaId</code>: ID de la bodega donde est谩 el stock - Vincula con colecci贸n bodegas<br>
                         <code>productoId</code>: ID del producto (solo si es un producto, null si es herramienta) - Vincula con colecci贸n productos<br>
                         <code>herramientaId</code>: ID de la herramienta (solo si es una herramienta, null si es producto) - Vincula con colecci贸n herramientas<br>
                         <code>stockActual</code>: N煤mero - Cantidad actual disponible en stock (puede ser 0 o negativo si hay problemas)
                    </div>

                    <div class="info-box">
                        <h5><i class="fas fa-lightbulb me-2"></i>Importante</h5>
                        <p>Cada documento tiene <strong>solo uno</strong> de estos campos: <code>productoId</code> <strong>o</strong> <code>herramientaId</code>, nunca ambos. Esto indica si es un producto o una herramienta.</p>
                    </div>

                    <h4>12. <code>movimientos_inventario</code> - Historial de Movimientos</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Registro de TODOS los movimientos de inventario (compras, gastos, transferencias, devoluciones).</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>fecha</code>: Timestamp de cu谩ndo se registr贸 el movimiento en el sistema<br>
                         <code>fechaContable</code>: Timestamp de la fecha contable (puede ser diferente a fecha, ej: pedido del 10 liquidado el 12)<br>
                         <code>tipo</code>: Tipo de movimiento - 'compra' (entrada), 'gasto' (salida por consumo), 'transferencia' (entre bodegas), 'devolucion' (retorno), 'liquidacion' (cierre de pedido especial)<br>
                         <code>origen</code>: ID de bodega de origen (null si es compra o gasto directo)<br>
                         <code>destino</code>: ID de bodega destino o ID de cuenta de gasto (depende del tipo)<br>
                         <code>productoId</code>: ID del producto movido (null si es herramienta) - Vincula con colecci贸n productos<br>
                         <code>herramientaId</code>: ID de la herramienta movida (null si es producto) - Vincula con colecci贸n herramientas<br>
                         <code>cantidad</code>: N煤mero - Cantidad movida (positiva para entradas, negativa para salidas)<br>
                         <code>usuario</code>: ID (username) del usuario que realiz贸 el movimiento - Para auditor铆a<br>
                         <code>descripcion</code>: Texto descriptivo del movimiento (ej: "Compra a proveedor X", "Devoluci贸n de sobrante")<br>
                         <code>esPedidoEspecial</code>: Boolean - true si este movimiento proviene de un pedido especial<br>
                         <code>proveedorId</code>: ID del proveedor (solo para compras, null en otros casos)<br>
                         <code>cuentaGastoId</code>: ID de cuenta de gasto (solo para gastos, null en otros casos)
                    </div>

                    <div class="success-box">
                        <h5><i class="fas fa-check-circle me-2"></i>Uso Importante</h5>
                        <p>Esta colecci贸n es como un <strong>"libro contable"</strong> de inventario. Cada vez que algo se mueve, se crea un registro aqu铆. Esto permite:</p>
                        <ul>
                            <li>Ver el historial completo</li>
                            <li>Recalcular saldos desde cero</li>
                            <li>Auditar movimientos</li>
                            <li>Revertir transacciones incorrectas</li>
                        </ul>
                    </div>

                    <h4>13. <code>cuentas_gasto</code> - Cuentas de Gasto</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Cuentas donde se registran gastos (consumo de productos).</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>nombre</code>: Nombre descriptivo de la cuenta de gasto (ej: "Gastos Operativos", "Mantenimiento")<br>
                         <code>activo</code>: Boolean - true si la cuenta est谩 disponible para usar, false si est谩 desactivada
                    </div>

                    <h4>14. <code>proveedores</code> - Proveedores</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Informaci贸n de proveedores de productos.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>nombre</code>: Nombre o raz贸n social del proveedor (ej: "Proveedor ABC S.A.", "Distribuidora XYZ")<br>
                         <code>activo</code>: Boolean - true si el proveedor est谩 activo y se puede usar, false si est谩 desactivado
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-poll me-2"></i>Colecciones de Encuestas</h3>
                    
                    <h4>15. <code>encuestas_id</code> - IDs de Encuestas</h4>
                    <p><strong>驴Qu茅 guarda?</strong> IDs 煤nicos generados para cada encuesta de satisfacci贸n.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>id_encuesta</code>: ID 煤nico alfanum茅rico generado (m谩ximo 9 caracteres) - Es el ID del documento<br>
                         <code>telefono</code>: Tel茅fono normalizado del cliente - Para vincular con la cita<br>
                         <code>fecha_servicio</code>: Timestamp de la fecha del servicio - Para identificar la cita correcta<br>
                         <code>cita_id</code>: ID de la cita relacionada - Vincula directamente con la colecci贸n citas
                    </div>

                    <h4>16. <code>encuestas</code> - Respuestas de Encuestas</h4>
                    <p><strong>驴Qu茅 guarda?</strong> Respuestas de los clientes a las encuestas de satisfacci贸n.</p>
                    
                    <h5>Campos Principales:</h5>
                    <div class="code-example" style="background: #f8f9fa; padding: 15px; border-radius: 5px; margin: 10px 0;">
                         <code>id_encuesta</code>: ID de la encuesta - Vincula con encuestas_id para identificar la encuesta<br>
                         <code>telefono</code>: Tel茅fono normalizado del cliente que respondi贸<br>
                         <code>fecha_servicio</code>: Timestamp de la fecha del servicio evaluado<br>
                         <code>q1_calificacion_servicio</code>: Respuesta pregunta 1 - "muy_bueno", "bueno", "regular" o "malo"<br>
                         <code>q2_calificacion_trato</code>: Respuesta pregunta 2 - Calificaci贸n del trato del t茅cnico<br>
                         <code>q3_calificacion_presentacion</code>: Respuesta pregunta 3 - Calificaci贸n de presentaci贸n<br>
                         <code>q4_calificacion_tiempo</code>: Respuesta pregunta 4 - Calificaci贸n de puntualidad<br>
                         <code>q5_calificacion_explicacion</code>: Respuesta pregunta 5 - Calificaci贸n de explicaci贸n<br>
                         <code>q6_calificacion_medidas_preventivas</code>: Respuesta pregunta 6 - Calificaci贸n de medidas preventivas<br>
                         <code>q7_limpieza_area</code>: Boolean - true si limpi贸 el 谩rea, false si no<br>
                         <code>q8_aplicacion_gel</code>: Boolean - true si aplic贸 gel, false si no<br>
                         <code>q9_tratamiento_tuberias</code>: Boolean - true si trat贸 tuber铆as, false si no<br>
                         <code>q10_pregunta_servicio_adicional</code>: Boolean - true si ofreci贸 servicio adicional<br>
                         <code>q11_informacion_metodos_pago</code>: Boolean - true si inform贸 m茅todos de pago<br>
                         <code>q12_puntualidad</code>: Respuesta pregunta 12 - "puntual", "no_puntual_avisado" o "impuntual_sin_avisar"<br>
                         <code>comentarios_generales</code>: Texto opcional con comentarios adicionales del cliente (null si no hay)<br>
                         <code>fecha_respuesta</code>: Timestamp de cu谩ndo el cliente respondi贸 la encuesta
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-link me-2"></i>Relaciones entre Colecciones</h3>
                    
                    <div class="info-box">
                        <p>Las colecciones no est谩n aisladas. Est谩n <strong>relacionadas</strong> entre s铆. Aqu铆 te explicamos las relaciones m谩s importantes:</p>
                    </div>

                    <h4>Relaci贸n Cliente  Sucursal  Cita</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>clientes/{telefono}</strong><br>
                                <small>ID: "50683331234"</small><br>
                                <small>sucursales: [0, 1, 2]</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>sucursales/{telefono}_{indice}</strong><br>
                                <small>Ej: "50683331234_001"</small><br>
                                <small>indice: 0</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>citas/{citaId}</strong><br>
                                <small>telefono: "50683331234"</small><br>
                                <small>metadata.sucursalIndice: 0</small>
                            </div>
                        </div>
                    </div>
                    <p><strong>Explicaci贸n:</strong> Un cliente tiene m煤ltiples sucursales (direcciones). Cada cita est谩 vinculada a un cliente (por tel茅fono) y a una sucursal espec铆fica (por 铆ndice).</p>

                    <h4>Relaci贸n Cita  Ruta  T茅cnicos</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>citas/{citaId}</strong><br>
                                <small>metadata.ruta: "Ruta 3"</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>ruteador/{ruta}_{fecha}</strong><br>
                                <small>Ej: "Ruta 3_2026-01-15"</small><br>
                                <small>tecnicos: ["pablo.paniagua", "juan.perez"]</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>empleados/{username}</strong><br>
                                <small>Ej: "pablo.paniagua"</small>
                            </div>
                        </div>
                    </div>
                    <p><strong>Explicaci贸n:</strong> Una cita tiene una ruta asignada. Esa ruta, en una fecha espec铆fica, tiene t茅cnicos asignados. Los t茅cnicos est谩n en la colecci贸n de empleados.</p>

                    <h4>Relaci贸n Producto/Herramienta  Stock  Bodega</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>productos/{productoId}</strong><br>
                                <small>o</small><br>
                                <strong>herramientas/{herramientaId}</strong>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>stock_bodegas/{stockId}</strong><br>
                                <small>productoId o herramientaId</small><br>
                                <small>bodegaId: "abc123"</small><br>
                                <small>stockActual: 50</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>bodegas/{bodegaId}</strong><br>
                                <small>nombre: "Bodega Principal"</small><br>
                                <small>tipo: "principal"</small>
                            </div>
                        </div>
                    </div>
                    <p><strong>Explicaci贸n:</strong> Cada producto o herramienta puede estar en m煤ltiples bodegas. El stock se guarda en <code>stock_bodegas</code>, vinculando el producto/herramienta con la bodega y la cantidad.</p>

                    <h4>Relaci贸n Movimientos  Stock</h4>
                    <div class="diagram-container">
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <strong>movimientos_inventario/{movimientoId}</strong><br>
                                <small>tipo: "compra"</small><br>
                                <small>productoId: "abc123"</small><br>
                                <small>cantidad: +10</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <strong>stock_bodegas/{stockId}</strong><br>
                                <small>stockActual: 50  60</small><br>
                                <small>(se actualiza autom谩ticamente)</small>
                            </div>
                        </div>
                    </div>
                    <p><strong>Explicaci贸n:</strong> Cada movimiento de inventario (compra, gasto, transferencia) actualiza autom谩ticamente el stock en <code>stock_bodegas</code>. El stock se calcula sumando/restando todos los movimientos.</p>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-key me-2"></i>Patrones Importantes</h3>
                    
                    <h4>1. Normalizaci贸n de Tel茅fonos</h4>
                    <p>Todos los tel茅fonos se guardan en formato <strong>"50612345678"</strong>:</p>
                    <ul>
                        <li>Con c贸digo de pa铆s (506)</li>
                        <li>Sin guiones ni espacios</li>
                        <li>8 d铆gitos despu茅s del c贸digo</li>
                    </ul>
                    <p><strong>Ejemplo:</strong> "8333-1234"  "50683331234"</p>

                    <h4>2. IDs de Documentos</h4>
                    <p>Algunos documentos usan IDs compuestos:</p>
                    <ul>
                        <li><strong>Sucursales:</strong> <code>"{telefono}_{indice}"</code>  "50683331234_001"</li>
                        <li><strong>Rutas:</strong> <code>"{ruta}_{fecha}"</code>  "Ruta 3_2026-01-15"</li>
                        <li><strong>Clientes:</strong> El tel茅fono normalizado  "50683331234"</li>
                    </ul>

                    <h4>3. D铆a Laborable</h4>
                    <p>El d铆a laborable va de <strong>5:00 AM a 4:59 AM</strong> del d铆a siguiente:</p>
                    <ul>
                        <li>Si alguien marca a las 4:30 AM, pertenece al d铆a anterior</li>
                        <li>Si marca a las 5:30 AM, pertenece al d铆a actual</li>
                    </ul>

                    <h4>4. Fecha Contable vs Fecha Real</h4>
                    <p>En inventario, hay dos fechas:</p>
                    <ul>
                        <li><strong>fecha:</strong> Cu谩ndo se registr贸 el movimiento</li>
                        <li><strong>fechaContable:</strong> A qu茅 d铆a contable pertenece (puede ser diferente)</li>
                    </ul>
                    <p><strong>Ejemplo:</strong> Un pedido especial del 10 de enero, al liquidarse el 12 de enero, mantiene su <code>fechaContable</code> del 10 de enero.</p>

                    <h3><i class="fas fa-search me-2"></i>C贸mo Buscar Informaci贸n</h3>
                    
                    <h4>Preguntas Comunes:</h4>
                    <ul>
                        <li><strong>"驴D贸nde est谩 el stock de un producto?"</strong><br>
                             Busca en <code>stock_bodegas</code> filtrando por <code>productoId</code> y <code>bodegaId</code></li>
                        <li><strong>"驴Qu茅 citas tiene un cliente?"</strong><br>
                             Busca en <code>citas</code> filtrando por <code>telefono</code></li>
                        <li><strong>"驴Qu茅 t茅cnicos est谩n en una ruta?"</strong><br>
                             Busca en <code>ruteador</code> con ID <code>"{ruta}_{fecha}"</code></li>
                        <li><strong>"驴Cu谩nto stock hay en total de un producto?"</strong><br>
                             Suma todos los <code>stockActual</code> de <code>stock_bodegas</code> para ese <code>productoId</code></li>
                    </ul>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i>Consejo Final</h4>
                        <p>Cuando trabajes con el c贸digo, usa <strong>Cursor AI</strong> para buscar colecciones. Por ejemplo:</p>
                        <div class="code-example">
"驴D贸nde se lee la colecci贸n de citas?"
"驴C贸mo se actualiza el stock cuando se hace una compra?"
"驴D贸nde se guardan las respuestas de encuestas?"
                        </div>
                    </div>

                    <!-- Quiz: Colecciones -->
                    <div class="quiz-container" data-quiz-id="colecciones">
                        <h3><i class="fas fa-database me-2"></i> Reto: Experto en Datos</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Qu茅 colecci贸n guarda las citas de servicio?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="colecciones_q1" value="a"> citas</label>
                                    <label><input type="radio" name="colecciones_q1" value="b"> clientes</label>
                                    <label><input type="radio" name="colecciones_q1" value="c"> empleados</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 colecci贸n guarda el stock de productos por bodega?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="colecciones_q2" value="a"> productos</label>
                                    <label><input type="radio" name="colecciones_q2" value="b"> stock_bodegas</label>
                                    <label><input type="radio" name="colecciones_q2" value="c"> bodegas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 diferencia hay entre productoId y herramientaId?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="colecciones_q3" value="a"> Son lo mismo</label>
                                    <label><input type="radio" name="colecciones_q3" value="b"> productoId es para insumos, herramientaId es para equipos reutilizables</label>
                                    <label><input type="radio" name="colecciones_q3" value="c"> productoId es m谩s nuevo</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 colecci贸n almacena las sesiones de trabajo de los empleados?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="colecciones_q4" value="a"> empleados</label>
                                    <label><input type="radio" name="colecciones_q4" value="b"> work_sessions</label>
                                    <label><input type="radio" name="colecciones_q4" value="c"> horas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 colecci贸n guarda el historial de todos los movimientos de inventario?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="colecciones_q5" value="a"> productos</label>
                                    <label><input type="radio" name="colecciones_q5" value="b"> movimientos_inventario</label>
                                    <label><input type="radio" name="colecciones_q5" value="c"> bodegas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 colecci贸n relaciona las encuestas con las citas de servicio?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="colecciones_q6" value="a"> encuestas</label>
                                    <label><input type="radio" name="colecciones_q6" value="b"> encuestas_id</label>
                                    <label><input type="radio" name="colecciones_q6" value="c"> citas</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto" onclick="enviarQuiz('colecciones')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-colecciones"></div>
                    </div>
                </div>

                <!-- Secci贸n: Seguridad y Permisos -->
                <div id="seguridad-permisos" class="content-section">
                    <h2><i class="fas fa-shield-alt me-2"></i>Seguridad y Permisos</h2>
                    
                    <div class="info-box">
                        <p>El sistema EcoPlagas tiene un <strong>sistema de seguridad robusto</strong> que protege los datos y controla qui茅n puede acceder a cada funcionalidad.</p>
                    </div>

                    <h3><i class="fas fa-key me-2"></i>Sistema de Autenticaci贸n</h3>
                    
                    <h4>驴C贸mo funciona el login?</h4>
                    <ol>
                        <li><strong>Usuario ingresa credenciales:</strong> Username y contrase帽a en <code>iniciar_sesion.html</code></li>
                        <li><strong>Firebase Auth verifica:</strong> Comprueba que el usuario existe y la contrase帽a es correcta</li>
                        <li><strong>Se crea una sesi贸n:</strong> El usuario queda autenticado por un per铆odo de tiempo</li>
                        <li><strong>Se verifica en cada p谩gina:</strong> Cada p谩gina verifica que el usuario est茅 autenticado antes de mostrar contenido</li>
                    </ol>

                    <h4>Expiraci贸n de Sesi贸n</h4>
                    <div class="warning-box">
                        <p><strong>La sesi贸n expira en dos casos:</strong></p>
                        <ul>
                            <li><strong>Inactividad:</strong> Si no hay actividad durante 24 horas, la sesi贸n se cierra autom谩ticamente</li>
                            <li><strong>Domingo a medianoche:</strong> Todas las sesiones se cierran autom谩ticamente cada domingo a las 00:00:00</li>
                        </ul>
                        <p>Esto es por seguridad: asegura que las sesiones no queden abiertas indefinidamente.</p>
                    </div>

                    <h3><i class="fas fa-user-lock me-2"></i>Sistema de Permisos y M贸dulos</h3>
                    
                    <h4>驴Qu茅 son los m贸dulos?</h4>
                    <p>Los <strong>m贸dulos</strong> son secciones o p谩ginas del sistema con una funci贸n espec铆fica. Cada m贸dulo tiene un prop贸sito diferente y requiere permisos espec铆ficos para acceder.</p>
                    
                    <h4>驴C贸mo funcionan los m贸dulos?</h4>
                    <p>Cada m贸dulo es una p谩gina HTML independiente que:</p>
                    <ol>
                        <li><strong>Verifica permisos:</strong> Al cargar, verifica si el usuario tiene el permiso necesario</li>
                        <li><strong>Muestra contenido:</strong> Si tiene permiso, muestra el contenido del m贸dulo</li>
                        <li><strong>Bloquea acceso:</strong> Si no tiene permiso, muestra un mensaje de "Acceso Denegado" y redirige al login</li>
                    </ol>

                    <h4>驴Qu茅 son los permisos?</h4>
                    <p>Los <strong>permisos</strong> controlan qu茅 m贸dulos puede ver y usar cada empleado. No todos los empleados tienen acceso a todo.</p>

                    <h4>Tipos de Permisos</h4>
                    <ul>
                        <li><strong>calendario:</strong> Acceso al m贸dulo de calendario y gesti贸n de citas (<code>calendario.html</code>)</li>
                        <li><strong>horas:</strong> Acceso al registro de horas trabajadas (<code>registro_horas.html</code>)</li>
                        <li><strong>reportes:</strong> Acceso a reportes gerenciales (<code>reportes_gerenciales.html</code>)</li>
                        <li><strong>operario_bodega:</strong> Acceso a m贸dulo de operario de bodega (<code>operario_bodega.html</code>)</li>
                        <li><strong>administrador_bodega:</strong> Acceso a m贸dulo de administrador de bodega (<code>administrador_bodega.html</code>)</li>
                        <li><strong>tickets:</strong> Acceso al m贸dulo de tickets (<code>tickets.html</code>)</li>
                        <li><strong>empleados:</strong> Acceso a gesti贸n de empleados (<code>empleados.html</code>)</li>
                        <li><strong>admin:</strong> Acceso completo a funciones administrativas</li>
                    </ul>

                    <h4>驴C贸mo se habilita el acceso a un m贸dulo para un empleado?</h4>
                    <div class="info-box">
                        <h5><i class="fas fa-step-by-step me-2"></i>Pasos para habilitar acceso a un m贸dulo:</h5>
                        <ol>
                            <li><strong>Ir a Firebase Console:</strong> Abre <a href="https://console.firebase.google.com" target="_blank">console.firebase.google.com</a></li>
                            <li><strong>Seleccionar el proyecto:</strong> Elige el proyecto "cursorwebapp-f376d"</li>
                            <li><strong>Ir a Firestore Database:</strong> En el men煤 lateral, haz clic en "Firestore Database"</li>
                            <li><strong>Buscar el empleado:</strong> Ve a la colecci贸n <code>empleados</code> y busca el documento del empleado (por username o ID)</li>
                            <li><strong>Editar el documento:</strong> Haz clic en el documento del empleado</li>
                            <li><strong>Modificar el campo "permisos":</strong> 
                                <ul>
                                    <li>Si el campo "permisos" no existe, haz clic en "Agregar campo"</li>
                                    <li>Nombre del campo: <code>permisos</code></li>
                                    <li>Tipo: <code>map</code> (objeto)</li>
                                </ul>
                            </li>
                            <li><strong>Agregar el permiso espec铆fico:</strong>
                                <ul>
                                    <li>Dentro del objeto "permisos", agrega un nuevo campo</li>
                                    <li>Nombre: el nombre del m贸dulo (ej: <code>calendario</code>, <code>administrador_bodega</code>)</li>
                                    <li>Valor: <code>true</code> (boolean)</li>
                                </ul>
                            </li>
                            <li><strong>Guardar:</strong> Haz clic en "Actualizar"</li>
                        </ol>
                    </div>

                    <h4>Ejemplo pr谩ctico: Habilitar acceso a "Administrador de Bodega"</h4>
                    <div class="code-example">
                        <strong>1. Estructura del documento en Firestore:</strong><br>
                        Colecci贸n: <code>empleados</code><br>
                        Documento ID: <code>pablo.paniagua</code> (o el username del empleado)<br><br>
                        
                        <strong>2. Contenido del documento:</strong><br>
                        <pre>{
  "username": "pablo.paniagua",
  "nombre": "Pablo Paniagua",
  "permisos": {
    "calendario": true,
    "horas": true,
    "administrador_bodega": true   Este es el permiso que habilita el m贸dulo
  }
}</pre>
                        
                        <strong>3. Para habilitar el acceso:</strong><br>
                        - Agrega <code>"administrador_bodega": true</code> dentro del objeto <code>permisos</code>
                    </div>

                    <h4>驴D贸nde se configuran los permisos?</h4>
                    <ol>
                        <li><strong>En Firestore:</strong> Cada empleado tiene un documento en la colecci贸n <code>empleados</code></li>
                        <li><strong>Campo "permisos":</strong> Es un objeto que contiene los permisos del empleado</li>
                        <li><strong>Ejemplo completo:</strong>
                            <div class="code-example">
{
  "username": "pablo.paniagua",
  "nombre": "Pablo Paniagua",
  "email": "rh+pablo.paniagua@ecoplagascr.com",
  "permisos": {
    "calendario": true,
    "horas": true,
    "reportes": true,
    "operario_bodega": true,
    "administrador_bodega": true,
    "tickets": true,
    "empleados": true,
    "admin": true
  }
}
                            </div>
                        </li>
                    </ol>

                    <h4>Verificaci贸n de Permisos</h4>
                    <p>Cada p谩gina verifica los permisos antes de mostrar contenido:</p>
                    <ol>
                        <li><strong>check-permissions.js:</strong> Archivo que verifica si el usuario tiene el permiso necesario</li>
                        <li><strong>Mapeo de p谩ginas a permisos:</strong> El archivo tiene un objeto <code>PAGE_PERMISSIONS</code> que mapea cada p谩gina a su permiso requerido</li>
                        <li><strong>Si no tiene permiso:</strong> Muestra un mensaje de "Acceso Denegado" y redirige al login</li>
                        <li><strong>Si tiene permiso:</strong> Carga el contenido normalmente</li>
                    </ol>

                    <h4>Ejemplo de mapeo de permisos en check-permissions.js</h4>
                    <div class="code-example">
<pre>var PAGE_PERMISSIONS = {
    'calendario.html': 'calendario',
    'registro_horas.html': 'horas',
    'operario_bodega.html': 'operario_bodega',
    'administrador_bodega.html': 'administrador_bodega',
    'reportes_gerenciales.html': 'reportes',
    'tickets.html': 'tickets',
    'empleados.html': 'empleados'
};</pre>
                    </div>

                    <h4>锔 Importante</h4>
                    <div class="warning-box">
                        <ul>
                            <li><strong>Los cambios en permisos son inmediatos:</strong> Una vez que guardas el permiso en Firestore, el empleado puede acceder al m贸dulo de inmediato</li>
                            <li><strong>No necesitas recargar el servidor:</strong> Los permisos se leen directamente desde Firestore cada vez que se carga una p谩gina</li>
                            <li><strong>Verificaci贸n en tiempo real:</strong> El sistema verifica los permisos cada 2 minutos autom谩ticamente</li>
                            <li><strong>Si quitas un permiso:</strong> El empleado perder谩 acceso inmediatamente al intentar entrar al m贸dulo</li>
                        </ul>
                    </div>

                    <h3><i class="fas fa-database me-2"></i>Reglas de Firestore</h3>
                    
                    <h4>驴Qu茅 son las reglas de Firestore?</h4>
                    <p>Las <strong>reglas de Firestore</strong> son como "guardias" que controlan qui茅n puede leer y escribir datos en la base de datos. Est谩n en el archivo <code>firestore.rules</code>.</p>

                    <h4>Principio B谩sico</h4>
                    <div class="warning-box">
                        <p><strong>Regla de oro:</strong> Por defecto, TODO est谩 DENEGADO. Solo se permite acceso expl铆citamente.</p>
                        <p>Esto significa que si una colecci贸n no tiene reglas definidas, nadie puede acceder a ella.</p>
                    </div>

                    <h4>Tipos de Reglas</h4>
                    <ul>
                        <li><strong>allow read:</strong> Permite leer datos (consultar, ver)</li>
                        <li><strong>allow write:</strong> Permite escribir datos (crear, actualizar, eliminar)</li>
                        <li><strong>allow create:</strong> Solo permite crear nuevos documentos</li>
                        <li><strong>allow update:</strong> Solo permite actualizar documentos existentes</li>
                        <li><strong>allow delete:</strong> Solo permite eliminar documentos</li>
                    </ul>

                    <h4>Ejemplo de Regla</h4>
                    <div class="code-example">
// Permitir lectura y escritura solo a usuarios autenticados
match /citas/{citaId} {
  allow read, write: if isSecureSystem();
}

// isSecureSystem() verifica que el usuario est茅 autenticado
                    </div>

                    <h3><i class="fas fa-exclamation-triangle me-2"></i>Errores de Permisos Comunes</h3>
                    
                    <h4>"Missing or insufficient permissions"</h4>
                    <p><strong>Causas:</strong></p>
                    <ul>
                        <li>No est谩s autenticado (sesi贸n expirada)</li>
                        <li>La colecci贸n no tiene reglas definidas</li>
                        <li>Las reglas son muy restrictivas</li>
                    </ul>
                    <p><strong>Soluci贸n:</strong></p>
                    <ol>
                        <li>Recargar la p谩gina (puede renovar la sesi贸n)</li>
                        <li>Cerrar sesi贸n y volver a entrar</li>
                        <li>Verificar que la colecci贸n tenga reglas en <code>firestore.rules</code></li>
                    </ol>

                    <h3><i class="fas fa-lock me-2"></i>Buenas Pr谩cticas de Seguridad</h3>
                    
                    <ul>
                        <li><strong>Nunca compartas tu contrase帽a:</strong> Cada usuario debe tener su propia cuenta</li>
                        <li><strong>Cierra sesi贸n cuando termines:</strong> Especialmente en computadoras compartidas</li>
                        <li><strong>No guardes contrase帽as en texto plano:</strong> El sistema usa Firebase Auth que las encripta</li>
                        <li><strong>Revisa permisos regularmente:</strong> Aseg煤rate de que cada empleado tenga solo los permisos necesarios</li>
                        <li><strong>Mant茅n las reglas actualizadas:</strong> Cuando agregues nuevas colecciones, agrega reglas</li>
                    </ul>

                    <!-- Quiz: Seguridad y Permisos -->
                    <div class="quiz-container" data-quiz-id="seguridad">
                        <h3><i class="fas fa-shield-alt me-2"></i>★ Reto: Guardi谩n de la Seguridad</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Cu谩ndo expira una sesi贸n de usuario?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="seguridad-q1" value="a"> Despu茅s de 1 hora de inactividad</label>
                                    <label><input type="radio" name="seguridad-q1" value="b"> Despu茅s de 24 horas de inactividad o cada domingo a medianoche</label>
                                    <label><input type="radio" name="seguridad-q1" value="c"> Nunca expira</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 archivo verifica los permisos antes de cargar una p谩gina?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="seguridad-q2" value="a"> auth-secure.js</label>
                                    <label><input type="radio" name="seguridad-q2" value="b"> check-permissions.js</label>
                                    <label><input type="radio" name="seguridad-q2" value="c"> firestore.rules</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴D贸nde se almacenan los permisos de cada empleado?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="seguridad-q3" value="a"> En el archivo check-permissions.js</label>
                                    <label><input type="radio" name="seguridad-q3" value="b"> En el documento del empleado en Firestore, en el campo "permisos"</label>
                                    <label><input type="radio" name="seguridad-q3" value="c"> En el archivo firestore.rules</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Cu谩l es el principio b谩sico de las reglas de Firestore?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="seguridad-q4" value="a"> Por defecto todo est谩 permitido</label>
                                    <label><input type="radio" name="seguridad-q4" value="b"> Por defecto todo est谩 DENEGADO, solo se permite acceso expl铆citamente</label>
                                    <label><input type="radio" name="seguridad-q4" value="c"> No hay reglas por defecto</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 tipo de regla permite solo leer datos pero no escribir?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="seguridad-q5" value="a"> allow write</label>
                                    <label><input type="radio" name="seguridad-q5" value="b"> allow read</label>
                                    <label><input type="radio" name="seguridad-q5" value="c"> allow create</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 funci贸n verifica que el usuario est茅 autenticado en las reglas de Firestore?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="seguridad-q6" value="a"> isAuthenticated()</label>
                                    <label><input type="radio" name="seguridad-q6" value="b"> isSecureSystem()</label>
                                    <label><input type="radio" name="seguridad-q6" value="c"> checkUser()</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('seguridad')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-seguridad"></div>
                    </div>
                </div>

                <!-- Secci贸n: Inventario Avanzado -->
                <div id="inventario-avanzado" class="content-section">
                    <h2><i class="fas fa-warehouse me-2"></i>Inventario Avanzado</h2>
                    
                    <div class="info-box">
                        <p>El sistema de inventario de EcoPlagas gestiona <strong>productos</strong> (insumos consumibles) y <strong>herramientas</strong> (equipos reutilizables) en diferentes bodegas.</p>
                    </div>

                    <h3><i class="fas fa-boxes me-2"></i>Tipos de tems</h3>
                    
                    <h4>Productos (productoId)</h4>
                    <ul>
                        <li><strong>Definici贸n:</strong> tems consumibles que se gastan al usarlos</li>
                        <li><strong>Ejemplos:</strong> Insecticidas, qu铆micos, materiales de fumigaci贸n</li>
                        <li><strong>Colecci贸n:</strong> <code>productos</code></li>
                        <li><strong>Identificador:</strong> <code>productoId</code></li>
                        <li><strong>Caracter铆sticas:</strong> Se pueden reportar como gasto, se consumen al usarlos</li>
                    </ul>

                    <h4>Herramientas (herramientaId)</h4>
                    <ul>
                        <li><strong>Definici贸n:</strong> tems reutilizables que se devuelven despu茅s de usar</li>
                        <li><strong>Ejemplos:</strong> Termonebulizadoras, bombas, equipos de protecci贸n</li>
                        <li><strong>Colecci贸n:</strong> <code>herramientas</code></li>
                        <li><strong>Identificador:</strong> <code>herramientaId</code></li>
                        <li><strong>Caracter铆sticas:</strong> NO se pueden reportar como gasto, solo se devuelven a bodega</li>
                    </ul>

                    <h3><i class="fas fa-building me-2"></i>Tipos de Bodegas</h3>
                    
                    <h4>Bodega Principal</h4>
                    <ul>
                        <li><strong>Productos:</strong> Almac茅n central de todos los productos</li>
                        <li><strong>Herramientas:</strong> "Bodega Principal Herramientas" - almac茅n central de herramientas</li>
                        <li><strong>Funci贸n:</strong> Punto de entrada para compras y distribuci贸n</li>
                    </ul>

                    <h4>Bodega Especial</h4>
                    <ul>
                        <li><strong>Definici贸n:</strong> Bodega asignada a un empleado espec铆fico</li>
                        <li><strong>Contenido:</strong> Puede contener tanto productos como herramientas</li>
                        <li><strong>Funci贸n:</strong> El empleado puede ver su inventario personal y devolver 铆tems</li>
                        <li><strong>Proceso:</strong> Se asigna mediante "Pedidos Especiales" desde bodega principal</li>
                    </ul>

                    <h4>Bodega de Herramientas</h4>
                    <ul>
                        <li><strong>Definici贸n:</strong> Bodega espec铆fica para herramientas (tipo: "herramientas")</li>
                        <li><strong>Restricci贸n:</strong> Solo puede contener herramientas, nunca productos</li>
                        <li><strong>Ejemplo:</strong> "Bodega Principal Herramientas"</li>
                    </ul>

                    <h3><i class="fas fa-exchange-alt me-2"></i>Tipos de Transacciones</h3>
                    
                    <h4>Compra</h4>
                    <ul>
                        <li><strong>Origen:</strong> Proveedor</li>
                        <li><strong>Destino:</strong> Bodega (principal de productos o herramientas)</li>
                        <li><strong>Efecto:</strong> Aumenta stock en la bodega destino</li>
                    </ul>

                    <h4>Gasto</h4>
                    <ul>
                        <li><strong>Origen:</strong> Bodega</li>
                        <li><strong>Destino:</strong> Cuenta de Gasto</li>
                        <li><strong>Efecto:</strong> Reduce stock en la bodega origen</li>
                        <li><strong>Nota:</strong> Solo para productos, NO para herramientas</li>
                    </ul>

                    <h4>Transferencia</h4>
                    <ul>
                        <li><strong>Origen:</strong> Bodega A</li>
                        <li><strong>Destino:</strong> Bodega B</li>
                        <li><strong>Efecto:</strong> Reduce stock en origen, aumenta en destino</li>
                        <li><strong>Ejemplo:</strong> De bodega principal a bodega especial</li>
                    </ul>

                    <h4>Pedido Especial</h4>
                    <ul>
                        <li><strong>Definici贸n:</strong> Asignaci贸n de productos/herramientas a bodega especial</li>
                        <li><strong>Proceso:</strong> Se crea un pedido, luego se "alista" (transfiere a bodega especial)</li>
                        <li><strong>Liquidaci贸n:</strong> Se puede liquidar como gasto (productos) o devoluci贸n (ambos)</li>
                    </ul>

                    <h3><i class="fas fa-calculator me-2"></i>Gesti贸n de Stock</h3>
                    
                    <h4>Colecci贸n stock_bodegas</h4>
                    <p>Almacena el stock actual de cada 铆tem en cada bodega:</p>
                    <ul>
                        <li><strong>productoId</strong> o <strong>herramientaId:</strong> Identifica el 铆tem</li>
                        <li><strong>bodegaId:</strong> Identifica la bodega</li>
                        <li><strong>stockActual:</strong> Cantidad disponible</li>
                        <li><strong>tipo:</strong> "producto" o "herramienta"</li>
                    </ul>

                    <h4>Rec谩lculo de Saldos</h4>
                    <p>Si hay discrepancias en el stock, puedes recalcular desde cero:</p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_bodegas.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Gesti贸n de Bodegas (Recalcular Saldos)
                        </a>
                    </div>
                    
                    <ol>
                        <li>Ir a <code>admin_inventario_bodegas.html</code></li>
                        <li>Click en "Recalcular Saldos"</li>
                        <li>El sistema recorre todas las transacciones y recalcula el stock</li>
                        <li>Puede tardar varios minutos si hay muchas transacciones</li>
                    </ol>
                    
                    <h5>Ejemplo: Corregir Discrepancias de Stock</h5>
                    <div class="info-box">
                        <p><strong>Escenario:</strong> El stock mostrado no coincide con las transacciones registradas.</p>
                        <ol>
                            <li><strong>Abrir Gesti贸n de Bodegas:</strong> Ir a <code>admin_inventario_bodegas.html</code></li>
                            <li><strong>Click en "Recalcular Saldos":</strong> Se inicia el proceso autom谩tico</li>
                            <li><strong>Esperar:</strong> El sistema recorre TODAS las transacciones desde el inicio y recalcula cada saldo</li>
                            <li><strong>Verificar:</strong> Una vez terminado, revisar que los saldos ahora coincidan</li>
                            <li><strong>Nota importante:</strong> Este proceso puede tardar varios minutos si hay muchas transacciones hist贸ricas</li>
                        </ol>
                        <p><strong>Cu谩ndo usar:</strong> Cuando hay discrepancias generalizadas o despu茅s de corregir transacciones incorrectas.</p>
                    </div>

                    <h4>Anomal铆as</h4>
                    <p>Para detectar problemas de stock:</p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/administrador_bodega.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Administrador de Bodegas (Anomal铆as)
                        </a>
                    </div>
                    
                    <ol>
                        <li>Ir a <code>administrador_bodega.html</code></li>
                        <li>Reportes y An谩lisis  Anomal铆as</li>
                        <li>Muestra bodegas y productos/herramientas con stock negativo</li>
                    </ol>
                    
                    <h5>Ejemplo: Detectar Stock Negativo</h5>
                    <div class="info-box">
                        <p><strong>Escenario:</strong> Sospechas que hay productos con stock negativo en alguna bodega.</p>
                        <ol>
                            <li><strong>Abrir Administrador de Bodegas:</strong> Ir a <code>administrador_bodega.html</code></li>
                            <li><strong>Ir a Anomal铆as:</strong> Click en "Reportes y An谩lisis"  "Anomal铆as"</li>
                            <li><strong>Revisar lista:</strong> El sistema muestra autom谩ticamente todos los productos/herramientas con stock negativo</li>
                            <li><strong>Investigar:</strong> Para cada anomal铆a, revisar las transacciones en <code>admin_inventario_transacciones.html</code></li>
                            <li><strong>Corregir:</strong> Identificar la transacci贸n incorrecta y corregirla o eliminarla</li>
                        </ol>
                    </div>

                    <!-- Quiz: Inventario Avanzado -->
                    <div class="quiz-container" data-quiz-id="inventario">
                        <h3><i class="fas fa-warehouse me-2"></i> Reto: Maestro de Inventario</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Cu谩l es la diferencia principal entre productos y herramientas?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="inventario-q1" value="a"> Los productos se pueden reportar como gasto, las herramientas solo se devuelven</label>
                                    <label><input type="radio" name="inventario-q1" value="b"> No hay diferencia</label>
                                    <label><input type="radio" name="inventario-q1" value="c"> Las herramientas se consumen, los productos se reutilizan</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 tipo de bodega puede contener tanto productos como herramientas?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="inventario-q2" value="a"> Bodega Principal</label>
                                    <label><input type="radio" name="inventario-q2" value="b"> Bodega Especial</label>
                                    <label><input type="radio" name="inventario-q2" value="c"> Bodega de Herramientas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 efecto tiene una transacci贸n de tipo "gasto"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="inventario-q3" value="a"> Aumenta stock en bodega origen</label>
                                    <label><input type="radio" name="inventario-q3" value="b"> Reduce stock en bodega origen</label>
                                    <label><input type="radio" name="inventario-q3" value="c"> No afecta el stock</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 tipo de transacci贸n permite mover productos/herramientas de una bodega a otra?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="inventario-q4" value="a"> compra</label>
                                    <label><input type="radio" name="inventario-q4" value="b"> transferencia</label>
                                    <label><input type="radio" name="inventario-q4" value="c"> gasto</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Pueden las herramientas reportarse como gasto en operario_bodega.html?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="inventario-q5" value="a"> S铆, igual que los productos</label>
                                    <label><input type="radio" name="inventario-q5" value="b"> No, las herramientas solo se pueden devolver, nunca reportar como gasto</label>
                                    <label><input type="radio" name="inventario-q5" value="c"> Solo si est谩n rotas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 funci贸n puedes usar para corregir discrepancias de stock?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="inventario-q6" value="a"> Eliminar todas las transacciones</label>
                                    <label><input type="radio" name="inventario-q6" value="b"> Recalcular Saldos en admin_inventario_bodegas.html</label>
                                    <label><input type="radio" name="inventario-q6" value="c"> Reiniciar el sistema</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('inventario')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-inventario"></div>
                    </div>
                </div>

                <!-- Secci贸n: Reportes y An谩lisis -->
                <div id="reportes-analisis" class="content-section">
                    <h2><i class="fas fa-chart-bar me-2"></i>Reportes y An谩lisis</h2>
                    
                    <div class="info-box">
                        <p>El sistema EcoPlagas incluye <strong>m煤ltiples reportes</strong> para analizar el desempe帽o del negocio, horas trabajadas, facturaci贸n y m谩s.</p>
                    </div>

                    <h3><i class="fas fa-clock me-2"></i>Reporte de Horas por D铆a</h3>
                    
                    <h4>Ubicaci贸n</h4>
                    <p><code>reportes_gerenciales.html</code>  Secci贸n "Reporte de Horas por D铆a"</p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/reportes_gerenciales.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Reportes Gerenciales
                        </a>
                    </div>

                    <h4>驴Qu茅 muestra?</h4>
                    <ul>
                        <li><strong>Horas trabajadas por empleado por d铆a:</strong> Tabla con horas diarias de cada empleado</li>
                        <li><strong>Horas trabajadas por empleado por d铆a por hora laborada:</strong> Desglose por hora del d铆a</li>
                        <li><strong>Filtros:</strong> Mes, semana, empleado espec铆fico</li>
                        <li><strong>Indicadores visuales:</strong> Color morado y "V" si el empleado estaba de vacaciones</li>
                        <li><strong>D铆as especiales:</strong> Domingos y feriados se colorean en morado claro</li>
                    </ul>

                    <h4>L贸gica del D铆a Laborable</h4>
                    <div class="warning-box">
                        <p><strong>Importante:</strong> El d铆a laborable va de <strong>5:00 AM a 4:59:59 AM del d铆a siguiente</strong>.</p>
                        <p>Esto significa que una cita a las 4:30 AM pertenece al d铆a anterior operacionalmente.</p>
                    </div>

                    <h3><i class="fas fa-dollar-sign me-2"></i>Reporte de Facturaci贸n por Empleado</h3>
                    
                    <h4>Ubicaci贸n</h4>
                    <p><code>reportes_gerenciales.html</code>  Secci贸n "Reporte de Facturaci贸n por Empleado"</p>

                    <h4>驴Qu茅 muestra?</h4>
                    <ul>
                        <li><strong>Facturaci贸n por empleado por d铆a:</strong> Monto facturado por cada t茅cnico cada d铆a</li>
                        <li><strong>Facturaci贸n por empleado por d铆a por hora laborada:</strong> Desglose por hora</li>
                        <li><strong>Divisi贸n proporcional:</strong> Si varios t茅cnicos atienden una cita, el monto se divide entre ellos</li>
                        <li><strong>Mismo formato visual:</strong> Colores, vacaciones, feriados igual que el reporte de horas</li>
                    </ul>

                    <h4>Fuente de Datos</h4>
                    <ul>
                        <li><strong>Colecci贸n citas:</strong> Obtiene el monto de <code>metadata.monto</code></li>
                        <li><strong>Colecci贸n ruteador:</strong> Identifica qu茅 t茅cnicos atendieron cada cita</li>
                        <li><strong>C谩lculo:</strong> Suma todos los montos de citas atendidas por cada t茅cnico en el per铆odo</li>
                    </ul>

                    <h3><i class="fas fa-poll me-2"></i>Reporte de Encuestas</h3>
                    
                    <h4>Ubicaci贸n</h4>
                    <p><code>reporte_encuestas.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/reporte_encuestas.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Reporte de Encuestas
                        </a>
                    </div>

                    <h4>驴Qu茅 muestra?</h4>
                    <ul>
                        <li><strong>Lista de encuestas:</strong> Todas las encuestas recibidas de clientes</li>
                        <li><strong>Detalle individual:</strong> Informaci贸n completa de cada encuesta</li>
                        <li><strong>T茅cnicos asignados:</strong> Muestra qui茅n atendi贸 la cita relacionada</li>
                        <li><strong>Detalle por pregunta:</strong> Respuestas a cada una de las 12 preguntas</li>
                        <li><strong>Comentarios:</strong> Comentarios adicionales del cliente</li>
                    </ul>

                    <h3><i class="fas fa-exclamation-circle me-2"></i>Reporte de Anomal铆as</h3>
                    
                    <h4>Ubicaci贸n</h4>
                    <p><code>administrador_bodega.html</code>  Reportes y An谩lisis  Anomal铆as</p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/administrador_bodega.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Administrador de Bodegas
                        </a>
                    </div>

                    <h4>驴Qu茅 muestra?</h4>
                    <ul>
                        <li><strong>Stock negativo:</strong> Bodegas y productos/herramientas con saldo negativo</li>
                        <li><strong>til para:</strong> Detectar problemas de inventario, transacciones incorrectas</li>
                    </ul>

                    <h3><i class="fas fa-table me-2"></i>Resumen Pivot de Saldos</h3>
                    
                    <h4>Ubicaci贸n</h4>
                    <p><code>admin_inventario_saldos_pivot.html</code></p>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/admin_inventario_saldos_pivot.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Resumen Pivot de Saldos
                        </a>
                    </div>

                    <h4>驴Qu茅 muestra?</h4>
                    <ul>
                        <li><strong>Tabla pivot:</strong> Productos/herramientas en filas, bodegas en columnas</li>
                        <li><strong>Stock por celda:</strong> Cantidad disponible de cada 铆tem en cada bodega</li>
                        <li><strong>Colores:</strong> Verde (stock bueno), rojo (stock bajo), azul (stock alto)</li>
                        <li><strong>Filtros:</strong> Por producto/herramienta, por bodega</li>
                    </ul>

                    <!-- Quiz: Reportes y An谩lisis -->
                    <div class="quiz-container" data-quiz-id="reportes">
                        <h3><i class="fas fa-chart-bar me-2"></i> Reto: Analista de Datos</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴A qu茅 hora inicia el d铆a laborable en el sistema?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="reportes-q1" value="a"> Medianoche (00:00)</label>
                                    <label><input type="radio" name="reportes-q1" value="b"> 5:00 AM</label>
                                    <label><input type="radio" name="reportes-q1" value="c"> 8:00 AM</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴C贸mo se divide la facturaci贸n cuando varios t茅cnicos atienden una cita?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="reportes-q2" value="a"> Se asigna al primer t茅cnico de la lista</label>
                                    <label><input type="radio" name="reportes-q2" value="b"> Se divide proporcionalmente entre todos los t茅cnicos asignados</label>
                                    <label><input type="radio" name="reportes-q2" value="c"> Se duplica para cada t茅cnico</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 muestra el reporte de Anomal铆as?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="reportes-q3" value="a"> Todas las transacciones del mes</label>
                                    <label><input type="radio" name="reportes-q3" value="b"> Bodegas y productos/herramientas con stock negativo</label>
                                    <label><input type="radio" name="reportes-q3" value="c"> Empleados con m谩s horas trabajadas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴De d贸nde obtiene el reporte de facturaci贸n el monto de cada cita?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="reportes-q4" value="a"> Del campo metadata.monto en la colecci贸n citas</label>
                                    <label><input type="radio" name="reportes-q4" value="b"> Del campo precio en la colecci贸n servicios</label>
                                    <label><input type="radio" name="reportes-q4" value="c"> Se calcula autom谩ticamente</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 formato usan los montos en el reporte de facturaci贸n para ser m谩s compactos?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="reportes-q5" value="a"> Se muestran completos con s铆mbolo </label>
                                    <label><input type="radio" name="reportes-q5" value="b"> Se redondean a miles y se muestran como "22k" para 22,000</label>
                                    <label><input type="radio" name="reportes-q5" value="c"> Se muestran en d贸lares</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 indica el color morado y la letra "V" en los reportes de horas y facturaci贸n?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="reportes-q6" value="a"> Que el empleado trabaj贸 horas extras</label>
                                    <label><input type="radio" name="reportes-q6" value="b"> Que el empleado estaba de vacaciones ese d铆a</label>
                                    <label><input type="radio" name="reportes-q6" value="c"> Que hubo un error en los datos</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('reportes')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-reportes"></div>
                    </div>
                </div>

                <!-- Secci贸n: Encuestas de Clientes -->
                <div id="encuestas-clientes" class="content-section">
                    <h2><i class="fas fa-clipboard-check me-2"></i>Encuestas de Clientes</h2>
                    
                    <div class="info-box">
                        <p>El sistema env铆a <strong>encuestas de satisfacci贸n</strong> a los clientes despu茅s de cada servicio para medir la calidad del trabajo realizado.</p>
                    </div>

                    <h3><i class="fas fa-question-circle me-2"></i>Estructura de la Encuesta</h3>
                    
                    <h4>12 Preguntas</h4>
                    <ul>
                        <li><strong>Preguntas 1-6 (Calidad):</strong> Evaluaci贸n de calidad del servicio (Muy bueno, Bueno, Regular, Malo)</li>
                        <li><strong>Preguntas 7-11 (Cumplimiento):</strong> Preguntas de s铆/no sobre cumplimiento</li>
                        <li><strong>Pregunta 12 (Puntualidad):</strong> Evaluaci贸n de puntualidad</li>
                    </ul>

                    <h4>Comentarios Opcionales</h4>
                    <p>Cada pregunta puede tener un comentario adicional, y hay un campo de comentarios generales.</p>

                    <h3><i class="fas fa-database me-2"></i>Colecciones Relacionadas</h3>
                    
                    <h4>encuestas_id</h4>
                    <ul>
                        <li><strong>Funci贸n:</strong> Mapea el ID de la encuesta con la cita relacionada</li>
                        <li><strong>Campos:</strong> <code>id_encuesta</code>, <code>telefono</code>, <code>fecha</code>, <code>cita_id</code></li>
                        <li><strong>Uso:</strong> Permite relacionar una encuesta con su cita de servicio</li>
                    </ul>

                    <h4>encuestas</h4>
                    <ul>
                        <li><strong>Funci贸n:</strong> Almacena las respuestas de los clientes</li>
                        <li><strong>Campos:</strong> <code>id_encuesta</code>, <code>pregunta1</code> a <code>pregunta12</code>, <code>comentarios</code></li>
                        <li><strong>Acceso:</strong> Los clientes pueden crear encuestas sin autenticaci贸n, pero solo usuarios autenticados pueden leerlas</li>
                    </ul>

                    <h3><i class="fas fa-chart-pie me-2"></i>Reporte de Encuestas</h3>
                    
                    <div class="module-reference-btn-container">
                        <a href="https://ecoplagas.online/reporte_encuestas.html" target="_blank" class="module-reference-btn">
                            <i class="fas fa-external-link-alt"></i>
                            Abrir Reporte de Encuestas
                        </a>
                    </div>
                    
                    <h4>Vista de Lista</h4>
                    <ul>
                        <li><strong>Lista compacta:</strong> Muestra todas las encuestas con fecha y puntaje</li>
                        <li><strong>Icono de comentarios:</strong> Indica si la encuesta tiene comentarios</li>
                        <li><strong>Filtros:</strong> Por fecha, por puntaje, por t茅cnico</li>
                    </ul>

                    <h4>Vista Individual</h4>
                    <ul>
                        <li><strong>Informaci贸n de la cita:</strong> Fecha, cliente, direcci贸n</li>
                        <li><strong>T茅cnicos asignados:</strong> Muestra qui茅n atendi贸 la cita</li>
                        <li><strong>Respuestas completas:</strong> Todas las 12 preguntas con sus respuestas</li>
                        <li><strong>Comentarios:</strong> Comentarios del cliente</li>
                    </ul>

                    <h4>Detalle por Pregunta</h4>
                    <ul>
                        <li><strong>Tabla:</strong> Muestra cada pregunta con su respuesta</li>
                        <li><strong>Texto completo:</strong> Muestra la pregunta completa, no solo "Q1", "Q2"</li>
                        <li><strong>An谩lisis:</strong> Permite ver patrones en las respuestas</li>
                    </ul>

                    <h3><i class="fas fa-link me-2"></i>Relaci贸n con Citas</h3>
                    
                    <p>El sistema relaciona encuestas con citas mediante:</p>
                    <ol>
                        <li><strong>encuestas_id:</strong> Contiene el <code>cita_id</code> que relaciona la encuesta con la cita</li>
                        <li><strong>ruteador:</strong> A trav茅s de la cita, se puede identificar qu茅 t茅cnicos la atendieron</li>
                        <li><strong>empleados:</strong> Se resuelven los nombres de los t茅cnicos para mostrar en el reporte</li>
                    </ol>

                    <!-- Quiz: Encuestas de Clientes -->
                    <div class="quiz-container" data-quiz-id="encuestas">
                        <h3><i class="fas fa-clipboard-check me-2"></i> Reto: Experto en Encuestas</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Cu谩ntas preguntas tiene una encuesta de cliente?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="encuestas-q1" value="a"> 10 preguntas</label>
                                    <label><input type="radio" name="encuestas-q1" value="b"> 12 preguntas</label>
                                    <label><input type="radio" name="encuestas-q1" value="c"> 15 preguntas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 colecci贸n relaciona una encuesta con su cita de servicio?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="encuestas-q2" value="a"> encuestas</label>
                                    <label><input type="radio" name="encuestas-q2" value="b"> encuestas_id</label>
                                    <label><input type="radio" name="encuestas-q2" value="c"> citas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qui茅n puede crear encuestas en el sistema?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="encuestas-q3" value="a"> Solo usuarios autenticados</label>
                                    <label><input type="radio" name="encuestas-q3" value="b"> Los clientes pueden crear encuestas sin autenticaci贸n</label>
                                    <label><input type="radio" name="encuestas-q3" value="c"> Solo administradores</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 tipo de preguntas son las preguntas 1-6 de la encuesta?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="encuestas-q4" value="a"> Preguntas de cumplimiento (s铆/no)</label>
                                    <label><input type="radio" name="encuestas-q4" value="b"> Evaluaci贸n de calidad del servicio (Muy bueno, Bueno, Regular, Malo)</label>
                                    <label><input type="radio" name="encuestas-q4" value="c"> Preguntas sobre puntualidad</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 colecci贸n almacena las respuestas de los clientes a las encuestas?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="encuestas-q5" value="a"> encuestas_id</label>
                                    <label><input type="radio" name="encuestas-q5" value="b"> encuestas</label>
                                    <label><input type="radio" name="encuestas-q5" value="c"> citas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 informaci贸n muestra el reporte de encuestas sobre los t茅cnicos?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="encuestas-q6" value="a"> Solo el nombre del t茅cnico principal</label>
                                    <label><input type="radio" name="encuestas-q6" value="b"> Muestra todos los t茅cnicos que atendieron la cita relacionada</label>
                                    <label><input type="radio" name="encuestas-q6" value="c"> No muestra informaci贸n de t茅cnicos</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('encuestas')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-encuestas"></div>
                    </div>
                </div>

                <!-- Secci贸n: Gesti贸n de Rutas -->
                <div id="gestion-rutas" class="content-section">
                    <h2><i class="fas fa-route me-2"></i>Gesti贸n de Rutas y Asignaciones</h2>
                    
                    <div class="info-box">
                        <p>El sistema organiza las citas en <strong>rutas</strong> y asigna <strong>t茅cnicos y veh铆culos</strong> a cada ruta para optimizar el servicio.</p>
                    </div>

                    <h3><i class="fas fa-map-marked-alt me-2"></i>Sistema de Rutas</h3>
                    
                    <h4>Estructura</h4>
                    <ul>
                        <li><strong>20 rutas totales:</strong> Rutas 1-10 (diurnas), Rutas 11-20 (nocturnas)</li>
                        <li><strong>Rutas diurnas:</strong> Trabajo durante el d铆a (5:00 AM - 5:00 PM)</li>
                        <li><strong>Rutas nocturnas:</strong> Trabajo durante la noche (5:00 PM - 5:00 AM siguiente)</li>
                    </ul>

                    <h4>Asignaci贸n de Citas</h4>
                    <p>Cada cita se asigna a una ruta espec铆fica. Esto permite:</p>
                    <ul>
                        <li><strong>Organizaci贸n geogr谩fica:</strong> Agrupar citas cercanas</li>
                        <li><strong>Optimizaci贸n de tiempo:</strong> Reducir tiempos de viaje</li>
                        <li><strong>Asignaci贸n de recursos:</strong> Asignar t茅cnicos y veh铆culos apropiados</li>
                    </ul>

                    <h3><i class="fas fa-users me-2"></i>Colecci贸n ruteador</h3>
                    
                    <h4>驴Qu茅 es?</h4>
                    <p>La colecci贸n <code>ruteador</code> almacena la asignaci贸n de t茅cnicos y veh铆culos a cada ruta en cada d铆a.</p>

                    <h4>Estructura</h4>
                    <ul>
                        <li><strong>ruta:</strong> N煤mero de ruta (1-20)</li>
                        <li><strong>fecha:</strong> Fecha del d铆a</li>
                        <li><strong>tecnicos:</strong> Array de usernames de los t茅cnicos asignados</li>
                        <li><strong>vehiculo:</strong> Identificador del veh铆culo asignado</li>
                    </ul>

                    <h4>Ejemplo</h4>
                    <div class="code-example">
{
  "ruta": "2",
  "fecha": "2026-01-15",
  "tecnicos": ["pablo.paniagua", "juan.perez"],
  "vehiculo": "APV 02"
}
                    </div>

                    <h3><i class="fas fa-calendar-alt me-2"></i>Asignaci贸n en el Calendario</h3>
                    
                    <h4>Proceso</h4>
                    <ol>
                        <li><strong>Crear cita:</strong> Se crea una nueva cita en el calendario</li>
                        <li><strong>Asignar ruta:</strong> Se selecciona la ruta (1-20) para la cita</li>
                        <li><strong>Asignar t茅cnicos:</strong> En el ruteador, se asignan t茅cnicos a esa ruta para ese d铆a</li>
                        <li><strong>Asignar veh铆culo:</strong> Se asigna un veh铆culo a la ruta</li>
                    </ol>

                    <h4>Visualizaci贸n</h4>
                    <p>En el calendario, las citas se agrupan por ruta y se muestran:</p>
                    <ul>
                        <li><strong>Por d铆a:</strong> Vista diaria con todas las rutas del d铆a</li>
                        <li><strong>Cronograma:</strong> Vista semanal con rutas en columnas</li>
                        <li><strong>Estad铆sticas:</strong> Total de citas y facturaci贸n por ruta</li>
                    </ul>

                    <h3><i class="fas fa-dollar-sign me-2"></i>C谩lculo de Facturaci贸n por T茅cnico</h3>
                    
                    <h4>Divisi贸n Proporcional</h4>
                    <p>Cuando varios t茅cnicos est谩n asignados a una ruta que atiende una cita:</p>
                    <ul>
                        <li><strong>El monto se divide:</strong> El monto de la cita se divide entre todos los t茅cnicos asignados</li>
                        <li><strong>Ejemplo:</strong> Si una cita de 50,000 es atendida por 2 t茅cnicos, cada uno recibe 25,000</li>
                        <li><strong>Prop贸sito:</strong> Distribuir justamente la facturaci贸n entre los t茅cnicos que trabajaron</li>
                    </ul>

                    <h4>D铆a Operacional</h4>
                    <div class="warning-box">
                        <p><strong>Recordatorio:</strong> El d铆a operacional va de 5:00 AM a 4:59:59 AM del d铆a siguiente.</p>
                        <p>Una cita a las 4:30 AM pertenece al d铆a anterior operacionalmente, aunque sea t茅cnicamente el d铆a siguiente en el calendario.</p>
                    </div>

                    <h3><i class="fas fa-sync-alt me-2"></i>Actualizaci贸n desde Google Sheets</h3>
                    
                    <h4>Proceso</h4>
                    <ol>
                        <li><strong>Hoja "vaciado":</strong> Contiene las citas que se cargar谩n al calendario</li>
                        <li><strong>Bot贸n "Actualizar desde Sheets Oficial":</strong> En <code>calendario.html</code></li>
                        <li><strong>Proceso autom谩tico:</strong> Lee la hoja, crea/actualiza citas en Firestore</li>
                        <li><strong>Eliminaci贸n de duplicados:</strong> El sistema puede eliminar citas duplicadas</li>
                    </ol>

                    <h4>Auditor铆a</h4>
                    <p>Para verificar que las citas est谩n correctas:</p>
                    <ul>
                        <li><strong>Hoja "mes_completo":</strong> Contiene todas las citas del mes para auditor铆a</li>
                        <li><strong>Herramienta de eliminaci贸n de duplicados:</strong> <code>(herramienta administrativa - movida a herramientas)</code></li>
                        <li><strong>Comparaci贸n:</strong> Compara montos por d铆a y tel茅fono entre Sheets y Firestore</li>
                    </ul>

                    <!-- Quiz: Gesti贸n de Rutas -->
                    <div class="quiz-container" data-quiz-id="rutas">
                        <h3><i class="fas fa-route me-2"></i>猴 Reto: Coordinador de Rutas</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Cu谩ntas rutas hay en total en el sistema?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="rutas-q1" value="a"> 10 rutas</label>
                                    <label><input type="radio" name="rutas-q1" value="b"> 20 rutas (1-10 diurnas, 11-20 nocturnas)</label>
                                    <label><input type="radio" name="rutas-q1" value="c"> 5 rutas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 colecci贸n almacena la asignaci贸n de t茅cnicos y veh铆culos a cada ruta?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="rutas-q2" value="a"> citas</label>
                                    <label><input type="radio" name="rutas-q2" value="b"> ruteador</label>
                                    <label><input type="radio" name="rutas-q2" value="c"> empleados</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴C贸mo se divide la facturaci贸n cuando varios t茅cnicos atienden una cita?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="rutas-q3" value="a"> Se asigna al primer t茅cnico</label>
                                    <label><input type="radio" name="rutas-q3" value="b"> Se divide proporcionalmente entre todos los t茅cnicos asignados</label>
                                    <label><input type="radio" name="rutas-q3" value="c"> Se duplica para cada t茅cnico</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 campo en la colecci贸n ruteador almacena los usernames de los t茅cnicos asignados?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="rutas-q4" value="a"> empleados</label>
                                    <label><input type="radio" name="rutas-q4" value="b"> tecnicos (array de usernames)</label>
                                    <label><input type="radio" name="rutas-q4" value="c"> nombres</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 hoja de Google Sheets se usa para actualizar el calendario desde Sheets?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="rutas-q5" value="a"> mes_completo</label>
                                    <label><input type="radio" name="rutas-q5" value="b"> vaciado</label>
                                    <label><input type="radio" name="rutas-q5" value="c"> citas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴A qu茅 hora termina el d铆a operacional (no el d铆a calendario)?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="rutas-q6" value="a"> Medianoche (00:00)</label>
                                    <label><input type="radio" name="rutas-q6" value="b"> 4:59:59 AM del d铆a siguiente</label>
                                    <label><input type="radio" name="rutas-q6" value="c"> 5:00 PM</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('rutas')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-rutas"></div>
                    </div>
                </div>

                <!-- Secci贸n: Gu铆a de Desarrollo -->
                <div id="desarrollo" class="content-section">
                    <h2><i class="fas fa-tools me-2"></i>Gu铆a de Desarrollo</h2>
                    
                    <div class="info-box">
                        <p>Esta secci贸n te gu铆a paso a paso para <strong>desarrollar nuevas funcionalidades</strong> o modificar las existentes:</p>
                    </div>

                    <h3><i class="fas fa-lightbulb me-2"></i>Proceso de Desarrollo</h3>
                    
                    <div class="diagram-container">
                        <h4>Flujo de Desarrollo</h4>
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">1</span>
                                <strong>Entender el Requerimiento</strong><br>
                                <small>驴Qu茅 se necesita hacer?</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">2</span>
                                <strong>Buscar C贸digo Existente</strong><br>
                                <small>驴D贸nde est谩 el c贸digo relacionado?</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">3</span>
                                <strong>Hacer Cambios</strong><br>
                                <small>Modificar o agregar c贸digo</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">4</span>
                                <strong>Probar Localmente</strong><br>
                                <small>Verificar que funciona</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">5</span>
                                <strong>Desplegar</strong><br>
                                <small>Publicar cambios</small>
                            </div>
                        </div>
                    </div>

                    <h3>Paso 1: Entender el Requerimiento</h3>
                    
                    <h4>Preguntas Clave:</h4>
                    <ul>
                        <li>驴Qu茅 funcionalidad se necesita?</li>
                        <li>驴En qu茅 m贸dulo debe ir?</li>
                        <li>驴Qui茅n la va a usar?</li>
                        <li>驴Hay algo similar ya hecho?</li>
                    </ul>

                    <h4>Ejemplo:</h4>
                    <div class="info-box">
                        <p><strong>Requerimiento:</strong> "Agregar un bot贸n para exportar el reporte de facturaci贸n a Excel"</p>
                        <p><strong>An谩lisis:</strong></p>
                        <ul>
                            <li>M贸dulo: Reportes Gerenciales</li>
                            <li>Archivo: <code>reportes_gerenciales.html</code></li>
                            <li>Usuarios: Gerentes</li>
                            <li>Similar: Ya existe exportar en otros m贸dulos</li>
                        </ul>
                    </div>

                    <h3>Paso 2: Buscar C贸digo Existente</h3>
                    
                    <h4>Usando Cursor AI:</h4>
                    <ol>
                        <li><strong>Abre Cursor AI</strong> y el proyecto</li>
                        <li><strong>Pregunta:</strong> "驴D贸nde est谩 el c贸digo que genera el reporte de facturaci贸n?"</li>
                        <li><strong>Cursor AI te mostrar谩:</strong>
                            <ul>
                                <li>El archivo donde est谩</li>
                                <li>La funci贸n que lo genera</li>
                                <li>C贸digo relacionado</li>
                            </ul>
                        </li>
                    </ol>

                    <h4>Usando B煤squeda:</h4>
                    <ul>
                        <li><strong>Ctrl + F</strong> (o Cmd + F): Buscar texto en el archivo actual</li>
                        <li><strong>Ctrl + Shift + F</strong>: Buscar en todos los archivos</li>
                        <li><strong>Buscar por:</strong> Nombres de funciones, IDs de elementos, texto visible</li>
                    </ul>

                    <h3>Paso 3: Hacer Cambios</h3>
                    
                    <h4>Estrategias:</h4>
                    
                    <h5>Opci贸n A: Modificar C贸digo Existente</h5>
                    <ol>
                        <li>Encuentra el c贸digo que hace algo similar</li>
                        <li>C贸pialo como referencia</li>
                        <li>Modif铆calo para tu necesidad</li>
                        <li>Prueba que funciona</li>
                    </ol>

                    <h5>Opci贸n B: Agregar C贸digo Nuevo</h5>
                    <ol>
                        <li>Pregunta a Cursor AI: "驴C贸mo hago [lo que necesitas]?"</li>
                        <li>Cursor AI te dar谩 c贸digo de ejemplo</li>
                        <li>Ad谩ptalo a tu caso espec铆fico</li>
                        <li>Integra con el c贸digo existente</li>
                    </ol>

                    <h4>Ejemplo Pr谩ctico: Agregar Bot贸n de Exportar</h4>
                    <div class="code-example">
// 1. Buscar donde est谩n los otros botones de exportar
// 2. Copiar estructura similar
// 3. Modificar para exportar datos de facturaci贸n
// 4. Agregar funci贸n JavaScript para generar Excel

// Pregunta a Cursor AI:
"驴C贸mo exporto datos de una tabla a Excel en JavaScript?"
                    </div>

                    <h3>Paso 4: Probar Localmente</h3>
                    
                    <h4>Antes de Desplegar:</h4>
                    <ol>
                        <li><strong>Revisa la sintaxis:</strong> Aseg煤rate de que no hay errores de escritura</li>
                        <li><strong>Guarda el archivo:</strong> Ctrl + S</li>
                        <li><strong>Abre en navegador:</strong> Abre el archivo HTML directamente</li>
                        <li><strong>Revisa la consola:</strong> F12  Console, busca errores</li>
                        <li><strong>Prueba la funcionalidad:</strong> Haz clic, prueba botones, etc.</li>
                    </ol>

                    <h4>Errores Comunes:</h4>
                    <ul>
                        <li><strong>Error de sintaxis:</strong> Falta una comilla, par茅ntesis, etc.</li>
                        <li><strong>Elemento no encontrado:</strong> El ID o clase no existe</li>
                        <li><strong>Variable no definida:</strong> Falta declarar una variable</li>
                    </ul>

                    <h3>Paso 5: Desplegar</h3>
                    
                    <h4>Comando:</h4>
                    <div class="code-example">
firebase deploy --only hosting
                    </div>

                    <h4>Proceso:</h4>
                    <ol>
                        <li><strong>Abre la terminal</strong> en Cursor AI</li>
                        <li><strong>Navega al proyecto:</strong> <code>cd /ruta/al/proyecto</code></li>
                        <li><strong>Ejecuta el comando:</strong> <code>firebase deploy --only hosting</code></li>
                        <li><strong>Espera:</strong> Puede tomar 1-2 minutos</li>
                        <li><strong>Verifica:</strong> Abre el sitio y prueba los cambios</li>
                    </ol>

                    <h3><i class="fas fa-code-branch me-2"></i>Mejores Pr谩cticas de C贸digo</h3>
                    
                    <h4>Nombres Descriptivos</h4>
                    <div class="code-example">
//  Mal
const x = 10;
const btn1 = document.getElementById('btn');

//  Bien
const cantidadMaxima = 10;
const botonExportar = document.getElementById('btnExportarReporte');
                    </div>

                    <h4>Comentar el C贸digo</h4>
                    <div class="code-example">
// Calcular facturaci贸n total del d铆a
// Suma todos los montos de las citas del d铆a seleccionado
const facturacionTotal = citasDelDia.reduce((sum, cita) => {
    const monto = obtenerMonto(cita);
    return sum + (monto || 0);
}, 0);
                    </div>

                    <h4>Mantener C贸digo Organizado</h4>
                    <ul>
                        <li><strong>Agrupa funciones relacionadas</strong> juntas</li>
                        <li><strong>Usa secciones comentadas</strong> para organizar</li>
                        <li><strong>Mant茅n consistencia</strong> con el c贸digo existente</li>
                    </ul>
                </div>

                <!-- Secci贸n: Troubleshooting -->
                <div id="troubleshooting" class="content-section">
                    <h2><i class="fas fa-wrench me-2"></i>Troubleshooting (Soluci贸n de Problemas)</h2>
                    
                    <div class="info-box">
                        <p>Aqu铆 encontrar谩s soluciones a <strong>problemas comunes</strong> que pueden surgir al trabajar con el sistema:</p>
                    </div>

                    <h3><i class="fas fa-exclamation-triangle me-2"></i>Problema 1: "Missing or insufficient permissions"</h3>
                    
                    <h4>S铆ntomas:</h4>
                    <ul>
                        <li>Error en la consola del navegador</li>
                        <li>No se pueden leer o escribir datos</li>
                        <li>Mensaje: "Missing or insufficient permissions"</li>
                    </ul>

                    <h4>Causas Posibles:</h4>
                    <ol>
                        <li><strong>No est谩s autenticado:</strong> Tu sesi贸n expir贸</li>
                        <li><strong>Falta regla en Firestore:</strong> La colecci贸n no tiene permisos configurados</li>
                        <li><strong>Permisos de usuario:</strong> Tu usuario no tiene acceso a esa funcionalidad</li>
                    </ol>

                    <h4>Soluciones:</h4>
                    <ol>
                        <li><strong>Recargar la p谩gina:</strong> A veces la sesi贸n se renueva</li>
                        <li><strong>Cerrar sesi贸n y volver a entrar:</strong> Reiniciar autenticaci贸n</li>
                        <li><strong>Verificar Firestore Rules:</strong> Preguntar a Cursor AI: "驴C贸mo agrego una regla para la colecci贸n X?"</li>
                        <li><strong>Verificar permisos:</strong> Revisar en <code>check-permissions.js</code></li>
                    </ol>

                    <h3><i class="fas fa-bug me-2"></i>Problema 2: "Error en la consola del navegador"</h3>
                    
                    <h4>Pasos para Diagnosticar:</h4>
                    <ol>
                        <li><strong>Abrir consola:</strong> F12  Pesta帽a "Console"</li>
                        <li><strong>Leer el error:</strong> Copia el mensaje completo</li>
                        <li><strong>Buscar el archivo:</strong> El error indica en qu茅 archivo est谩 (ej: <code>calendario.html:1234</code>)</li>
                        <li><strong>Ir a esa l铆nea:</strong> Abre el archivo y ve a la l铆nea indicada</li>
                        <li><strong>Preguntar a Cursor AI:</strong> Pega el error y pregunta qu茅 significa</li>
                    </ol>

                    <h4>Errores Comunes y Soluciones:</h4>
                    
                    <h5>"Cannot read property 'X' of null"</h5>
                    <p><strong>Significa:</strong> Intentas acceder a algo que no existe</p>
                    <p><strong>Soluci贸n:</strong> Verificar que el elemento existe antes de usarlo</p>
                    <div class="code-example">
//  Mal
document.getElementById('miElemento').textContent = 'Hola';

//  Bien
const elemento = document.getElementById('miElemento');
if (elemento) {
    elemento.textContent = 'Hola';
}
                    </div>

                    <h5>"Function is not defined"</h5>
                    <p><strong>Significa:</strong> Est谩s llamando a una funci贸n que no existe</p>
                    <p><strong>Soluci贸n:</strong> Verificar que la funci贸n est茅 definida y disponible</p>

                    <h5>"Unexpected token"</h5>
                    <p><strong>Significa:</strong> Error de sintaxis (falta comilla, par茅ntesis, etc.)</p>
                    <p><strong>Soluci贸n:</strong> Revisar la l铆nea indicada, buscar caracteres faltantes</p>

                    <h3><i class="fas fa-database me-2"></i>Problema 3: "Los datos no se actualizan"</h3>
                    
                    <h4>Posibles Causas:</h4>
                    <ul>
                        <li><strong>No se guard贸 en Firebase:</strong> Error al escribir</li>
                        <li><strong>Cache del navegador:</strong> Est谩s viendo datos viejos</li>
                        <li><strong>Error silencioso:</strong> El c贸digo falla pero no muestra error</li>
                    </ul>

                    <h4>Soluciones:</h4>
                    <ol>
                        <li><strong>Revisar consola:</strong> Buscar errores</li>
                        <li><strong>Limpiar cache:</strong> Ctrl + Shift + R (o Cmd + Shift + R)</li>
                        <li><strong>Verificar en Firebase Console:</strong> Ir a <a href="https://console.firebase.google.com" target="_blank">console.firebase.google.com</a> y ver si los datos est谩n ah铆</li>
                        <li><strong>Agregar logs:</strong> <code>console.log('Datos:', datos);</code> para ver qu茅 est谩 pasando</li>
                    </ol>

                    <h3><i class="fas fa-sync me-2"></i>Problema 4: "El stock no coincide"</h3>
                    
                    <h4>S铆ntomas:</h4>
                    <ul>
                        <li>El stock mostrado no coincide con las transacciones</li>
                        <li>Aparecen n煤meros negativos</li>
                        <li>Los c谩lculos no cuadran</li>
                    </ul>

                    <h4>Soluciones:</h4>
                    <ol>
                        <li><strong>Recalcular Saldos:</strong>
                            <ul>
                                <li>Ir a <code>admin_inventario_bodegas.html</code></li>
                                <li>Click en "Recalcular Saldos"</li>
                                <li>Esperar a que termine (puede tardar)</li>
                            </ul>
                        </li>
                        <li><strong>Revisar Transacciones:</strong>
                            <ul>
                                <li>Ir a <code>admin_inventario_transacciones.html</code></li>
                                <li>Filtrar por el producto/herramienta problem谩tico</li>
                                <li>Verificar que todas las transacciones est茅n correctas</li>
                            </ul>
                        </li>
                        <li><strong>Revisar Anomal铆as:</strong>
                            <ul>
                                <li>Ir a <code>administrador_bodega.html</code>  Reportes y An谩lisis  Anomal铆as</li>
                                <li>Ver productos/herramientas con stock negativo</li>
                            </ul>
                        </li>
                    </ol>

                    <h3><i class="fas fa-calendar-times me-2"></i>Problema 5: "Las citas no aparecen en el d铆a correcto"</h3>
                    
                    <h4>Causa:</h4>
                    <p>Problema con zonas horarias o con la l贸gica del "d铆a laborable".</p>

                    <h4>Soluci贸n:</h4>
                    <ul>
                        <li><strong>Recordar:</strong> El d铆a laborable va de 5:00 AM a 4:59 AM del d铆a siguiente</li>
                        <li><strong>Verificar:</strong> Si una cita es a las 4:30 AM, pertenece al d铆a anterior</li>
                        <li><strong>Revisar:</strong> La fecha contable en las transacciones de inventario</li>
                    </ul>

                    <h3><i class="fas fa-question-circle me-2"></i>Cu谩ndo Pedir Ayuda</h3>
                    
                    <div class="warning-box">
                        <h4>Pide ayuda si:</h4>
                        <ul>
                            <li>Has intentado solucionarlo y no puedes</li>
                            <li>El error es cr铆tico (rompe funcionalidad importante)</li>
                            <li>No entiendes qu茅 significa el error</li>
                            <li>Llevas m谩s de 30 minutos intentando solucionarlo</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <h4>Recursos de Ayuda:</h4>
                        <ul>
                            <li><strong>Cursor AI:</strong> Tu primera opci贸n, pregunta en espa帽ol</li>
                            <li><strong>Consola del navegador:</strong> F12  Console para ver errores</li>
                            <li><strong>Firebase Console:</strong> Ver datos directamente</li>
                            <li><strong>Compa帽eros:</strong> No tengas miedo de preguntar</li>
                        </ul>
                    </div>

                    <!-- Quiz: Troubleshooting -->
                    <div class="quiz-container" data-quiz-id="troubleshooting">
                        <h3><i class="fas fa-wrench me-2"></i> Reto: Solucionador de Problemas</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Qu茅 significa el error "Missing or insufficient permissions"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="troubleshooting-q1" value="a"> El archivo no existe</label>
                                    <label><input type="radio" name="troubleshooting-q1" value="b"> No tienes permiso para leer o escribir datos en Firestore</label>
                                    <label><input type="radio" name="troubleshooting-q1" value="c"> El servidor est谩 ca铆do</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴C贸mo puedes ver errores en el navegador?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="troubleshooting-q2" value="a"> F12  Pesta帽a Console</label>
                                    <label><input type="radio" name="troubleshooting-q2" value="b"> Ctrl + Alt + Del</label>
                                    <label><input type="radio" name="troubleshooting-q2" value="c"> Reiniciar el navegador</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 funci贸n puedes usar si el stock no coincide con las transacciones?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="troubleshooting-q3" value="a"> Eliminar todas las transacciones</label>
                                    <label><input type="radio" name="troubleshooting-q3" value="b"> Recalcular Saldos en admin_inventario_bodegas.html</label>
                                    <label><input type="radio" name="troubleshooting-q3" value="c"> Reiniciar el sistema</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 significa el error "Cannot read property 'X' of null"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="troubleshooting-q4" value="a"> El archivo no se puede leer</label>
                                    <label><input type="radio" name="troubleshooting-q4" value="b"> Intentas acceder a algo que no existe (el elemento es null)</label>
                                    <label><input type="radio" name="troubleshooting-q4" value="c"> No hay conexi贸n a internet</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴C贸mo puedes limpiar el cache del navegador para ver datos actualizados?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="troubleshooting-q5" value="a"> Ctrl + R</label>
                                    <label><input type="radio" name="troubleshooting-q5" value="b"> Ctrl + Shift + R (o Cmd + Shift + R en Mac)</label>
                                    <label><input type="radio" name="troubleshooting-q5" value="c"> Cerrar el navegador</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 reporte puedes usar para detectar productos/herramientas con stock negativo?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="troubleshooting-q6" value="a"> Reporte de Horas</label>
                                    <label><input type="radio" name="troubleshooting-q6" value="b"> Reporte de Anomal铆as en administrador_bodega.html</label>
                                    <label><input type="radio" name="troubleshooting-q6" value="c"> Reporte de Encuestas</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('troubleshooting')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-troubleshooting"></div>
                    </div>
                </div>

                <!-- Secci贸n: Buenos y Malos Prompts -->
                <div id="prompts" class="content-section">
                    <h2><i class="fas fa-comments me-2"></i>Buenos y Malos Prompts para Cursor AI</h2>
                    
                    <div class="info-box">
                        <p>Saber c贸mo comunicarte con Cursor AI es <strong>crucial</strong> para obtener resultados precisos y evitar cambios no deseados. Esta secci贸n te ense帽ar谩 la diferencia entre prompts efectivos y peligrosos.</p>
                    </div>

                    <h3><i class="fas fa-check-circle me-2" style="color: #28a745;"></i>Caracter铆sticas de un Buen Prompt</h3>
                    <ul>
                        <li><strong>Espec铆fico:</strong> Indica exactamente qu茅 quieres cambiar</li>
                        <li><strong>Contextual:</strong> Menciona el archivo o m贸dulo espec铆fico</li>
                        <li><strong>Limitado:</strong> Define el alcance del cambio</li>
                        <li><strong>Claro:</strong> Usa lenguaje directo y sin ambig眉edades</li>
                        <li><strong>Seguro:</strong> No afecta otras partes del sistema</li>
                    </ul>

                    <h3><i class="fas fa-times-circle me-2" style="color: #dc3545;"></i>Caracter铆sticas de un Mal Prompt</h3>
                    <ul>
                        <li><strong>Vago:</strong> No especifica qu茅 o d贸nde cambiar</li>
                        <li><strong>Demasiado amplio:</strong> Puede afectar m谩s de lo deseado</li>
                        <li><strong>Peligroso:</strong> Puede eliminar o modificar datos cr铆ticos</li>
                        <li><strong>Sin contexto:</strong> No menciona archivos o m贸dulos espec铆ficos</li>
                        <li><strong>Ambiguo:</strong> Puede interpretarse de m煤ltiples formas</li>
                    </ul>

                    <h3 style="margin-top: 40px; color: #dc3545;"><i class="fas fa-exclamation-triangle me-2"></i>Prompts de ALTO RIESGO - NUNCA USAR</h3>
                    <div class="warning-box" style="background: #fff3cd; border-left: 5px solid #dc3545; padding: 20px; margin: 20px 0;">
                        <h4 style="color: #dc3545; margin-bottom: 15px;">锔 ADVERTENCIA CRTICA</h4>
                        <p>Los siguientes prompts pueden causar <strong>p茅rdida de datos, eliminaci贸n de funcionalidades cr铆ticas, o corrupci贸n del sistema</strong>. <strong>NUNCA</strong> los uses sin entender completamente sus consecuencias y tener un respaldo completo.</p>
                    </div>

                    <h3 style="margin-top: 30px;"><i class="fas fa-balance-scale me-2"></i>Comparaci贸n: Mal Prompt vs Buen Prompt</h3>
                    <p style="margin-bottom: 25px;">A continuaci贸n ver谩s ejemplos donde el <strong>objetivo es el mismo</strong>, pero la forma de comunicarlo a Cursor AI hace la diferencia:</p>

                    <div class="row mt-4">
                        <!-- Par 1 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla el calendario."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Muy vago. No especifica qu茅 est谩 mal ni qu茅 archivo modificar.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.html</code>, agrega un bot贸n 'Exportar a Excel' en la secci贸n de filtros que exporte las citas del d铆a seleccionado."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico, menciona el archivo, la ubicaci贸n exacta y la funcionalidad deseada.</small>
                            </div>
                        </div>

                        <!-- Par 2 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora el dise帽o de todos los botones."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Demasiado amplio. Afectar铆a todos los botones del sitio sin especificar c贸mo.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En el archivo <code>admin_inventario_productos.html</code>, cambia el color del bot贸n 'Agregar Producto' a verde (#28a745) y aumenta su tama帽o de fuente a 16px."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, bot贸n exacto, cambios concretos (color y tama帽o).</small>
                            </div>
                        </div>

                        <!-- Par 3 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega validaciones."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No dice qu茅 validar, d贸nde, ni qu茅 tipo de validaci贸n.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>registro_horas.html</code>, agrega una validaci贸n que impida iniciar un turno si ya hay uno activo para el mismo empleado."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, tipo de validaci贸n, condici贸n exacta.</small>
                            </div>
                        </div>

                        <!-- Par 4 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los errores."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 errores ni d贸nde est谩n.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Modifica solo la funci贸n <code>cargarCitas()</code> en <code>calendario.html</code> para que ordene las citas por hora de inicio de forma ascendente."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: funci贸n exacta, archivo, cambio concreto (ordenar por hora).</small>
                            </div>
                        </div>

                        <!-- Par 5 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Cambia los colores."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 colores, d贸nde, ni a qu茅 cambiarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Modifica 煤nicamente el CSS del header en <code>iniciar_sesion.html</code> para aumentar el padding a 30px y cambiar el color de fondo a #f8f9fa."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: elemento exacto (header), archivo, cambios concretos (padding y color).</small>
                            </div>
                        </div>

                        <!-- Par 6 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que todo sea m谩s r谩pido."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Vago y sin contexto. No indica qu茅 optimizar ni d贸nde.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reportes_gerenciales.html</code>, agrega un filtro de fecha 'Desde' y 'Hasta' en la secci贸n 'Reporte de Horas por D铆a', sin modificar otras secciones."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, secci贸n exacta, funcionalidad concreta, restricci贸n clara.</small>
                            </div>
                        </div>

                        <!-- Par 7 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora la experiencia del usuario."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Muy subjetivo. Podr铆a cambiar muchas cosas sin criterios claros.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Cambia el texto del bot贸n 'Guardar' a 'Guardar Cambios' solo en el modal de edici贸n de empleados en <code>admin_empleados.html</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: elemento exacto, ubicaci贸n, cambio concreto, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 8 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega m谩s funcionalidades."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 funcionalidades ni d贸nde agregarlas.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>operario_bodega.html</code>, agrega un campo de b煤squeda por nombre de producto en la secci贸n 'Productos Disponibles', sin afectar otras funcionalidades."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, secci贸n, funcionalidad concreta, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 9 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Optimiza las consultas a la base de datos."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Podr铆a cambiar todas las consultas sin especificar cu谩les ni c贸mo.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_transacciones.html</code>, agrega una columna 'Usuario' que muestre el username de quien cre贸 la transacci贸n, solo en esa tabla."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, tabla exacta, columna concreta, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 10 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Corrige los bugs."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 bugs ni d贸nde est谩n. Podr铆a 'corregir' cosas que funcionan bien.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Cambia el mensaje de error 'Producto no encontrado' a 'El producto seleccionado no existe en el inventario' solo en <code>operario_bodega.js</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, mensaje exacto, cambio concreto, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 11 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz el c贸digo m谩s limpio."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo y sin criterios. Podr铆a refactorizar c贸digo que funciona bien.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.html</code>, agrega un tooltip al pasar el mouse sobre el nombre del cliente que muestre su tel茅fono, sin modificar otras funciones."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, elemento exacto, funcionalidad concreta, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 12 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Simplifica el c贸digo."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Podr铆a eliminar funcionalidades importantes pensando que son innecesarias.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Modifica la funci贸n <code>validarStock()</code> en <code>admin_inventario_pedidos_especiales.js</code> para que tambi茅n valide que la cantidad sea mayor a 0."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: funci贸n exacta, archivo, validaci贸n concreta.</small>
                            </div>
                        </div>

                        <!-- Par 13 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que sea m谩s moderno."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar todo el dise帽o sin criterios.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reporte_encuestas.html</code>, cambia el orden de las columnas en la tabla de resultados para que 'Fecha' aparezca primero, sin afectar los datos."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, tabla exacta, cambio concreto, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 14 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora la seguridad."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Muy amplio. Podr铆a modificar reglas de Firestore, autenticaci贸n, etc. sin control.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega un bot贸n 'Copiar ID' junto a cada ID de producto en <code>admin_inventario_productos.html</code> que copie el ID al portapapeles al hacer clic."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, ubicaci贸n exacta, funcionalidad concreta.</small>
                            </div>
                        </div>

                        <!-- Par 15 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Actualiza todas las funciones."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Extremadamente peligroso. Podr铆a modificar todo el c贸digo sin control.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_bodegas.html</code>, modifica solo el estilo del bot贸n 'Recalcular Saldos' para que tenga un fondo rojo (#dc3545) y texto blanco."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, bot贸n exacto, cambios concretos, restricci贸n clara.</small>
                            </div>
                        </div>

                        <!-- Par 16 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega filtros."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 tipo de filtros, d贸nde, ni qu茅 deben filtrar.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_transacciones.html</code>, agrega un filtro por tipo de transacci贸n (compra, gasto, transferencia) en la barra de filtros superior, sin modificar otros filtros existentes."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, ubicaci贸n exacta, tipos de filtro, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 17 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los reportes se vean mejor."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar todo el dise帽o sin criterios claros.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reportes_gerenciales.html</code>, aumenta el tama帽o de fuente de los t铆tulos de las tablas a 18px y agrega un borde inferior de 2px s贸lido color #dee2e6, solo en la secci贸n 'Reporte de Horas por D铆a'."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, secci贸n exacta, cambios concretos (tama帽o y borde), restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 18 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los problemas de stock."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 problemas, d贸nde est谩n, ni c贸mo arreglarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_pedidos_especiales.js</code>, modifica la funci贸n <code>validarStock()</code> para que muestre un mensaje de error espec铆fico cuando la cantidad solicitada excede el stock disponible, mostrando 'Stock disponible: X unidades'."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, cambio concreto, mensaje detallado.</small>
                            </div>
                        </div>

                        <!-- Par 19 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora la b煤squeda."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 b煤squeda, c贸mo mejorarla, ni d贸nde est谩.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_productos.html</code>, modifica el campo de b煤squeda para que busque tanto en el nombre como en el ID del producto, sin afectar otras funcionalidades de la p谩gina."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, campo exacto, funcionalidad concreta, restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 20 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que las tablas sean m谩s grandes."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 tablas, c贸mo hacerlas m谩s grandes, ni d贸nde est谩n.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_productos.html</code>, aumenta el ancho de la tabla 'Cat谩logo de Productos' al 100% del contenedor y reduce el padding de las celdas a 8px, sin modificar otras tablas de la p谩gina."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, tabla exacta, cambios concretos (ancho y padding), restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 21 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega confirmaciones."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 acciones necesitan confirmaci贸n ni d贸nde agregarlas.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_transacciones.html</code>, agrega un di谩logo de confirmaci贸n antes de eliminar una transacci贸n que muestre '驴Est谩s seguro de eliminar esta transacci贸n? Esta acci贸n actualizar谩 los saldos de stock.'"</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, acci贸n exacta, mensaje concreto, informaci贸n relevante.</small>
                            </div>
                        </div>

                        <!-- Par 22 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los formularios sean m谩s f谩ciles de usar."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar muchos formularios sin criterios claros.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_pedidos_especiales.html</code>, agrega etiquetas descriptivas (labels) arriba de cada campo del formulario de pedido especial y aumenta el tama帽o de fuente de los inputs a 16px."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, formulario exacto, cambios concretos (labels y tama帽o), restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 23 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los mensajes de error."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 mensajes, d贸nde est谩n, ni c贸mo arreglarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>operario_bodega.js</code>, cambia el mensaje de error 'Error al guardar' por 'No se pudo guardar la transacci贸n. Verifica tu conexi贸n e intenta nuevamente.' en la funci贸n <code>guardarGasto()</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, mensaje antiguo y nuevo, contexto.</small>
                            </div>
                        </div>

                        <!-- Par 24 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora los reportes."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Muy amplio. Podr铆a cambiar todos los reportes sin especificar c贸mo.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reportes_gerenciales.html</code>, agrega un bot贸n 'Descargar PDF' al lado del bot贸n 'Exportar Excel' en la secci贸n 'Reporte de Facturaci贸n por Empleado', que genere un PDF con el mismo formato de la tabla."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, secci贸n exacta, ubicaci贸n del bot贸n, funcionalidad concreta.</small>
                            </div>
                        </div>

                        <!-- Par 25 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que sea m谩s r谩pido."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Vago. No indica qu茅 optimizar ni d贸nde.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.html</code>, modifica la funci贸n <code>cargarCitas()</code> para que use <code>limit(50)</code> en la consulta de Firestore y agregue paginaci贸n, mostrando 50 citas por p谩gina."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, optimizaci贸n concreta (limit y paginaci贸n).</small>
                            </div>
                        </div>

                        <!-- Par 26 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega m谩s informaci贸n."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 informaci贸n, d贸nde, ni c贸mo mostrarla.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.html</code>, agrega una columna 'Duraci贸n' en la vista de citas que muestre la duraci贸n en minutos calculada desde <code>inicio</code> hasta <code>fin</code> de cada cita."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, vista exacta, columna concreta, c谩lculo detallado.</small>
                            </div>
                        </div>

                        <!-- Par 27 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los modales se vean mejor."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar todos los modales sin criterios.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_liquidar_especiales.html</code>, aumenta el ancho del modal 'Liquidar tem Pendiente' a 600px y agrega un sombreado (box-shadow) de '0 4px 12px rgba(0,0,0,0.15)', sin modificar otros modales."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, modal exacto, cambios concretos (ancho y sombra), restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 28 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los problemas de permisos."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 problemas, d贸nde, ni c贸mo arreglarlos. Podr铆a modificar reglas de seguridad.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>check-permissions.js</code>, agrega un mensaje de error m谩s descriptivo en la funci贸n <code>verificarPermisos()</code> cuando un usuario no tiene acceso, mostrando 'No tienes permiso para acceder a esta secci贸n. Contacta al administrador.'"</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, mensaje concreto, sin cambiar l贸gica de seguridad.</small>
                            </div>
                        </div>

                        <!-- Par 29 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los datos se actualicen autom谩ticamente."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Vago. No especifica qu茅 datos, d贸nde, ni c贸mo implementarlo.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>operario_bodega.html</code>, modifica la funci贸n <code>cargarStock()</code> para que use <code>onSnapshot</code> en lugar de <code>getDocs</code> en la consulta de <code>stock_bodegas</code>, para que el stock se actualice en tiempo real."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, cambio t茅cnico concreto (onSnapshot), colecci贸n espec铆fica.</small>
                            </div>
                        </div>

                        <!-- Par 30 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora la navegaci贸n."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar toda la estructura de navegaci贸n.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>administrador_bodega.html</code>, agrega un bot贸n 'Volver al Inicio' en la parte superior de la p谩gina de 'Anomal铆as' que redirija a <code>administrador_bodega.html</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, p谩gina exacta, bot贸n concreto, acci贸n espec铆fica.</small>
                            </div>
                        </div>

                        <!-- Par 31 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega m谩s opciones."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 opciones, d贸nde, ni qu茅 deben hacer.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_liquidar_especiales.html</code>, agrega una opci贸n 'Ver Historial' en el men煤 contextual de cada 铆tem pendiente que abra un modal mostrando todas las transacciones relacionadas a ese 铆tem."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, ubicaci贸n exacta, funcionalidad concreta, comportamiento detallado.</small>
                            </div>
                        </div>

                        <!-- Par 32 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los n煤meros se vean mejor."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar el formato de todos los n煤meros.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reportes_gerenciales.html</code>, formatea los montos en la tabla 'Facturaci贸n por Empleado por D铆a' para que muestren separadores de miles (ej: 22,000 en lugar de 22000) usando <code>toLocaleString('es-CR')</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, tabla exacta, formato concreto, m茅todo t茅cnico.</small>
                            </div>
                        </div>

                        <!-- Par 33 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los problemas de carga."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 problemas, d贸nde, ni c贸mo arreglarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.html</code>, agrega un indicador de carga (spinner) que se muestre mientras se cargan las citas desde Firestore, ubicado en el centro de la secci贸n del calendario."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, ubicaci贸n exacta, elemento concreto (spinner), momento de mostrar.</small>
                            </div>
                        </div>

                        <!-- Par 34 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora las notificaciones."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 notificaciones, c贸mo mejorarlas, ni d贸nde est谩n.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_pedidos_especiales.js</code>, modifica la funci贸n <code>procesarPedidoEspeciales()</code> para que muestre un mensaje de 茅xito verde con 铆cono de check cuando el pedido se guarde correctamente, usando Bootstrap alert."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, tipo de mensaje, estilo concreto.</small>
                            </div>
                        </div>

                        <!-- Par 35 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los dropdowns funcionen mejor."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 dropdowns, qu茅 problemas tienen, ni c贸mo mejorarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_liquidar_especiales.html</code>, agrega una opci贸n de b煤squeda dentro del dropdown 'Destino (Cta Gasto / Bodega)' que permita filtrar las opciones mientras el usuario escribe."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, dropdown exacto, funcionalidad concreta (b煤squeda y filtro).</small>
                            </div>
                        </div>

                        <!-- Par 36 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega m谩s columnas."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 columnas, en qu茅 tabla, ni qu茅 informaci贸n mostrar.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_transacciones.html</code>, agrega una columna 'Fecha Contable' despu茅s de la columna 'Fecha' que muestre el campo <code>fechaContable</code> de cada transacci贸n formateado como DD/MM/YYYY."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, tabla exacta, posici贸n de columna, campo y formato.</small>
                            </div>
                        </div>

                        <!-- Par 37 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los botones sean m谩s visibles."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar todos los botones sin criterios.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>operario_bodega.html</code>, cambia el color de fondo del bot贸n 'Reportar Gasto' a #dc3545 (rojo) y aumenta su tama帽o de fuente a 16px, sin modificar otros botones de la p谩gina."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, bot贸n exacto, cambios concretos (color y tama帽o), restricci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 38 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los problemas de fecha."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 problemas, d贸nde, ni c贸mo arreglarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_liquidar_especiales.js</code>, modifica la funci贸n <code>abrirModalLiquidacion()</code> para que use la fecha contable del pedido original (campo <code>fechaContable</code>) en lugar de la fecha actual al crear la liquidaci贸n."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, problema concreto, soluci贸n detallada.</small>
                            </div>
                        </div>

                        <!-- Par 39 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora los c谩lculos."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 c谩lculos, d贸nde, ni c贸mo mejorarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reportes_gerenciales.html</code>, modifica la funci贸n que calcula 'Facturaci贸n por Hora Laborada' para que divida el monto total entre las horas trabajadas (no entre horas del d铆a), usando el campo <code>horasTrabajadas</code> de <code>work_sessions</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, c谩lculo concreto, campos espec铆ficos.</small>
                            </div>
                        </div>

                        <!-- Par 40 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los usuarios puedan hacer m谩s cosas."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Muy vago. No especifica qu茅 funcionalidades ni d贸nde agregarlas.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>operario_bodega.html</code>, agrega un bot贸n 'Ver Detalles' junto a cada herramienta asignada que abra un modal mostrando el historial de movimientos de esa herramienta desde <code>movimientos_inventario</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, ubicaci贸n exacta, funcionalidad concreta, fuente de datos.</small>
                            </div>
                        </div>

                        <!-- Par 41 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los problemas de visualizaci贸n."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 problemas, d贸nde, ni c贸mo arreglarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.html</code>, modifica el CSS de las citas que se solapan en el mismo horario para que se muestren lado a lado usando flexbox, con un ancho m谩ximo del 50% cada una."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, problema exacto (solapamiento), soluci贸n t茅cnica (flexbox), especificaciones.</small>
                            </div>
                        </div>

                        <!-- Par 42 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Agrega m谩s validaciones de seguridad."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Muy amplio. Podr铆a modificar reglas de Firestore o autenticaci贸n sin control.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_pedidos_especiales.js</code>, agrega una validaci贸n en <code>procesarPedidoEspeciales()</code> que verifique que la cantidad solicitada no sea mayor al stock disponible antes de procesar el pedido."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, validaci贸n concreta, momento de ejecuci贸n.</small>
                            </div>
                        </div>

                        <!-- Par 43 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Haz que los reportes sean m谩s claros."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Subjetivo. Podr铆a cambiar todos los reportes sin criterios.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reportes_gerenciales.html</code>, agrega un encabezado descriptivo arriba de la tabla 'Facturaci贸n por Empleado por D铆a' que diga 'Facturaci贸n total del d铆a dividida entre los t茅cnicos asignados a cada ruta'."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, tabla exacta, elemento concreto (encabezado), texto descriptivo.</small>
                            </div>
                        </div>

                        <!-- Par 44 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los problemas de conexi贸n."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 problemas, d贸nde, ni c贸mo arreglarlos.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.js</code>, agrega manejo de errores en la funci贸n <code>cargarCitas()</code> para que muestre un mensaje 'Error al cargar citas. Verifica tu conexi贸n.' cuando falle la consulta a Firestore, usando try-catch."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, manejo de error concreto, mensaje espec铆fico.</small>
                            </div>
                        </div>

                        <!-- Par 45 -->
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                <strong style="color: #721c24; font-size: 1.1rem;"> MAL:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Mejora todo el sistema."</p>
                                <small style="color: #721c24;"><strong>Problema:</strong> Extremadamente peligroso y vago. Podr铆a modificar todo sin control.</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-4">
                            <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                <strong style="color: #155724; font-size: 1.1rem;"> BIEN:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>admin_inventario_productos.html</code>, agrega un tooltip al pasar el mouse sobre el nombre de cada producto que muestre su categor铆a, ID y stock total, obteniendo el stock de <code>stock_bodegas</code>."</p>
                                <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, elemento exacto, funcionalidad concreta, fuente de datos.</small>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: 40px; color: #dc3545;"><i class="fas fa-skull me-2"></i>Prompts de ALTO RIESGO - NUNCA USAR (15 ejemplos)</h3>
                    <div class="warning-box" style="background: #fff3cd; border-left: 5px solid #dc3545; padding: 20px; margin: 20px 0;">
                        <h4 style="color: #dc3545; margin-bottom: 15px;">锔 ADVERTENCIA CRTICA</h4>
                        <p>Los siguientes prompts pueden causar <strong>p茅rdida de datos, eliminaci贸n de funcionalidades cr铆ticas, o corrupci贸n del sistema</strong>. <strong>NUNCA</strong> los uses sin entender completamente sus consecuencias y tener un respaldo completo.</p>
                    </div>

                    <div class="row">
                        <div class="col-md-12">
                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 1:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina toda la base de datos."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Eliminar铆a TODOS los datos de Firestore: citas, empleados, inventario, transacciones, etc. IRREVERSIBLE sin respaldo.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 2:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Borra el m贸dulo de inventario."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Eliminar铆a todos los archivos relacionados con inventario, perdiendo funcionalidad cr铆tica del sistema.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 3:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las colecciones de Firestore."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a todas las colecciones: citas, empleados, productos, herramientas, stock, transacciones, etc.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 4:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Reescribe todo el c贸digo desde cero."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Perder铆a todo el c贸digo existente y funcionalidades probadas, requiriendo reconstruir todo.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 5:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las reglas de seguridad de Firestore."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Dejar铆a la base de datos sin protecci贸n, permitiendo acceso no autorizado y modificaciones maliciosas.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 6:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Borra todos los archivos HTML."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Eliminar铆a todas las p谩ginas del sitio, dej谩ndolo completamente inoperativo.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 7:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las funciones de autenticaci贸n."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Remover铆a la seguridad del sistema, permitiendo acceso sin login a cualquier usuario.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 8:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las transacciones de inventario."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a el historial completo de movimientos, haciendo imposible rastrear cambios y recalcular saldos.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 9:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Cambia todas las consultas a Firestore para que eliminen datos en lugar de leerlos."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Transformar铆a todas las lecturas en eliminaciones, borrando datos masivamente.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 10:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todos los m贸dulos de administraci贸n."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a funcionalidades cr铆ticas de gesti贸n: inventario, empleados, reportes, etc.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 11:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Desactiva todas las validaciones del sistema."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Permitir铆a ingresar datos inv谩lidos, causando errores y corrupci贸n de datos.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 12:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todos los archivos JavaScript."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a toda la l贸gica del sitio, dejando solo HTML sin funcionalidad.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 13:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Cambia todas las contrase帽as de usuarios a '1234'."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Comprometer铆a la seguridad de todas las cuentas, permitiendo acceso no autorizado.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 14:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las citas del calendario."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a todas las citas programadas, perdiendo informaci贸n cr铆tica del negocio.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 15:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Reemplaza todo el c贸digo con c贸digo nuevo."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Perder铆a todo el c贸digo probado y funcional, requiriendo reconstrucci贸n completa.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 16:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todos los empleados de la base de datos."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a todos los registros de empleados, perdiendo informaci贸n de personal, permisos y historial.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 17:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Borra todos los clientes y sus datos."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Eliminar铆a toda la informaci贸n de clientes, incluyendo historial de servicios y contactos.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 18:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las sesiones de trabajo (work_sessions)."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a todo el historial de horas trabajadas, haciendo imposible calcular n贸minas y reportes de horas.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 19:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Cambia todas las consultas de lectura (getDocs) por eliminaciones (deleteDoc)."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Transformar铆a todas las lecturas en eliminaciones, borrando datos masivamente en cada carga de p谩gina.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 20:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las bodegas y su configuraci贸n."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a toda la configuraci贸n de bodegas, haciendo imposible gestionar inventario y causando errores en transacciones.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 21:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Borra todos los productos y herramientas del inventario."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Eliminar铆a todo el cat谩logo de productos y herramientas, perdiendo informaci贸n de precios, categor铆as y configuraciones.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 22:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las encuestas y respuestas de clientes."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a todo el historial de satisfacci贸n de clientes, perdiendo datos valiosos para mejorar el servicio.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 23:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Desactiva todas las verificaciones de permisos en check-permissions.js."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Permitir铆a que cualquier usuario acceda a todas las secciones, incluyendo m贸dulos administrativos cr铆ticos.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 24:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Elimina todas las rutas y asignaciones de t茅cnicos."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Borrar铆a toda la configuraci贸n de rutas, haciendo imposible asignar t茅cnicos y veh铆culos a las citas.</small>
                            </div>

                            <div class="code-example" style="background: #f8d7da; border-left: 5px solid #dc3545; margin-bottom: 15px; padding: 20px;">
                                <strong style="color: #721c24; font-size: 1.2rem;"> RIESGO EXTREMO 25:</strong><br>
                                <p style="color: #333; font-weight: 600; margin: 10px 0;">"Borra todos los archivos de configuraci贸n (firebase.json, firestore.rules, etc.)."</p>
                                <small style="color: #721c24;"><strong>PELIGRO:</strong> Eliminar铆a la configuraci贸n del proyecto, haciendo imposible desplegar o mantener el sitio funcionando.</small>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: 50px;"><i class="fas fa-bug me-2"></i>Casos de Estudio: Diagn贸stico y Soluci贸n</h3>
                    <p style="margin-bottom: 25px;">A continuaci贸n ver谩s problemas reales que pueden ocurrir en el sitio, c贸mo diagnosticarlos y ejemplos de buenos y malos prompts para resolverlos:</p>

                    <!-- Caso de Estudio 1 -->
                    <div class="case-study" style="background: #f8f9fa; border-left: 5px solid #007bff; padding: 25px; margin-bottom: 30px; border-radius: 5px;">
                        <h4 style="color: #007bff; margin-bottom: 15px;"><i class="fas fa-calendar-times me-2"></i>Caso 1: No se crean eventos en el calendario</h4>
                        
                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Contexto del Problema:</strong></h5>
                            <p style="color: #333;">El equipo de ventas reporta que cuando intentan crear una nueva cita desde <code>calendario.html</code>, el bot贸n "Guardar Cita" no hace nada. La p谩gina se queda cargando indefinidamente y la cita no aparece en el calendario.</p>
                        </div>

                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Proceso de Diagn贸stico:</strong></h5>
                            <ol style="color: #333;">
                                <li><strong>Revisar la consola del navegador:</strong> Al abrir las herramientas de desarrollador (F12), se encuentra el error:
                                    <pre style="background: #f1f1f1; padding: 10px; border-radius: 3px; margin-top: 5px;"><code>calendario.js:245 TypeError: Cannot read property 'addDoc' of undefined
    at guardarCita (calendario.js:245:23)</code></pre>
                                </li>
                                <li><strong>Revisar el c贸digo:</strong> Al examinar <code>calendario.js</code> l铆nea 245, se ve que se intenta usar <code>addDoc</code> pero no est谩 importado correctamente desde Firebase.</li>
                                <li><strong>Verificar imports:</strong> En la parte superior del archivo, falta la importaci贸n de <code>addDoc</code> desde <code>firebase-firestore.js</code>.</li>
                                <li><strong>Probar en el sitio:</strong> Al intentar crear una cita, el error se reproduce consistentemente.</li>
                            </ol>
                        </div>

                        <div class="row mt-3">
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                    <strong style="color: #721c24; font-size: 1.1rem;"> MAL PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla el calendario que no guarda citas."</p>
                                    <small style="color: #721c24;"><strong>Problema:</strong> Muy vago. No menciona el error espec铆fico, el archivo, ni la soluci贸n.</small>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                    <strong style="color: #155724; font-size: 1.1rem;"> BUEN PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>calendario.js</code>, agrega la importaci贸n de <code>addDoc</code> desde <code>firebase-firestore.js</code> en la l铆nea donde se importan otras funciones de Firestore. El error es 'Cannot read property addDoc of undefined' en la funci贸n <code>guardarCita()</code> l铆nea 245."</p>
                                    <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, error exacto, l铆nea, funci贸n, soluci贸n concreta (importar addDoc).</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Caso de Estudio 2 -->
                    <div class="case-study" style="background: #f8f9fa; border-left: 5px solid #ffc107; padding: 25px; margin-bottom: 30px; border-radius: 5px;">
                        <h4 style="color: #856404; margin-bottom: 15px;"><i class="fas fa-boxes me-2"></i>Caso 2: Stock negativo en inventario</h4>
                        
                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Contexto del Problema:</strong></h5>
                            <p style="color: #333;">En <code>admin_inventario_saldos_pivot.html</code>, se reportan productos con saldo negativo. Al revisar <code>admin_inventario_transacciones.html</code>, se ve que hay transacciones de "gasto" que no est谩n actualizando correctamente el stock en <code>stock_bodegas</code>.</p>
                        </div>

                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Proceso de Diagn贸stico:</strong></h5>
                            <ol style="color: #333;">
                                <li><strong>Revisar transacciones:</strong> Se identifica que las transacciones de tipo "gasto" tienen <code>origen</code> y <code>destino</code>, pero el stock no se est谩 decrementando en <code>origen</code>.</li>
                                <li><strong>Revisar c贸digo:</strong> En <code>operario_bodega.js</code>, la funci贸n <code>guardarGasto()</code> crea el movimiento pero no llama a <code>actualizarStockBodega()</code>.</li>
                                <li><strong>Verificar utilidades:</strong> Existe <code>inventario-movimientos-utils.js</code> con la funci贸n <code>actualizarStockBodega()</code> que deber铆a usarse.</li>
                                <li><strong>Probar manualmente:</strong> Al crear un gasto, el movimiento se guarda pero el stock no cambia.</li>
                            </ol>
                        </div>

                        <div class="row mt-3">
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                    <strong style="color: #721c24; font-size: 1.1rem;"> MAL PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla el stock que est谩 negativo."</p>
                                    <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 archivo, qu茅 funci贸n, ni c贸mo arreglarlo. Podr铆a modificar muchas cosas.</small>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                    <strong style="color: #155724; font-size: 1.1rem;"> BUEN PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>operario_bodega.js</code>, modifica la funci贸n <code>guardarGasto()</code> para que despu茅s de crear el movimiento en <code>movimientos_inventario</code>, llame a <code>actualizarStockBodega()</code> desde <code>inventario-movimientos-utils.js</code> para decrementar el stock en la bodega origen. Importa la funci贸n al inicio del archivo."</p>
                                    <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, problema concreto, soluci贸n t茅cnica detallada, importaci贸n necesaria.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Caso de Estudio 3 -->
                    <div class="case-study" style="background: #f8f9fa; border-left: 5px solid #dc3545; padding: 25px; margin-bottom: 30px; border-radius: 5px;">
                        <h4 style="color: #dc3545; margin-bottom: 15px;"><i class="fas fa-exclamation-triangle me-2"></i>Caso 3: Error de permisos al guardar quiz</h4>
                        
                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Contexto del Problema:</strong></h5>
                            <p style="color: #333;">En <code>guia_entrenamiento.html</code>, cuando un usuario intenta guardar el resultado de un quiz, aparece el error: <code>FirebaseError: Missing or insufficient permissions</code>. El quiz no se guarda en la colecci贸n <code>quizzes_entrenamiento</code>.</p>
                        </div>

                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Proceso de Diagn贸stico:</strong></h5>
                            <ol style="color: #333;">
                                <li><strong>Revisar consola:</strong> El error aparece en la consola: <code>FirebaseError: Missing or insufficient permissions</code> al intentar <code>addDoc</code> en <code>quizzes_entrenamiento</code>.</li>
                                <li><strong>Revisar reglas de Firestore:</strong> En <code>firestore.rules</code>, se verifica que la colecci贸n <code>quizzes_entrenamiento</code> tenga reglas de escritura.</li>
                                <li><strong>Identificar problema:</strong> La regla <code>allow create</code> requiere que el campo <code>username</code> coincida exactamente con el email del usuario, pero el formato puede variar.</li>
                                <li><strong>Probar con diferentes usuarios:</strong> Algunos usuarios pueden guardar, otros no, dependiendo del formato de su email.</li>
                            </ol>
                        </div>

                        <div class="row mt-3">
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                    <strong style="color: #721c24; font-size: 1.1rem;"> MAL PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los permisos de los quizzes."</p>
                                    <small style="color: #721c24;"><strong>Problema:</strong> Muy vago. No menciona el archivo, la regla espec铆fica, ni la soluci贸n. Podr铆a modificar todas las reglas de seguridad.</small>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                    <strong style="color: #155724; font-size: 1.1rem;"> BUEN PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>firestore.rules</code>, modifica la regla <code>allow create</code> de la colecci贸n <code>quizzes_entrenamiento</code> para que solo verifique que el usuario est茅 autenticado (<code>isSecureSystem()</code>) y que el campo <code>username</code> exista y sea string, sin validar que coincida exactamente con el email. El problema es que algunos usuarios no pueden guardar debido a diferencias en el formato del email."</p>
                                    <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, regla exacta, colecci贸n, problema concreto, soluci贸n t茅cnica detallada.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Caso de Estudio 4 -->
                    <div class="case-study" style="background: #f8f9fa; border-left: 5px solid #28a745; padding: 25px; margin-bottom: 30px; border-radius: 5px;">
                        <h4 style="color: #155724; margin-bottom: 15px;"><i class="fas fa-chart-line me-2"></i>Caso 4: Reporte de facturaci贸n muestra montos incorrectos</h4>
                        
                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Contexto del Problema:</strong></h5>
                            <p style="color: #333;">En <code>reportes_gerenciales.html</code>, el "Reporte de Facturaci贸n por Empleado" muestra montos que parecen duplicados. Al revisar manualmente, se encuentra que cuando hay 2 t茅cnicos en una ruta, el monto se est谩 sumando en lugar de dividirse entre ellos.</p>
                        </div>

                        <div style="background: #fff; padding: 15px; border-radius: 5px; margin-bottom: 15px;">
                            <h5 style="color: #333; margin-bottom: 10px;"><strong> Proceso de Diagn贸stico:</strong></h5>
                            <ol style="color: #333;">
                                <li><strong>Revisar datos manualmente:</strong> Se verifica una cita con monto 50,000 y 2 t茅cnicos asignados. El reporte muestra 50,000 para cada t茅cnico (total 100,000) en lugar de 25,000 cada uno.</li>
                                <li><strong>Revisar c贸digo:</strong> En <code>reportes_gerenciales.html</code>, la funci贸n que calcula la facturaci贸n por empleado est谩 sumando el monto completo para cada t茅cnico sin dividirlo.</li>
                                <li><strong>Identificar funci贸n:</strong> La funci贸n <code>calcularFacturacionPorEmpleado()</code> itera sobre los t茅cnicos pero no divide el monto entre la cantidad de t茅cnicos.</li>
                                <li><strong>Verificar l贸gica:</strong> Seg煤n los requisitos, el monto debe dividirse proporcionalmente entre los t茅cnicos asignados a la ruta.</li>
                            </ol>
                        </div>

                        <div class="row mt-3">
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #f8d7da; border-left: 4px solid #dc3545; padding: 20px; height: 100%;">
                                    <strong style="color: #721c24; font-size: 1.1rem;"> MAL PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"Arregla los montos del reporte de facturaci贸n."</p>
                                    <small style="color: #721c24;"><strong>Problema:</strong> No especifica qu茅 archivo, qu茅 funci贸n, ni c贸mo arreglarlo. Podr铆a modificar toda la l贸gica de c谩lculo.</small>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="code-example" style="background: #d4edda; border-left: 4px solid #28a745; padding: 20px; height: 100%;">
                                    <strong style="color: #155724; font-size: 1.1rem;"> BUEN PROMPT:</strong><br>
                                    <p style="color: #333; font-weight: 600; margin: 10px 0;">"En <code>reportes_gerenciales.html</code>, modifica la funci贸n <code>calcularFacturacionPorEmpleado()</code> para que cuando una cita tenga m煤ltiples t茅cnicos asignados (seg煤n <code>ruteador</code>), divida el monto de la cita (<code>metadata.monto</code>) entre la cantidad de t茅cnicos antes de asignarlo a cada empleado. Actualmente est谩 sumando el monto completo para cada t茅cnico."</p>
                                    <small style="color: #155724;"><strong>Por qu茅 funciona:</strong> Espec铆fico: archivo, funci贸n exacta, problema concreto (suma vs divisi贸n), campos espec铆ficos, soluci贸n t茅cnica.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: 40px;"><i class="fas fa-lightbulb me-2"></i>Mejores Pr谩cticas para Escribir Prompts</h3>
                    <ol>
                        <li><strong>Siempre especifica el archivo:</strong> Menciona el nombre exacto del archivo que quieres modificar.</li>
                        <li><strong>Define el alcance:</strong> Indica claramente qu茅 parte del c贸digo debe cambiar y qu茅 debe permanecer igual.</li>
                        <li><strong>S茅 espec铆fico:</strong> En lugar de "mejorar", di exactamente qu茅 quieres: "cambiar color a #28a745", "agregar validaci贸n de email", etc.</li>
                        <li><strong>Menciona restricciones:</strong> Si no quieres que algo cambie, dilo expl铆citamente: "sin modificar otras secciones", "solo en esta funci贸n".</li>
                        <li><strong>Usa ejemplos:</strong> Si es posible, menciona c贸mo deber铆a verse o comportarse el resultado.</li>
                        <li><strong>Revisa antes de ejecutar:</strong> Siempre revisa los cambios que Cursor AI propone antes de aceptarlos.</li>
                        <li><strong>Haz cambios peque帽os:</strong> Es mejor hacer varios prompts peque帽os y espec铆ficos que uno grande y vago.</li>
                    </ol>

                    <!-- Quiz 1: Fundamentos de Prompts -->
                    <div class="quiz-container" data-quiz-id="prompts-fundamentos">
                        <h3><i class="fas fa-comments me-2"></i> Reto 1: Fundamentos de Prompts</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Cu谩l es la caracter铆stica m谩s importante de un buen prompt?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-fundamentos-q1" value="a"> Que sea corto y simple</label>
                                    <label><input type="radio" name="prompts-fundamentos-q1" value="b"> Que sea espec铆fico, mencionando el archivo y el cambio exacto</label>
                                    <label><input type="radio" name="prompts-fundamentos-q1" value="c"> Que use palabras t茅cnicas complejas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Qu茅 problema tiene el prompt "Mejora el dise帽o de todos los botones"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-fundamentos-q2" value="a"> Es demasiado espec铆fico</label>
                                    <label><input type="radio" name="prompts-fundamentos-q2" value="b"> Es demasiado amplio y vago, afectar铆a todos los botones sin especificar c贸mo mejorarlos</label>
                                    <label><input type="radio" name="prompts-fundamentos-q2" value="c"> No tiene problemas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Cu谩l es un ejemplo de buen prompt?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-fundamentos-q3" value="a"> "Arregla el calendario"</label>
                                    <label><input type="radio" name="prompts-fundamentos-q3" value="b"> "En calendario.html, agrega un bot贸n 'Exportar' en la secci贸n de filtros que exporte las citas del d铆a seleccionado"</label>
                                    <label><input type="radio" name="prompts-fundamentos-q3" value="c"> "Mejora todo"</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Qu茅 debe incluir un buen prompt para ser efectivo?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-fundamentos-q4" value="a"> Solo el nombre del archivo</label>
                                    <label><input type="radio" name="prompts-fundamentos-q4" value="b"> Archivo espec铆fico, funci贸n o elemento exacto, cambio concreto, y restricciones si aplican</label>
                                    <label><input type="radio" name="prompts-fundamentos-q4" value="c"> Solo una descripci贸n general</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Por qu茅 es problem谩tico el prompt "Agrega validaciones"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-fundamentos-q5" value="a"> No especifica qu茅 validar, d贸nde, ni qu茅 tipo de validaci贸n</label>
                                    <label><input type="radio" name="prompts-fundamentos-q5" value="b"> Es demasiado espec铆fico</label>
                                    <label><input type="radio" name="prompts-fundamentos-q5" value="c"> No tiene problemas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 debes hacer antes de ejecutar cambios propuestos por Cursor AI?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-fundamentos-q6" value="a"> Ejecutarlos inmediatamente sin revisar</label>
                                    <label><input type="radio" name="prompts-fundamentos-q6" value="b"> Revisar los cambios propuestos para asegurarte de que solo modifican lo que quieres</label>
                                    <label><input type="radio" name="prompts-fundamentos-q6" value="c"> Confiar ciegamente en Cursor AI</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('prompts-fundamentos')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-prompts-fundamentos"></div>
                    </div>

                    <!-- Quiz 2: Casos de Estudio -->
                    <div class="quiz-container" data-quiz-id="prompts-casos">
                        <h3><i class="fas fa-bug me-2"></i> Reto 2: Casos de Estudio y Diagn贸stico</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. Si encuentras el error "Cannot read property 'addDoc' of undefined" en la consola, 驴qu茅 debes hacer primero?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-casos-q1" value="a"> Pedir a Cursor AI que arregle todo el calendario</label>
                                    <label><input type="radio" name="prompts-casos-q1" value="b"> Revisar el archivo mencionado en el error, identificar la funci贸n y verificar que la importaci贸n de addDoc est茅 correcta</label>
                                    <label><input type="radio" name="prompts-casos-q1" value="c"> Ignorar el error</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. Si el stock aparece negativo en el inventario, 驴cu谩l ser铆a un buen prompt para diagnosticar y resolver?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-casos-q2" value="a"> "Arregla el stock negativo"</label>
                                    <label><input type="radio" name="prompts-casos-q2" value="b"> "En operario_bodega.js, revisa la funci贸n guardarGasto() y verifica que llame a actualizarStockBodega() para decrementar el stock en la bodega origen despu茅s de crear el movimiento"</label>
                                    <label><input type="radio" name="prompts-casos-q2" value="c"> "Elimina todas las transacciones con stock negativo"</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. Si aparece "FirebaseError: Missing or insufficient permissions", 驴qu茅 debes revisar?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-casos-q3" value="a"> Solo el c贸digo JavaScript</label>
                                    <label><input type="radio" name="prompts-casos-q3" value="b"> Las reglas de seguridad en firestore.rules para la colecci贸n espec铆fica mencionada en el error</label>
                                    <label><input type="radio" name="prompts-casos-q3" value="c"> Eliminar todas las reglas de seguridad</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. Si un reporte muestra montos duplicados cuando hay m煤ltiples t茅cnicos, 驴cu谩l ser铆a un buen prompt?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-casos-q4" value="a"> "Arregla los montos del reporte"</label>
                                    <label><input type="radio" name="prompts-casos-q4" value="b"> "En reportes_gerenciales.html, modifica calcularFacturacionPorEmpleado() para dividir metadata.monto entre la cantidad de t茅cnicos asignados antes de asignarlo a cada empleado"</label>
                                    <label><input type="radio" name="prompts-casos-q4" value="c"> "Elimina el reporte y cr茅alo de nuevo"</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Cu谩l es el orden correcto para diagnosticar un problema?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-casos-q5" value="a"> Revisar consola  Identificar archivo y funci贸n  Verificar c贸digo  Probar soluci贸n</label>
                                    <label><input type="radio" name="prompts-casos-q5" value="b"> Pedir a Cursor AI que arregle todo</label>
                                    <label><input type="radio" name="prompts-casos-q5" value="c"> Eliminar el archivo problem谩tico</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. Si una p谩gina se queda cargando indefinidamente, 驴qu茅 informaci贸n es m谩s 煤til para crear un buen prompt?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-casos-q6" value="a"> Solo decir "la p谩gina no carga"</label>
                                    <label><input type="radio" name="prompts-casos-q6" value="b"> El error espec铆fico de la consola, el archivo donde ocurre, la funci贸n involucrada y qu茅 estaba intentando hacer el usuario</label>
                                    <label><input type="radio" name="prompts-casos-q6" value="c"> Pedir que se recargue todo el sitio</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('prompts-casos')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-prompts-casos"></div>
                    </div>

                    <!-- Quiz 3: Prompts Peligrosos -->
                    <div class="quiz-container" data-quiz-id="prompts-peligrosos">
                        <h3><i class="fas fa-skull me-2"></i> Reto 3: Prompts Peligrosos y Seguridad</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Por qu茅 es peligroso el prompt "Elimina toda la base de datos"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-peligrosos-q1" value="a"> No es peligroso, es seguro</label>
                                    <label><input type="radio" name="prompts-peligrosos-q1" value="b"> Eliminar铆a TODOS los datos de Firestore (citas, empleados, inventario) de forma irreversible sin respaldo</label>
                                    <label><input type="radio" name="prompts-peligrosos-q1" value="c"> Solo eliminar铆a datos temporales</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Por qu茅 es peligroso "Elimina todas las reglas de seguridad de Firestore"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-peligrosos-q2" value="a"> No es peligroso</label>
                                    <label><input type="radio" name="prompts-peligrosos-q2" value="b"> Dejar铆a la base de datos sin protecci贸n, permitiendo acceso no autorizado y modificaciones maliciosas</label>
                                    <label><input type="radio" name="prompts-peligrosos-q2" value="c"> Solo afectar铆a el dise帽o</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 pasar铆a si usas el prompt "Cambia todas las consultas a Firestore para que eliminen datos en lugar de leerlos"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-peligrosos-q3" value="a"> Mejorar铆a el rendimiento</label>
                                    <label><input type="radio" name="prompts-peligrosos-q3" value="b"> Transformar铆a todas las lecturas en eliminaciones, borrando datos masivamente cada vez que se carga una p谩gina</label>
                                    <label><input type="radio" name="prompts-peligrosos-q3" value="c"> No pasar铆a nada</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Por qu茅 es peligroso "Elimina todas las transacciones de inventario"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-peligrosos-q4" value="a"> No es peligroso</label>
                                    <label><input type="radio" name="prompts-peligrosos-q4" value="b"> Borrar铆a el historial completo de movimientos, haciendo imposible rastrear cambios y recalcular saldos</label>
                                    <label><input type="radio" name="prompts-peligrosos-q4" value="c"> Solo afectar铆a el dise帽o</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Qu茅 debes hacer ANTES de usar un prompt que podr铆a ser peligroso?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-peligrosos-q5" value="a"> Ejecutarlo inmediatamente</label>
                                    <label><input type="radio" name="prompts-peligrosos-q5" value="b"> Crear un respaldo completo, entender completamente las consecuencias, y tener un plan de recuperaci贸n</label>
                                    <label><input type="radio" name="prompts-peligrosos-q5" value="c"> Confiar en que Cursor AI no har谩 da帽o</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Cu谩l de estos prompts es MS peligroso?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-peligrosos-q6" value="a"> "En calendario.html, cambia el color del bot贸n a verde"</label>
                                    <label><input type="radio" name="prompts-peligrosos-q6" value="b"> "Elimina todas las colecciones de Firestore"</label>
                                    <label><input type="radio" name="prompts-peligrosos-q6" value="c"> "Agrega un tooltip a los productos"</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('prompts-peligrosos')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-prompts-peligrosos"></div>
                    </div>

                    <!-- Quiz: Buenos y Malos Prompts (Original - General) -->
                    <div class="quiz-container" data-quiz-id="prompts">
                        <h3><i class="fas fa-comments me-2"></i> Reto: Maestro de Prompts (General)</h3>
                        <div class="quiz-questions">
                            <div class="quiz-question">
                                <p><strong>1. 驴Cu谩l es la caracter铆stica m谩s importante de un buen prompt?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-q1" value="a"> Que sea corto y simple</label>
                                    <label><input type="radio" name="prompts-q1" value="b"> Que sea espec铆fico, mencionando el archivo y el cambio exacto</label>
                                    <label><input type="radio" name="prompts-q1" value="c"> Que use palabras t茅cnicas complejas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>2. 驴Por qu茅 es peligroso el prompt "Elimina toda la base de datos"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-q2" value="a"> No es peligroso, es seguro</label>
                                    <label><input type="radio" name="prompts-q2" value="b"> Eliminar铆a TODOS los datos de Firestore (citas, empleados, inventario) de forma irreversible sin respaldo</label>
                                    <label><input type="radio" name="prompts-q2" value="c"> Solo eliminar铆a datos temporales</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>3. 驴Qu茅 problema tiene el prompt "Mejora el dise帽o de todos los botones"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-q3" value="a"> Es demasiado espec铆fico</label>
                                    <label><input type="radio" name="prompts-q3" value="b"> Es demasiado amplio y vago, afectar铆a todos los botones sin especificar c贸mo mejorarlos</label>
                                    <label><input type="radio" name="prompts-q3" value="c"> No tiene problemas</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>4. 驴Cu谩l es un ejemplo de buen prompt?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-q4" value="a"> "Arregla el calendario"</label>
                                    <label><input type="radio" name="prompts-q4" value="b"> "En calendario.html, agrega un bot贸n 'Exportar' en la secci贸n de filtros que exporte las citas del d铆a seleccionado"</label>
                                    <label><input type="radio" name="prompts-q4" value="c"> "Mejora todo"</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>5. 驴Por qu茅 es peligroso "Elimina todas las reglas de seguridad de Firestore"?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-q5" value="a"> No es peligroso</label>
                                    <label><input type="radio" name="prompts-q5" value="b"> Dejar铆a la base de datos sin protecci贸n, permitiendo acceso no autorizado y modificaciones maliciosas</label>
                                    <label><input type="radio" name="prompts-q5" value="c"> Solo afectar铆a el dise帽o</label>
                                </div>
                            </div>
                            <div class="quiz-question">
                                <p><strong>6. 驴Qu茅 debes hacer antes de ejecutar cambios propuestos por Cursor AI?</strong></p>
                                <div class="quiz-options">
                                    <label><input type="radio" name="prompts-q6" value="a"> Ejecutarlos inmediatamente sin revisar</label>
                                    <label><input type="radio" name="prompts-q6" value="b"> Revisar los cambios propuestos para asegurarte de que solo modifican lo que quieres</label>
                                    <label><input type="radio" name="prompts-q6" value="c"> Confiar ciegamente en Cursor AI</label>
                                </div>
                            </div>
                        </div>
                        <button class="btn-reto mt-3" onclick="enviarQuiz('prompts')"> Completar Reto</button>
                        <div class="quiz-result" id="quiz-result-prompts"></div>
                    </div>
                </div>

                <!-- Secci贸n: Recuperaci贸n de Emergencia -->
                <div id="recuperacion-emergencia" class="content-section">
                    <h2><i class="fas fa-ambulance me-2"></i>Recuperaci贸n de Emergencia</h2>
                    
                    <div class="warning-box" style="border-left: 5px solid #dc3545;">
                        <h4><i class="fas fa-exclamation-triangle me-2"></i>锔 Situaci贸n de Emergencia</h4>
                        <p>Esta secci贸n es para cuando algo <strong>muy grave</strong> ha fallado y necesitas <strong>revertir todo el sistema</strong> (sitio web y base de datos) a una versi贸n anterior que funcionaba correctamente.</p>
                        <p><strong>sala solo si:</strong></p>
                        <ul>
                            <li>El sitio no funciona en absoluto</li>
                            <li>Se perdieron datos importantes</li>
                            <li>Se hizo un cambio que rompi贸 todo</li>
                            <li>Hay un error cr铆tico que no se puede arreglar f谩cilmente</li>
                        </ul>
                    </div>

                    <h3><i class="fas fa-info-circle me-2"></i>驴Qu茅 es un Rollback?</h3>
                    <p>Un <strong>rollback</strong> (o "reversi贸n") es volver el sistema a un estado anterior que funcionaba. Es como deshacer cambios en un documento, pero para todo el sitio web y la base de datos.</p>

                    <div class="info-box">
                        <h4><i class="fas fa-lightbulb me-2"></i>Importante</h4>
                        <p>Firebase guarda <strong>snapshots</strong> (copias) autom谩ticamente. Podemos usar estos snapshots para restaurar el sistema a un punto anterior en el tiempo.</p>
                    </div>

                    <h3><i class="fas fa-list-ol me-2"></i>Proceso Completo de Recuperaci贸n</h3>
                    
                    <div class="diagram-container">
                        <h4>Pasos del Proceso</h4>
                        <div class="diagram" style="flex-direction: column; align-items: center;">
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">1</span>
                                <strong>Identificar el Problema</strong><br>
                                <small>驴Qu茅 fall贸 exactamente?</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">2</span>
                                <strong>Buscar Snapshot Anterior</strong><br>
                                <small>En Firebase Console</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">3</span>
                                <strong>Restaurar Firestore</strong><br>
                                <small>Base de datos primero</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">4</span>
                                <strong>Restaurar Hosting</strong><br>
                                <small>Sitio web despu茅s</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">5</span>
                                <strong>Sincronizar Cursor AI</strong><br>
                                <small>Usar versi贸n restaurada</small>
                            </div>
                            <div class="diagram-arrow"><i class="fas fa-arrow-down"></i></div>
                            <div class="diagram-box primary" style="width: 80%; margin: 10px 0;">
                                <span class="step-number">6</span>
                                <strong>Verificar</strong><br>
                                <small>Todo funcionando</small>
                            </div>
                        </div>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-database me-2"></i>Paso 1: Restaurar Firestore (Base de Datos)</h3>
                    
                    <div class="warning-box">
                        <h4><i class="fas fa-exclamation-triangle me-2"></i>Advertencia</h4>
                        <p><strong>Restaurar Firestore eliminar谩 todos los datos actuales</strong> y los reemplazar谩 con los datos del snapshot. Aseg煤rate de que realmente necesitas hacer esto.</p>
                    </div>

                    <h4>Paso 1.1: Acceder a Firebase Console</h4>
                    <ol>
                        <li><strong>Abre tu navegador</strong> y ve a: <a href="https://console.firebase.google.com" target="_blank">https://console.firebase.google.com</a></li>
                        <li><strong>Inicia sesi贸n</strong> con tu cuenta de Google</li>
                        <li><strong>Selecciona el proyecto:</strong> <code>cursorwebapp-f376d</code></li>
                    </ol>

                    <h4>Paso 1.2: Ir a Firestore Database</h4>
                    <ol>
                        <li>En el men煤 lateral izquierdo, <strong>haz clic en "Firestore Database"</strong></li>
                        <li>Ver谩s la lista de colecciones y documentos</li>
                    </ol>

                    <h4>Paso 1.3: Acceder a Snapshots</h4>
                    <ol>
                        <li>En la parte superior de la p谩gina de Firestore, <strong>busca el men煤 "..." (tres puntos)</strong> o el bot贸n de configuraci贸n</li>
                        <li><strong>Haz clic en "Backups"</strong> o "Snapshots" (puede estar en "Settings" o "Configuraci贸n")</li>
                        <li>Ver谩s una lista de <strong>snapshots autom谩ticos</strong> que Firebase ha creado</li>
                    </ol>

                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>Nota</h4>
                        <p>Firebase crea snapshots autom谩ticamente, pero <strong>solo si tienes habilitado el plan Blaze (pago)</strong>. Si est谩s en el plan Spark (gratis), es posible que no tengas snapshots autom谩ticos.</p>
                        <p>En ese caso, tendr谩s que restaurar manualmente desde una copia de seguridad que hayas hecho previamente, o contactar con soporte.</p>
                    </div>

                    <h4>Paso 1.4: Seleccionar Snapshot a Restaurar</h4>
                    <ol>
                        <li><strong>Revisa la lista de snapshots</strong> disponibles</li>
                        <li>Ver谩s la <strong>fecha y hora</strong> de cada snapshot</li>
                        <li><strong>Selecciona el snapshot</strong> de <strong>antes</strong> de que ocurriera el problema</li>
                        <li><strong>Ejemplo:</strong> Si el problema ocurri贸 el 15 de enero a las 2 PM, selecciona un snapshot del 15 de enero antes de las 2 PM, o del 14 de enero</li>
                    </ol>

                    <h4>Paso 1.5: Restaurar el Snapshot</h4>
                    <ol>
                        <li><strong>Haz clic en el snapshot</strong> seleccionado</li>
                        <li><strong>Haz clic en "Restore"</strong> o "Restaurar"</li>
                        <li><strong>Confirma la acci贸n:</strong> Firebase te pedir谩 confirmaci贸n porque esto eliminar谩 datos actuales</li>
                        <li><strong>Espera a que termine:</strong> Puede tardar varios minutos dependiendo del tama帽o de la base de datos</li>
                    </ol>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i> Firestore Restaurado</h4>
                        <p>Una vez que termine, tu base de datos estar谩 en el estado del snapshot seleccionado.</p>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-globe me-2"></i>Paso 2: Restaurar Firebase Hosting (Sitio Web)</h3>
                    
                    <h4>Paso 2.1: Ir a Firebase Hosting</h4>
                    <ol>
                        <li>En Firebase Console, en el men煤 lateral, <strong>haz clic en "Hosting"</strong></li>
                        <li>Ver谩s la lista de <strong>deployments</strong> (versiones desplegadas) del sitio</li>
                    </ol>

                    <h4>Paso 2.2: Ver Historial de Deployments</h4>
                    <ol>
                        <li>En la p谩gina de Hosting, <strong>busca la secci贸n "Deploy history"</strong> o "Historial de despliegues"</li>
                        <li>Ver谩s una lista de todas las versiones que se han desplegado, con:</li>
                        <ul>
                            <li><strong>Fecha y hora</strong> del despliegue</li>
                            <li><strong>Usuario</strong> que hizo el despliegue</li>
                            <li><strong>Versi贸n</strong> o ID del deployment</li>
                        </ul>
                    </ol>

                    <h4>Paso 2.3: Seleccionar Versi贸n Anterior</h4>
                    <ol>
                        <li><strong>Revisa la lista</strong> de deployments</li>
                        <li><strong>Identifica la versi贸n</strong> que funcionaba correctamente (antes del problema)</li>
                        <li><strong>Ejemplo:</strong> Si desplegaste algo malo a las 3 PM, busca un deployment de antes de las 3 PM</li>
                    </ol>

                    <h4>Paso 2.4: Restaurar la Versi贸n</h4>
                    <ol>
                        <li><strong>Haz clic en el deployment</strong> que quieres restaurar</li>
                        <li><strong>Busca el bot贸n "Rollback"</strong> o "Revertir" (puede estar en un men煤 de tres puntos)</li>
                        <li><strong>Haz clic en "Rollback"</strong></li>
                        <li><strong>Confirma:</strong> Firebase te pedir谩 confirmaci贸n</li>
                        <li><strong>Espera:</strong> El rollback suele ser r谩pido (1-2 minutos)</li>
                    </ol>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i> Hosting Restaurado</h4>
                        <p>Una vez que termine, tu sitio web estar谩 en la versi贸n seleccionada.</p>
                    </div>

                    <div class="info-box">
                        <h4><i class="fas fa-lightbulb me-2"></i>Alternativa: Rollback desde Terminal</h4>
                        <p>Tambi茅n puedes hacer rollback desde la terminal si tienes acceso:</p>
                        <div class="code-example">
# Listar deployments
firebase hosting:channel:list

# Ver detalles de un deployment espec铆fico
firebase hosting:channel:open [CHANNEL_ID]

# Nota: Para rollback completo, es m谩s f谩cil usar la consola web
                        </div>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-code me-2"></i>Paso 3: Sincronizar Cursor AI con la Versi贸n Restaurada</h3>
                    
                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>驴Por qu茅 hacer esto?</h4>
                        <p>Despu茅s de restaurar el sitio en Firebase, los archivos en tu computadora (Cursor AI) pueden estar <strong>desactualizados</strong> o tener cambios que causaron el problema. Necesitas <strong>descargar la versi贸n restaurada</strong> y usarla como la versi贸n correcta.</p>
                    </div>

                    <h4>Paso 3.1: Abrir Cursor AI</h4>
                    <ol>
                        <li><strong>Abre Cursor AI</strong> en tu computadora</li>
                        <li><strong>Abre el proyecto</strong> (carpeta <code>cursorai</code>)</li>
                    </ol>

                    <h4>Paso 3.2: Abrir Terminal en Cursor AI</h4>
                    <ol>
                        <li>En Cursor AI, <strong>ve al men煤 "Terminal"</strong>  "New Terminal"</li>
                        <li>O usa el atajo: <code>Ctrl + `</code> (Windows/Linux) o <code>Cmd + `</code> (Mac)</li>
                        <li>Se abrir谩 una terminal en la parte inferior</li>
                    </ol>

                    <h4>Paso 3.3: Verificar que est谩s en el proyecto correcto</h4>
                    <ol>
                        <li>En la terminal, <strong>verifica que est谩s en la carpeta correcta</strong>:</li>
                        <div class="code-example">
pwd
                        </div>
                        <li>Deber铆a mostrar algo como: <code>/Users/tuusuario/Documents/cursorai</code></li>
                        <li>Si no est谩s ah铆, <strong>navega al proyecto</strong>:</li>
                        <div class="code-example">
cd /ruta/a/tu/proyecto/cursorai
                        </div>
                    </ol>

                    <h4>Paso 3.4: Usar Cursor AI para Sincronizar (M茅todo Recomendado)</h4>
                    <p>La forma m谩s f谩cil y segura es <strong>pedirle directamente a Cursor AI</strong> que descargue y sincronice los archivos con la versi贸n restaurada en Firebase.</p>
                    
                    <ol>
                        <li>En Cursor AI, <strong>abre el chat</strong> (<code>Ctrl + L</code> o <code>Cmd + L</code> en Mac)</li>
                        <li><strong>Escribe este mensaje exacto:</strong></li>
                        <div class="code-example" style="background: #fff3cd; padding: 15px; border-radius: 5px; margin: 10px 0;">
Necesito que descargues la versi贸n actual del sitio que est谩 desplegada en Firebase Hosting y la uses como la versi贸n correcta. El sitio est谩 en https://ecoplagas.online y acabo de restaurar una versi贸n anterior desde Firebase Console. Necesito que todos los archivos en la carpeta public/ coincidan exactamente con lo que est谩 publicado actualmente en Firebase Hosting. Descarga cada archivo HTML, JS y CSS del sitio y reemplaza los archivos locales con esa versi贸n.
                        </div>
                        <li><strong>Cursor AI te ayudar谩</strong> a descargar y sincronizar los archivos autom谩ticamente</li>
                        <li><strong>Espera a que termine:</strong> Cursor AI descargar谩 los archivos del sitio web y los guardar谩 en tu proyecto</li>
                    </ol>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i>Ventajas de este M茅todo</h4>
                        <ul>
                            <li> Autom谩tico y r谩pido</li>
                            <li> Descarga todos los archivos necesarios</li>
                            <li> Sincroniza exactamente con lo que est谩 en Firebase</li>
                            <li> No necesitas saber comandos complicados</li>
                        </ul>
                    </div>

                    <h4>Paso 3.5: M茅todo Alternativo - Descargar Manualmente desde el Sitio</h4>
                    <p>Si por alguna raz贸n Cursor AI no puede hacerlo autom谩ticamente, puedes descargar manualmente:</p>
                    
                    <ol>
                        <li><strong>Abre el sitio restaurado</strong> en el navegador: <a href="https://ecoplagas.online" target="_blank">https://ecoplagas.online</a></li>
                        <li><strong>Para cada archivo HTML principal:</strong>
                            <ul>
                                <li>Ve a la URL del archivo (ej: <code>https://ecoplagas.online/calendario.html</code>)</li>
                                <li>Click derecho  "Ver c贸digo fuente" o presiona <code>Ctrl + U</code> (Windows/Linux) / <code>Cmd + Option + U</code> (Mac)</li>
                                <li><strong>Copia todo el c贸digo</strong> (Ctrl + A, Ctrl + C)</li>
                                <li>En Cursor AI, <strong>abre el archivo correspondiente</strong> (ej: <code>public/calendario.html</code>)</li>
                                <li><strong>Reemplaza todo el contenido</strong> con lo que copiaste</li>
                                <li><strong>Guarda</strong> (Ctrl + S o Cmd + S)</li>
                            </ul>
                        </li>
                        <li><strong>Repite para todos los archivos principales:</strong>
                            <ul>
                                <li><code>calendario.html</code></li>
                                <li><code>registro_horas.html</code></li>
                                <li><code>reportes_gerenciales.html</code></li>
                                <li><code>administrador_bodega.html</code></li>
                                <li>Y cualquier otro archivo que hayas modificado recientemente</li>
                            </ul>
                        </li>
                    </ol>

                    <div class="info-box">
                        <h4><i class="fas fa-lightbulb me-2"></i>Nota sobre Archivos JS y CSS</h4>
                        <p>Los archivos JavaScript (.js) y CSS pueden estar en l铆nea en el HTML o ser archivos separados. Si son archivos separados, puedes descargarlos directamente desde el navegador:</p>
                        <ul>
                            <li>Abre las <strong>Herramientas de Desarrollador</strong> (F12)</li>
                            <li>Ve a la pesta帽a <strong>"Network"</strong> o "Red"</li>
                            <li>Recarga la p谩gina</li>
                            <li>Busca los archivos .js y .css en la lista</li>
                            <li>Click derecho en el archivo  "Open in new tab" o "Abrir en nueva pesta帽a"</li>
                            <li>Copia el contenido y p茅galo en Cursor AI</li>
                        </ul>
                    </div>

                    <h4>Paso 3.6: Verificar que los Archivos Coinciden</h4>
                    <p>Despu茅s de que Cursor AI descargue los archivos, verifica que todo est谩 correcto:</p>

                    <ol>
                        <li><strong>Abre algunos archivos principales</strong> en Cursor AI (ej: <code>calendario.html</code>)</li>
                        <li><strong>Compara con el sitio web:</strong> Abre <a href="https://ecoplagas.online/calendario.html" target="_blank">https://ecoplagas.online/calendario.html</a></li>
                        <li><strong>Inspecciona el c贸digo fuente</strong> del sitio web (Click derecho  "Ver c贸digo fuente" o <code>Ctrl + U</code>)</li>
                        <li><strong>Verifica que coinciden</strong> los elementos principales (estructura HTML, nombres de funciones, etc.)</li>
                        <li><strong>Si hay diferencias:</strong> P铆dele a Cursor AI que descargue nuevamente o copia manualmente el contenido</li>
                    </ol>

                    <div class="success-box">
                        <h4><i class="fas fa-check-circle me-2"></i> Cursor AI Sincronizado</h4>
                        <p>Una vez que los archivos coincidan, Cursor AI est谩 usando la versi贸n correcta (la restaurada).</p>
                    </div>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-check-double me-2"></i>Paso 4: Verificar que Todo Funciona</h3>
                    
                    <h4>Paso 4.1: Verificar el Sitio Web</h4>
                    <ol>
                        <li><strong>Abre el sitio:</strong> <a href="https://ecoplagas.online" target="_blank">https://ecoplagas.online</a></li>
                        <li><strong>Prueba las funcionalidades principales:</strong></li>
                        <ul>
                            <li>Iniciar sesi贸n</li>
                            <li>Ver el calendario</li>
                            <li>Registrar horas</li>
                            <li>Ver inventario</li>
                        </ul>
                        <li><strong>Verifica que no hay errores</strong> en la consola del navegador (F12  Console)</li>
                    </ol>

                    <h4>Paso 4.2: Verificar la Base de Datos</h4>
                    <ol>
                        <li><strong>Ve a Firebase Console</strong>  Firestore Database</li>
                        <li><strong>Verifica que las colecciones principales</strong> tienen datos:</li>
                        <ul>
                            <li><code>citas</code></li>
                            <li><code>empleados</code></li>
                            <li><code>productos</code></li>
                            <li><code>bodegas</code></li>
                        </ul>
                        <li><strong>Verifica que los datos</strong> son los correctos (del snapshot restaurado)</li>
                    </ol>

                    <h4>Paso 4.3: Documentar lo que Pas贸</h4>
                    <ol>
                        <li><strong>Crea un documento</strong> o nota sobre:</li>
                        <ul>
                            <li>Qu茅 fall贸</li>
                            <li>Cu谩ndo ocurri贸</li>
                            <li>A qu茅 snapshot/versi贸n se restaur贸</li>
                            <li>Qu茅 cambios se perdieron (si los hay)</li>
                        </ul>
                        <li><strong>Esto ayudar谩</strong> a evitar el mismo problema en el futuro</li>
                    </ol>

                    <hr style="margin: 40px 0; border: 1px solid var(--border-color);">

                    <h3><i class="fas fa-shield-alt me-2"></i>Prevenci贸n: C贸mo Evitar Necesitar un Rollback</h3>
                    
                    <h4>Mejores Pr谩cticas:</h4>
                    <ul>
                        <li><strong>Probar antes de desplegar:</strong> Prueba los cambios localmente antes de hacer deploy</li>
                        <li><strong>Hacer backups manuales:</strong> Antes de cambios grandes, exporta datos importantes desde Firebase Console</li>
                        <li><strong>Revisar cambios:</strong> Revisa qu茅 archivos vas a cambiar antes de desplegar</li>
                        <li><strong>Hacer cambios peque帽os:</strong> En lugar de cambiar muchas cosas a la vez, haz cambios peque帽os y despliega frecuentemente</li>
                        <li><strong>Documentar cambios importantes:</strong> Anota qu茅 cambios hiciste y por qu茅</li>
                        <li><strong>Usar Cursor AI para revisar:</strong> Antes de desplegar, p铆dele a Cursor AI que revise los cambios</li>
                    </ul>

                    <h4>Comando para Backup Manual de Firestore:</h4>
                    <div class="code-example">
# Exportar datos de Firestore (requiere plan Blaze)
gcloud firestore export gs://[BUCKET_NAME]/[EXPORT_PREFIX]

# O desde Firebase Console:
# Firestore  Settings  Backup  Create Backup
                    </div>

                    <div class="info-box">
                        <h4><i class="fas fa-info-circle me-2"></i>Recordatorio</h4>
                        <p>Los snapshots autom谩ticos de Firestore <strong>solo est谩n disponibles en el plan Blaze (pago)</strong>. Si est谩s en el plan gratuito, considera hacer backups manuales peri贸dicos.</p>
                    </div>

                    <h3><i class="fas fa-life-ring me-2"></i>驴Necesitas Ayuda?</h3>
                    <p>Si algo no funciona durante el proceso de recuperaci贸n:</p>
                    <ol>
                        <li><strong>Revisa los logs</strong> en Firebase Console</li>
                        <li><strong>Pregunta a Cursor AI:</strong> "驴C贸mo hago rollback de Firebase Hosting?"</li>
                        <li><strong>Consulta la documentaci贸n:</strong> <a href="https://firebase.google.com/docs" target="_blank">https://firebase.google.com/docs</a></li>
                        <li><strong>Contacta soporte:</strong> Si es cr铆tico, contacta con el equipo t茅cnico</li>
                    </ol>
                </div>

                <!-- Secci贸n: FAQ -->
                <div id="faq" class="content-section">
                    <h2><i class="fas fa-question-circle me-2"></i>Preguntas Frecuentes</h2>
                    
                    <h3>驴Necesito saber programar?</h3>
                    <div class="info-box">
                        <p><strong>Respuesta corta:</strong> Ayuda entender lo b谩sico.</p>
                        <p><strong>Respuesta larga:</strong> Cursor AI hace mucho del trabajo. Puedes aprender mientras trabajas. Es como aprender a usar Excel: ayuda entender c贸mo funciona.</p>
                    </div>

                    <h3>驴Qu茅 pasa si rompo algo?</h3>
                    <div class="success-box">
                        <p><strong>No te preocupes:</strong></p>
                        <ul>
                            <li>Los cambios se pueden revertir</li>
                            <li>Siempre puedes pedir ayuda a Cursor AI</li>
                            <li>Hay versiones de respaldo (backups)</li>
                            <li>Puedes probar en tu computadora antes de publicar</li>
                        </ul>
                    </div>

                    <h3>驴C贸mo s茅 si mi cambio funcion贸?</h3>
                    <ol>
                        <li><strong>Despliega</strong> los cambios (<code>firebase deploy</code>)</li>
                        <li><strong>Abre</strong> el sitio web en tu navegador</li>
                        <li><strong>Prueba</strong> la funcionalidad que modificaste</li>
                        <li><strong>Revisa</strong> la consola del navegador (F12) si hay errores</li>
                    </ol>

                    <h3>驴Qu茅 es "desplegar" (deploy)?</h3>
                    <div class="info-box">
                        <p>Es como <strong>publicar</strong> tus cambios en internet. Cuando despliegas:</p>
                        <ul>
                            <li>Los cambios se suben a Firebase</li>
                            <li>Todos pueden ver los cambios en <code>ecoplagas.online</code></li>
                            <li>Es como actualizar una publicaci贸n en Facebook</li>
                        </ul>
                    </div>

                    <h3>驴C贸mo aprendo m谩s?</h3>
                    <ul>
                        <li><strong>Practica:</strong> Haz cambios peque帽os y ve qu茅 pasa</li>
                        <li><strong>Pregunta a Cursor AI:</strong> Es tu mejor amigo para aprender</li>
                        <li><strong>Lee el c贸digo:</strong> A veces entender c贸digo existente es la mejor forma de aprender</li>
                        <li><strong>Experimenta:</strong> Prueba cosas, no tengas miedo de equivocarte</li>
                    </ul>

                    <h3>驴Qu茅 hago si algo no funciona?</h3>
                    <ol>
                        <li><strong>Revisa la consola</strong> del navegador (F12  Console)</li>
                        <li><strong>Pregunta a Cursor AI:</strong> "驴Por qu茅 no funciona esto?"</li>
                        <li><strong>Revisa los logs:</strong> Firebase muestra errores</li>
                        <li><strong>Pide ayuda:</strong> No tengas miedo de preguntar</li>
                    </ol>
                </div>

                <!-- Secci贸n: Glosario -->
                <div id="glosario" class="content-section">
                    <h2><i class="fas fa-book me-2"></i>Glosario de T茅rminos</h2>
                    
                    <div class="info-box">
                        <p>Este glosario contiene <strong>todos los t茅rminos t茅cnicos</strong> que encontrar谩s al trabajar con el sitio. Est谩n organizados por categor铆as:</p>
                    </div>

                    <h3><i class="fas fa-code me-2"></i>T茅rminos de Programaci贸n y Desarrollo</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Archivo</h4>
                            <p>Un documento con c贸digo o contenido. Ejemplos: <code>calendario.html</code>, <code>auth-secure.js</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>C贸digo</h4>
                            <p>Instrucciones escritas en un lenguaje de programaci贸n que la computadora puede entender y ejecutar</p>
                        </div>
                        <div class="feature-card">
                            <h4>HTML</h4>
                            <p>Lenguaje de marcado para crear la estructura de p谩ginas web. Define qu茅 elementos hay (botones, tablas, texto)</p>
                        </div>
                        <div class="feature-card">
                            <h4>CSS</h4>
                            <p>Lenguaje para dar estilo a las p谩ginas web. Define colores, tama帽os, posiciones y dise帽o visual</p>
                        </div>
                        <div class="feature-card">
                            <h4>JavaScript</h4>
                            <p>Lenguaje de programaci贸n que hace que las p谩ginas web sean interactivas. Controla el comportamiento y la l贸gica</p>
                        </div>
                        <div class="feature-card">
                            <h4>Funci贸n</h4>
                            <p>Un bloque de c贸digo que realiza una tarea espec铆fica. Se puede reutilizar m煤ltiples veces</p>
                        </div>
                        <div class="feature-card">
                            <h4>Variable</h4>
                            <p>Un contenedor que guarda un valor (texto, n煤mero, objeto, etc.) que puede cambiar durante la ejecuci贸n</p>
                        </div>
                        <div class="feature-card">
                            <h4>Array</h4>
                            <p>Una lista ordenada de elementos. Ejemplo: <code>[1, 2, 3]</code> o <code>['cita1', 'cita2']</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>Objeto</h4>
                            <p>Una colecci贸n de datos relacionados agrupados. Ejemplo: <code>{nombre: 'Juan', edad: 30}</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>Proyecto</h4>
                            <p>Todo el conjunto de archivos del sitio web organizados en carpetas. En este caso: carpeta <code>cursorai</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>Terminal</h4>
                            <p>Interfaz de l铆nea de comandos para ejecutar instrucciones. Se usa para desplegar, instalar paquetes, etc.</p>
                        </div>
                        <div class="feature-card">
                            <h4>Deploy (Desplegar)</h4>
                            <p>Publicar cambios en internet para que todos puedan verlos. Sube archivos a Firebase Hosting</p>
                        </div>
                        <div class="feature-card">
                            <h4>Commit</h4>
                            <p>Guardar un conjunto de cambios en el historial del proyecto (si usas Git)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Bug</h4>
                            <p>Un error o problema en el c贸digo que hace que algo no funcione como deber铆a</p>
                        </div>
                        <div class="feature-card">
                            <h4>Debug</h4>
                            <p>Proceso de encontrar y corregir errores (bugs) en el c贸digo</p>
                        </div>
                        <div class="feature-card">
                            <h4>Console</h4>
                            <p>Herramienta del navegador (F12) donde se muestran mensajes, errores y logs del c贸digo</p>
                        </div>
                        <div class="feature-card">
                            <h4>API</h4>
                            <p>Interfaz de programaci贸n - conjunto de funciones y m茅todos que permiten comunicarse con un servicio</p>
                        </div>
                        <div class="feature-card">
                            <h4>Callback</h4>
                            <p>Una funci贸n que se ejecuta despu茅s de que otra funci贸n termina. Ejemplo: despu茅s de cargar datos</p>
                        </div>
                        <div class="feature-card">
                            <h4>Promise</h4>
                            <p>Un objeto que representa una operaci贸n que puede completarse en el futuro (茅xito o fallo)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Async/Await</h4>
                            <p>Forma moderna de manejar operaciones as铆ncronas (que tardan tiempo) de manera m谩s legible</p>
                        </div>
                    </div>

                    <h3><i class="fas fa-fire me-2"></i>T茅rminos de Firebase</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Firebase</h4>
                            <p>Plataforma de Google que proporciona servicios en la nube: base de datos, autenticaci贸n, hosting</p>
                        </div>
                        <div class="feature-card">
                            <h4>Firestore</h4>
                            <p>Base de datos NoSQL de Firebase. Guarda datos en formato de documentos y colecciones</p>
                        </div>
                        <div class="feature-card">
                            <h4>Colecci贸n (Collection)</h4>
                            <p>Grupo de documentos relacionados. Ejemplo: colecci贸n "citas" contiene todos los documentos de citas</p>
                        </div>
                        <div class="feature-card">
                            <h4>Documento (Document)</h4>
                            <p>Un registro individual dentro de una colecci贸n. Contiene campos con datos espec铆ficos</p>
                        </div>
                        <div class="feature-card">
                            <h4>Firebase Auth</h4>
                            <p>Sistema de autenticaci贸n de Firebase. Verifica qui茅n es el usuario y gestiona sesiones</p>
                        </div>
                        <div class="feature-card">
                            <h4>Firebase Hosting</h4>
                            <p>Servicio que aloja los archivos del sitio web (HTML, CSS, JS) y los sirve a los usuarios</p>
                        </div>
                        <div class="feature-card">
                            <h4>Firebase Console</h4>
                            <p>Interfaz web para gestionar el proyecto Firebase. Ver datos, configurar, etc.</p>
                        </div>
                        <div class="feature-card">
                            <h4>Timestamp</h4>
                            <p>Tipo de dato que representa una fecha y hora espec铆fica. Se usa para guardar fechas en Firestore</p>
                        </div>
                        <div class="feature-card">
                            <h4>onSnapshot</h4>
                            <p>M茅todo de Firestore que escucha cambios en tiempo real. Se ejecuta cada vez que hay cambios</p>
                        </div>
                        <div class="feature-card">
                            <h4>getDocs / getDoc</h4>
                            <p>M茅todos para leer datos de Firestore. getDocs lee m煤ltiples documentos, getDoc lee uno</p>
                        </div>
                        <div class="feature-card">
                            <h4>addDoc</h4>
                            <p>M茅todo para crear un nuevo documento en una colecci贸n de Firestore</p>
                        </div>
                        <div class="feature-card">
                            <h4>updateDoc</h4>
                            <p>M茅todo para actualizar campos de un documento existente en Firestore</p>
                        </div>
                        <div class="feature-card">
                            <h4>deleteDoc</h4>
                            <p>M茅todo para eliminar un documento de una colecci贸n en Firestore</p>
                        </div>
                        <div class="feature-card">
                            <h4>writeBatch</h4>
                            <p>Operaci贸n que permite hacer m煤ltiples cambios a la vez. Todos se aplican juntos o ninguno</p>
                        </div>
                        <div class="feature-card">
                            <h4>increment</h4>
                            <p>Operaci贸n at贸mica para aumentar o disminuir un n煤mero de forma segura (evita conflictos)</p>
                        </div>
                        <div class="feature-card">
                            <h4>serverTimestamp</h4>
                            <p>Funci贸n que genera una fecha/hora en el servidor (m谩s confiable que la hora del cliente)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Query</h4>
                            <p>Consulta a la base de datos. Permite filtrar, ordenar y limitar los resultados</p>
                        </div>
                        <div class="feature-card">
                            <h4>where</h4>
                            <p>Cl谩usula de consulta para filtrar documentos por condiciones (ej: where('estado', '==', 'activo'))</p>
                        </div>
                        <div class="feature-card">
                            <h4>orderBy</h4>
                            <p>Cl谩usula de consulta para ordenar resultados por un campo (ascendente o descendente)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Snapshot</h4>
                            <p>Una copia de seguridad de la base de datos en un momento espec铆fico. Se usa para restaurar datos</p>
                        </div>
                        <div class="feature-card">
                            <h4>Firestore Rules</h4>
                            <p>Reglas de seguridad que controlan qui茅n puede leer y escribir datos en Firestore</p>
                        </div>
                        <div class="feature-card">
                            <h4>JWT (JSON Web Token)</h4>
                            <p>Token de autenticaci贸n seguro que identifica al usuario. Se usa para mantener la sesi贸n</p>
                        </div>
                        <div class="feature-card">
                            <h4>UID</h4>
                            <p>User ID - Identificador 煤nico de un usuario en Firebase Auth</p>
                        </div>
                    </div>

                    <h3><i class="fas fa-cubes me-2"></i>T茅rminos del Sistema EcoPlagas</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>M贸dulo</h4>
                            <p>Una secci贸n o p谩gina del sistema con una funci贸n espec铆fica. Ejemplo: m贸dulo de Calendario, m贸dulo de Inventario</p>
                        </div>
                        <div class="feature-card">
                            <h4>Cita</h4>
                            <p>Un servicio agendado para un cliente. Contiene informaci贸n como fecha, hora, direcci贸n, monto</p>
                        </div>
                        <div class="feature-card">
                            <h4>Ruta</h4>
                            <p>Organizaci贸n de citas por veh铆culo/equipo. Hay 20 rutas (1-10 diurnas, 11-20 nocturnas)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Ruteador</h4>
                            <p>Colecci贸n que asigna t茅cnicos y veh铆culos a cada ruta en cada d铆a</p>
                        </div>
                        <div class="feature-card">
                            <h4>Work Session</h4>
                            <p>Sesi贸n de trabajo de un empleado. Registra entrada y salida, horas trabajadas</p>
                        </div>
                        <div class="feature-card">
                            <h4>D铆a Laborable</h4>
                            <p>Per铆odo de trabajo que va de 5:00 AM a 4:59 AM del d铆a siguiente (no es un d铆a calendario normal)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Jornada Diurna</h4>
                            <p>Turno de trabajo durante el d铆a: de 5:00 AM a 5:00 PM</p>
                        </div>
                        <div class="feature-card">
                            <h4>Jornada Nocturna</h4>
                            <p>Turno de trabajo durante la noche: de 5:00 PM a 5:00 AM del d铆a siguiente</p>
                        </div>
                        <div class="feature-card">
                            <h4>Bodega</h4>
                            <p>Almac茅n donde se guardan productos o herramientas. Puede ser principal, especial, o de herramientas</p>
                        </div>
                        <div class="feature-card">
                            <h4>Bodega Especial</h4>
                            <p>Bodega asignada a un empleado espec铆fico. El t茅cnico puede ver su inventario personal</p>
                        </div>
                        <div class="feature-card">
                            <h4>Stock</h4>
                            <p>Cantidad disponible de un producto o herramienta en una bodega espec铆fica</p>
                        </div>
                        <div class="feature-card">
                            <h4>Movimiento de Inventario</h4>
                            <p>Registro de cualquier cambio en el inventario: compra, gasto, transferencia, devoluci贸n</p>
                        </div>
                        <div class="feature-card">
                            <h4>Pedido Especial</h4>
                            <p>Asignaci贸n de productos/herramientas desde bodega principal a bodega especial de un empleado</p>
                        </div>
                        <div class="feature-card">
                            <h4>Liquidaci贸n</h4>
                            <p>Proceso de cerrar un pedido especial: marcar productos como gastados o devueltos</p>
                        </div>
                        <div class="feature-card">
                            <h4>Fecha Contable</h4>
                            <p>Fecha a la que pertenece una transacci贸n contablemente. Puede ser diferente a la fecha real</p>
                        </div>
                        <div class="feature-card">
                            <h4>Producto</h4>
                            <p>tem de inventario consumible (insumos). Se identifica con <code>productoId</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>Herramienta</h4>
                            <p>tem de inventario reutilizable (equipos). Se identifica con <code>herramientaId</code></p>
                        </div>
                        <div class="feature-card">
                            <h4>Cuenta de Gasto</h4>
                            <p>Categor铆a donde se registran productos consumidos (gastos operativos, mantenimiento, etc.)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Proveedor</h4>
                            <p>Empresa o persona de la cual se compran productos para el inventario</p>
                        </div>
                        <div class="feature-card">
                            <h4>Sucursal</h4>
                            <p>Direcci贸n o ubicaci贸n de un cliente. Un cliente puede tener m煤ltiples sucursales</p>
                        </div>
                        <div class="feature-card">
                            <h4>Encuesta</h4>
                            <p>Formulario de satisfacci贸n que se env铆a a clientes despu茅s de un servicio</p>
                        </div>
                        <div class="feature-card">
                            <h4>Rollback</h4>
                            <p>Revertir el sistema a una versi贸n anterior que funcionaba correctamente</p>
                        </div>
                    </div>

                    <h3><i class="fas fa-shield-alt me-2"></i>T茅rminos de Seguridad y Permisos</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Autenticaci贸n</h4>
                            <p>Proceso de verificar qui茅n es el usuario (login). Responde: "驴Qui茅n eres?"</p>
                        </div>
                        <div class="feature-card">
                            <h4>Autorizaci贸n</h4>
                            <p>Proceso de verificar qu茅 puede hacer el usuario. Responde: "驴Qu茅 puedes hacer?"</p>
                        </div>
                        <div class="feature-card">
                            <h4>Permiso</h4>
                            <p>Derecho de un usuario a acceder a un m贸dulo espec铆fico. Ejemplo: permiso "calendario"</p>
                        </div>
                        <div class="feature-card">
                            <h4>Sesi贸n</h4>
                            <p>Per铆odo de tiempo durante el cual un usuario est谩 autenticado y puede usar el sistema</p>
                        </div>
                        <div class="feature-card">
                            <h4>Token</h4>
                            <p>Credencial digital que identifica al usuario autenticado. Se usa para mantener la sesi贸n</p>
                        </div>
                        <div class="feature-card">
                            <h4>HTTPS</h4>
                            <p>Protocolo seguro para comunicaci贸n en internet. Encripta los datos que se env铆an</p>
                        </div>
                        <div class="feature-card">
                            <h4>Encriptaci贸n</h4>
                            <p>Proceso de codificar informaci贸n para que solo personas autorizadas puedan leerla</p>
                        </div>
                    </div>

                    <h3><i class="fas fa-tools me-2"></i>T茅rminos de Herramientas y Procesos</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4>Cursor AI</h4>
                            <p>Editor de c贸digo con inteligencia artificial integrada. Ayuda a escribir y entender c贸digo</p>
                        </div>
                        <div class="feature-card">
                            <h4>IDE</h4>
                            <p>Entorno de Desarrollo Integrado. Programa para escribir y editar c贸digo (ej: Cursor AI, VS Code)</p>
                        </div>
                        <div class="feature-card">
                            <h4>CLI</h4>
                            <p>Command Line Interface - Interfaz de l铆nea de comandos. Terminal para ejecutar comandos</p>
                        </div>
                        <div class="feature-card">
                            <h4>Firebase CLI</h4>
                            <p>Herramienta de l铆nea de comandos para gestionar proyectos Firebase desde la terminal</p>
                        </div>
                        <div class="feature-card">
                            <h4>NPM</h4>
                            <p>Node Package Manager - Gestor de paquetes para instalar herramientas y librer铆as de JavaScript</p>
                        </div>
                        <div class="feature-card">
                            <h4>Cache</h4>
                            <p>Almacenamiento temporal de datos para acceso r谩pido. Evita cargar datos repetidamente</p>
                        </div>
                        <div class="feature-card">
                            <h4>Lazy Loading</h4>
                            <p>Cargar datos solo cuando se necesitan, no todos al inicio. Mejora el rendimiento</p>
                        </div>
                        <div class="feature-card">
                            <h4>Debounce</h4>
                            <p>T茅cnica para esperar a que el usuario termine de escribir antes de ejecutar una acci贸n (b煤squedas)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Responsive Design</h4>
                            <p>Dise帽o que se adapta a diferentes tama帽os de pantalla (computadora, tablet, m贸vil)</p>
                        </div>
                        <div class="feature-card">
                            <h4>Paginaci贸n</h4>
                            <p>Dividir una lista grande en p谩ginas m谩s peque帽as para mejorar el rendimiento</p>
                        </div>
                    </div>
                </div>

                <!-- Consejos Finales -->
                <div class="content-section">
                    <h2><i class="fas fa-lightbulb me-2"></i>Consejos Finales</h2>
                    
                    <h3><i class="fas fa-check-circle me-2"></i>Buenas Pr谩cticas</h3>
                    <ul>
                        <li><strong>Guarda frecuentemente:</strong> <code>Ctrl + S</code> es tu amigo</li>
                        <li><strong>Prueba antes de publicar:</strong> Verifica que todo funcione</li>
                        <li><strong>Haz cambios peque帽os:</strong> Es m谩s f谩cil encontrar errores</li>
                        <li><strong>Comenta tu c贸digo:</strong> Explica qu茅 hace cada parte</li>
                        <li><strong>Pide ayuda:</strong> Cursor AI y tus compa帽eros est谩n para ayudarte</li>
                    </ul>

                    <h3><i class="fas fa-times-circle me-2"></i>Evita</h3>
                    <ul>
                        <li>No borres c贸digo sin entender qu茅 hace</li>
                        <li>No despliegues sin probar primero</li>
                        <li>No trabajes directamente en producci贸n sin respaldo</li>
                        <li>No ignores errores: Si algo no funciona, investiga por qu茅</li>
                    </ul>

                    <h3><i class="fas fa-rocket me-2"></i>Recursos tiles</h3>
                    <ul>
                        <li><strong>Cursor AI Chat:</strong> Tu asistente principal</li>
                        <li><strong>Documentaci贸n de Firebase:</strong> <a href="https://firebase.google.com/docs" target="_blank">https://firebase.google.com/docs</a></li>
                        <li><strong>Consola de Firebase:</strong> <a href="https://console.firebase.google.com" target="_blank">https://console.firebase.google.com</a></li>
                        <li><strong>Esta gu铆a:</strong> Gu谩rdala y cons煤ltala cuando la necesites</li>
                    </ul>

                    <div class="success-box">
                        <h4><i class="fas fa-heart me-2"></i>Mensaje Final</h4>
                        <p><strong>Recuerda:</strong> Todos empezamos desde cero. No tengas miedo de preguntar y de experimentar. 隆T煤 puedes hacerlo! </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bot贸n Volver Arriba -->
    <div class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </div>

    <script>
        // Navegaci贸n suave
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetElement = document.querySelector(targetId);
                
                if (targetElement) {
                    // Remover active de todos
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    // Agregar active al actual
                    this.classList.add('active');
                    
                    // Scroll suave
                    targetElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Detectar secci贸n activa al hacer scroll
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('.content-section');
            const navLinks = document.querySelectorAll('.nav-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });

            // Mostrar/ocultar bot贸n volver arriba
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        // Bot贸n volver arriba
        document.getElementById('backToTop').addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Funci贸n helper para obtener db de forma confiable
        async function obtenerDB() {
            // Intentar m煤ltiples formas de obtener db
            if (window.db) {
                return window.db;
            }
            
            // Esperar un poco para que auth-secure cargue
            await new Promise(resolve => setTimeout(resolve, 500));
            
            if (window.db) {
                return window.db;
            }
            
            // Si a煤n no est谩 disponible, intentar crear una nueva instancia
            try {
                const { initializeApp, getApp } = await import('https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js');
                const { getFirestore } = await import('https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js');
                
                const firebaseConfig = {
                    projectId: "cursorwebapp-f376d",
                    appId: "1:719990096116:web:07c1ff697e7655b2cd9ea1",
                    databaseURL: "https://cursorwebapp-f376d-default-rtdb.firebaseio.com",
                    storageBucket: "cursorwebapp-f376d.firebasestorage.app",
                    apiKey: "AIzaSyC-IQj0yHR8cELr-mw-v2xlnw6LlJYFUyk",
                    authDomain: "cursorwebapp-f376d.firebaseapp.com",
                    messagingSenderId: "719990096116",
                    measurementId: "G-DJXLKFR7CD"
                };
                
                let app;
                try {
                    app = initializeApp(firebaseConfig, 'quiz-app');
                } catch (e) {
                    // Si ya existe, obtener la app existente
                    app = getApp();
                }
                
                const db = getFirestore(app);
                window.db = db;
                return db;
            } catch (error) {
                console.error('Error creando instancia de Firestore:', error);
                throw new Error('No se pudo inicializar Firestore');
            }
        }

        // Sistema de Quizzes
        const QUIZ_ANSWERS = {
            firebase: {
                q1: 'b',
                q2: 'b',
                q3: 'a',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            cursor: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            modulos: {
                q1: 'c',
                q2: 'a',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'a'
            },
            arquitectura: {
                q1: 'b',
                q2: 'a',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            colecciones: {
                q1: 'a',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            seguridad: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            inventario: {
                q1: 'a',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            reportes: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'a',
                q5: 'b',
                q6: 'b'
            },
            encuestas: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            rutas: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            empezar: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            desarrollo: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            troubleshooting: {
                q1: 'b',
                q2: 'a',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            'ejemplos': {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            'casos-uso': {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'a',
                q6: 'b'
            },
            'flujos-trabajo': {
                q1: 'a',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            'prompts-fundamentos': {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'a',
                q6: 'b'
            },
            'prompts-casos': {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'a',
                q6: 'b'
            },
            'prompts-peligrosos': {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            },
            prompts: {
                q1: 'b',
                q2: 'b',
                q3: 'b',
                q4: 'b',
                q5: 'b',
                q6: 'b'
            }
        };

        // Funci贸n para verificar cooldown (3 minutos entre intentos)
        async function verificarCooldown(quizId) {
            const dbActual = await obtenerDB();
            if (!dbActual) {
                return { puedeIntentar: true, tiempoRestante: 0, tiempoRestanteSegundos: 0 };
            }

            const authMgr = window.secureAuthManager || window.authManager;
            if (!authMgr || !authMgr.isAuthenticated()) {
                return { puedeIntentar: true, tiempoRestante: 0, tiempoRestanteSegundos: 0 };
            }

            const user = authMgr.getCurrentUser();
            const username = user?.username || user?.email || 'unknown';

            try {
                const firestoreModule = await import('https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js');
                const { collection: col, query: q, where: w, getDocs: gd, orderBy: ob, limit: lim, Timestamp: ts } = firestoreModule;

                // Intentar consulta con 铆ndice compuesto primero
                try {
                    // Obtener el 煤ltimo intento de este quiz
                    // Nota: El orden de los where debe coincidir con el 铆ndice compuesto
                    const intentosQuery = q(
                        col(dbActual, 'quizzes_entrenamiento'),
                        w('quizId', '==', quizId),
                        w('username', '==', username),
                        ob('fecha', 'desc'),
                        lim(1)
                    );
                    
                    const intentosSnapshot = await gd(intentosQuery);
                    
                    if (intentosSnapshot.empty) {
                        return { puedeIntentar: true, tiempoRestante: 0, tiempoRestanteSegundos: 0 };
                    }

                    const ultimoIntento = intentosSnapshot.docs[0].data();
                    const fechaUltimoIntento = ultimoIntento.fecha?.toDate ? ultimoIntento.fecha.toDate() : new Date(ultimoIntento.fecha?.seconds * 1000);
                    const ahora = new Date();
                    const diferenciaMs = ahora - fechaUltimoIntento;
                    const diferenciaSegundos = Math.floor(diferenciaMs / 1000);
                    const cooldownSegundos = 3 * 60; // 3 minutos en segundos

                    if (diferenciaSegundos < cooldownSegundos) {
                        const tiempoRestanteSegundos = cooldownSegundos - diferenciaSegundos;
                        const tiempoRestanteMinutos = Math.ceil(tiempoRestanteSegundos / 60);
                        return { 
                            puedeIntentar: false, 
                            tiempoRestante: tiempoRestanteMinutos,
                            tiempoRestanteSegundos: tiempoRestanteSegundos,
                            fechaUltimoIntento: fechaUltimoIntento
                        };
                    }

                    return { puedeIntentar: true, tiempoRestante: 0, tiempoRestanteSegundos: 0 };
                } catch (indexError) {
                    // Si el 铆ndice no est谩 listo, usar consulta alternativa m谩s simple
                    if (indexError.code === 'failed-precondition' || indexError.message?.includes('index')) {
                        // No mostrar warning - la consulta alternativa funciona correctamente
                        // El 铆ndice se construir谩 autom谩ticamente en Firebase
                        
                        // Consulta alternativa: solo por username SIN orderBy (para evitar necesidad de 铆ndice)
                        // Obtener todos los intentos del usuario y procesar en memoria
                        const intentosQueryAlt = q(
                            col(dbActual, 'quizzes_entrenamiento'),
                            w('username', '==', username)
                            // Sin orderBy para evitar necesidad de 铆ndice adicional
                        );
                        
                        const intentosSnapshot = await gd(intentosQueryAlt);
                        
                        // Filtrar por quizId y ordenar por fecha en memoria
                        const intentosDelQuiz = [];
                        intentosSnapshot.forEach(doc => {
                            const data = doc.data();
                            if (data.quizId === quizId) {
                                intentosDelQuiz.push({
                                    ...data,
                                    fechaObj: data.fecha?.toDate ? data.fecha.toDate() : new Date(data.fecha?.seconds * 1000)
                                });
                            }
                        });
                        
                        if (intentosDelQuiz.length === 0) {
                            return { puedeIntentar: true, tiempoRestante: 0, tiempoRestanteSegundos: 0 };
                        }
                        
                        // Ordenar por fecha descendente en memoria
                        intentosDelQuiz.sort((a, b) => b.fechaObj - a.fechaObj);
                        
                        const ultimoIntento = intentosDelQuiz[0];
                        const fechaUltimoIntento = ultimoIntento.fechaObj;
                        const ahora = new Date();
                        const diferenciaMs = ahora - fechaUltimoIntento;
                        const diferenciaSegundos = Math.floor(diferenciaMs / 1000);
                        const cooldownSegundos = 3 * 60; // 3 minutos en segundos

                        if (diferenciaSegundos < cooldownSegundos) {
                            const tiempoRestanteSegundos = cooldownSegundos - diferenciaSegundos;
                            const tiempoRestanteMinutos = Math.ceil(tiempoRestanteSegundos / 60);
                            return { 
                                puedeIntentar: false, 
                                tiempoRestante: tiempoRestanteMinutos,
                                tiempoRestanteSegundos: tiempoRestanteSegundos,
                                fechaUltimoIntento: fechaUltimoIntento
                            };
                        }

                        return { puedeIntentar: true, tiempoRestante: 0, tiempoRestanteSegundos: 0 };
                    } else {
                        throw indexError; // Re-lanzar si es otro tipo de error
                    }
                }
            } catch (error) {
                console.error('Error verificando cooldown:', error);
                // En caso de error, permitir intentar (fail-open)
                return { puedeIntentar: true, tiempoRestante: 0, tiempoRestanteSegundos: 0 };
            }
        }

        // Mapa para rastrear qu茅 quizzes tienen un loop de actualizaci贸n activo
        const cooldownUpdateLoops = new Map();

        // Funci贸n para actualizar el estado visual del quiz durante cooldown
        async function actualizarEstadoCooldown(quizId, isRecursive = false) {
            const quizContainer = document.querySelector(`[data-quiz-id="${quizId}"]`);
            if (!quizContainer) return;

            // Si ya hay un loop activo para este quiz y no es una llamada recursiva, no hacer nada
            if (!isRecursive && cooldownUpdateLoops.has(quizId)) {
                return;
            }

            const cooldown = await verificarCooldown(quizId);
            const btnEnviar = quizContainer.querySelector('.btn-reto');
            const quizQuestions = quizContainer.querySelector('.quiz-questions');
            const inputs = quizContainer.querySelectorAll('input[type="radio"]');
            
            // Buscar o crear el mensaje de cooldown
            let cooldownMsg = quizContainer.querySelector('.cooldown-message');
            
            if (!cooldown.puedeIntentar) {
                // Marcar que hay un loop activo
                cooldownUpdateLoops.set(quizId, true);

                // Aplicar estilo de deshabilitado
                quizContainer.classList.add('quiz-cooldown-active');
                if (btnEnviar) {
                    btnEnviar.disabled = true;
                    btnEnviar.style.opacity = '0.5';
                    btnEnviar.style.cursor = 'not-allowed';
                }
                if (quizQuestions) {
                    quizQuestions.style.opacity = '0.5';
                    quizQuestions.style.pointerEvents = 'none';
                }
                inputs.forEach(input => {
                    input.disabled = true;
                });

                // Mostrar mensaje de cooldown
                if (!cooldownMsg) {
                    cooldownMsg = document.createElement('div');
                    cooldownMsg.className = 'cooldown-message';
                    cooldownMsg.style.cssText = `
                        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
                        color: white;
                        padding: 15px 20px;
                        border-radius: 10px;
                        margin: 15px 0;
                        text-align: center;
                        font-weight: 600;
                        box-shadow: 0 4px 12px rgba(255, 107, 107, 0.4);
                        border: 2px solid #ff4757;
                    `;
                    if (btnEnviar) {
                        btnEnviar.parentNode.insertBefore(cooldownMsg, btnEnviar);
                    } else {
                        quizContainer.appendChild(cooldownMsg);
                    }
                }

                // Calcular tiempo restante en formato MM:SS
                const minutos = Math.floor(cooldown.tiempoRestanteSegundos / 60);
                const segundos = cooldown.tiempoRestanteSegundos % 60;
                const tiempoFormato = `${minutos}:${segundos.toString().padStart(2, '0')}`;

                cooldownMsg.innerHTML = `
                    <div style="font-size: 1.1rem; margin-bottom: 8px;">
                        憋 Cooldown Activo
                    </div>
                    <div style="font-size: 1.3rem; font-weight: 700; margin: 10px 0;">
                        ${tiempoFormato}
                    </div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        Espera antes de intentar nuevamente este reto
                    </div>
                `;

                // Programar actualizaci贸n en 1 segundo (solo si a煤n hay cooldown)
                setTimeout(() => {
                    actualizarEstadoCooldown(quizId, true);
                }, 1000);
            } else {
                // Remover el flag de loop activo
                cooldownUpdateLoops.delete(quizId);

                // Remover estilo de deshabilitado
                quizContainer.classList.remove('quiz-cooldown-active');
                if (btnEnviar) {
                    btnEnviar.disabled = false;
                    btnEnviar.style.opacity = '1';
                    btnEnviar.style.cursor = 'pointer';
                }
                if (quizQuestions) {
                    quizQuestions.style.opacity = '1';
                    quizQuestions.style.pointerEvents = 'auto';
                }
                inputs.forEach(input => {
                    input.disabled = false;
                });

                // Remover mensaje de cooldown
                if (cooldownMsg) {
                    cooldownMsg.remove();
                }
            }
        }

        // Verificar cooldown de todos los quizzes al cargar la p谩gina
        async function verificarCooldownsIniciales() {
            const quizContainers = document.querySelectorAll('[data-quiz-id]');
            for (const container of quizContainers) {
                const quizId = container.getAttribute('data-quiz-id');
                if (quizId) {
                    await actualizarEstadoCooldown(quizId);
                }
            }
        }

        // Funci贸n para enviar quiz
        window.enviarQuiz = async function(quizId) {
            const quizContainer = document.querySelector(`[data-quiz-id="${quizId}"]`);
            const resultDiv = document.getElementById(`quiz-result-${quizId}`);
            
            if (!quizContainer) {
                console.error('Quiz container no encontrado');
                return;
            }

            // Verificar cooldown
            const cooldown = await verificarCooldown(quizId);
            if (!cooldown.puedeIntentar) {
                // Actualizar el estado visual
                await actualizarEstadoCooldown(quizId);
                resultDiv.className = 'quiz-result show error';
                const minutos = Math.floor(cooldown.tiempoRestanteSegundos / 60);
                const segundos = cooldown.tiempoRestanteSegundos % 60;
                const tiempoFormato = `${minutos}:${segundos.toString().padStart(2, '0')}`;
                resultDiv.innerHTML = `
                    <div style="font-size: 1.2rem; margin-bottom: 10px;">憋 Cooldown Activo</div>
                    <div style="margin-top: 10px;">
                        <strong>Tiempo restante: ${tiempoFormato}</strong>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.95rem; opacity: 0.9;">
                         Esto previene intentos repetidos. T贸mate tu tiempo para revisar el contenido.
                    </div>
                `;
                return;
            }

            // Obtener respuestas
            const questions = quizContainer.querySelectorAll('.quiz-question');
            let correctas = 0;
            let total = questions.length;
            const respuestas = {};

            questions.forEach((question, index) => {
                const questionNum = index + 1;
                const selected = question.querySelector('input[type="radio"]:checked');
                if (selected) {
                    const respuesta = selected.value;
                    respuestas[`q${questionNum}`] = respuesta;
                    
                    // Verificar si es correcta
                    if (QUIZ_ANSWERS[quizId] && QUIZ_ANSWERS[quizId][`q${questionNum}`] === respuesta) {
                        correctas++;
                    }
                }
            });

            // Verificar que todas las preguntas fueron respondidas
            const todasRespondidas = Array.from(questions).every(q => q.querySelector('input[type="radio"]:checked'));
            if (!todasRespondidas) {
                resultDiv.className = 'quiz-result show error';
                resultDiv.innerHTML = `<strong>锔 Reto Incompleto</strong><br>Debes responder todas las preguntas para completar el reto.`;
                return;
            }

            // Calcular porcentaje
            const porcentaje = Math.round((correctas / total) * 100);

            // Mostrar resultado (GAMING STYLE)
            resultDiv.className = 'quiz-result show';
            if (porcentaje === 100) {
                resultDiv.className += ' success';
                resultDiv.innerHTML = `
                    <div class="puntos-display"> 隆RETO COMPLETADO! </div>
                    <div style="margin-top: 15px;">
                        <span class="estrella">猸</span> <strong>PERFECTO: ${correctas}/${total}</strong> <span class="estrella">猸</span>
                    </div>
                    <div style="margin-top: 10px; font-size: 1rem;">
                        <span class="reto-badge"> 100%</span>
                        <span class="reto-badge"> Perfecto</span>
                        <span class="reto-badge"> Dominado</span>
                    </div>
                    <div style="margin-top: 15px; font-size: 0.9rem; opacity: 0.9;">
                        隆Has desbloqueado este reto! Puedes continuar con el siguiente desaf铆o.
                    </div>
                `;
            } else {
                resultDiv.className += ' error';
                resultDiv.innerHTML = `
                    <div style="font-size: 1.3rem; margin-bottom: 10px;"> Reto No Completado</div>
                    <div style="margin-top: 10px;">
                        <strong>Puntuaci贸n: ${correctas}/${total} (${porcentaje}%)</strong>
                    </div>
                    <div style="margin-top: 15px; font-size: 1rem;">
                        锔 Para completar este reto necesitas <strong>100% de aciertos</strong> en al menos un intento.
                    </div>
                    <div style="margin-top: 15px; font-size: 0.95rem; opacity: 0.9;">
                         Revisa el contenido y vuelve a intentarlo. 隆T煤 puedes! 
                    </div>
                `;
            }

            // Guardar en Firestore
            try {
                await guardarResultadoQuiz(quizId, porcentaje, correctas, total, respuestas);
                await actualizarProgreso();
            } catch (error) {
                console.error('Error guardando resultado:', error);
                resultDiv.innerHTML += '<br><small class="text-muted">Nota: No se pudo guardar el resultado. Intenta nuevamente.</small>';
            }
        };

        // Funci贸n para guardar resultado en Firestore (permite m煤ltiples intentos)
        async function guardarResultadoQuiz(quizId, porcentaje, correctas, total, respuestas) {
            const dbActual = await obtenerDB();
            if (!dbActual) {
                throw new Error('Firestore no disponible');
            }

            const authMgr = window.secureAuthManager || window.authManager;
            if (!authMgr || !authMgr.isAuthenticated()) {
                throw new Error('Usuario no autenticado');
            }

            // Importar funciones de Firestore si no est谩n disponibles
            const firestoreModule = await import('https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js');
            const { 
                collection: col, 
                query: q, 
                where: w, 
                getDocs: gd, 
                addDoc: ad, 
                serverTimestamp: st 
            } = firestoreModule;

            const user = authMgr.getCurrentUser();
            const username = user?.username || user?.email || 'unknown';

            // Guardar cada intento como un documento separado
            const datosQuiz = {
                username: username,
                quizId: quizId,
                porcentaje: porcentaje,
                correctas: correctas,
                total: total,
                respuestas: respuestas,
                fecha: st(),
                intento: 1 // Se calcular谩 despu茅s
            };

            // Obtener todos los intentos anteriores para este quiz
            const intentosQuery = q(
                col(dbActual, 'quizzes_entrenamiento'),
                w('username', '==', username),
                w('quizId', '==', quizId)
            );
            
            const intentosSnapshot = await gd(intentosQuery);
            const numIntentos = intentosSnapshot.size;
            datosQuiz.intento = numIntentos + 1;

            // Guardar el nuevo intento
            await ad(col(dbActual, 'quizzes_entrenamiento'), datosQuiz);
            console.log(` Intento ${datosQuiz.intento} guardado para quiz ${quizId}: ${porcentaje}%`);
        }

        // Funci贸n para actualizar progreso (con estad铆sticas de m煤ltiples intentos)
        async function actualizarProgreso() {
            const dbActual = await obtenerDB();
            if (!dbActual) {
                console.warn('Firestore no disponible para actualizar progreso');
                return;
            }

            const authMgr = window.secureAuthManager || window.authManager;
            if (!authMgr || !authMgr.isAuthenticated()) {
                console.warn('Usuario no autenticado para actualizar progreso');
                return;
            }

            const user = authMgr.getCurrentUser();
            const username = user?.username || user?.email || 'unknown';
            console.log(' Actualizando progreso para usuario:', username);

            try {
                // Importar funciones de Firestore si no est谩n disponibles
                const firestoreModule = await import('https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js');
                const { collection: col, query: q, where: w, getDocs: gd } = firestoreModule;
                
                // Obtener todos los intentos de quizzes del usuario
                const quizzesRef = col(dbActual, 'quizzes_entrenamiento');
                const queryObj = q(quizzesRef, w('username', '==', username));
                const snapshot = await gd(queryObj);
                
                console.log(` Encontrados ${snapshot.size} intentos para usuario ${username}`);

                // Agrupar por quizId y calcular estad铆sticas
                const quizzesStats = {};
                const todosLosQuizzes = [
                    { id: 'firebase', nombre: 'Firebase', seccion: 'firebase' },
                    { id: 'cursor', nombre: 'Cursor AI', seccion: 'cursor-ai' },
                    { id: 'modulos', nombre: 'M贸dulos', seccion: 'modulos' },
                    { id: 'arquitectura', nombre: 'Arquitectura', seccion: 'arquitectura' },
                    { id: 'colecciones', nombre: 'Colecciones', seccion: 'colecciones-datos' },
                    { id: 'seguridad', nombre: 'Seguridad', seccion: 'seguridad-permisos' },
                    { id: 'inventario', nombre: 'Inventario', seccion: 'inventario-avanzado' },
                    { id: 'reportes', nombre: 'Reportes', seccion: 'reportes-analisis' },
                    { id: 'encuestas', nombre: 'Encuestas', seccion: 'encuestas-clientes' },
                    { id: 'rutas', nombre: 'Rutas', seccion: 'gestion-rutas' },
                    { id: 'empezar', nombre: 'C贸mo Empezar', seccion: 'empezar' },
                    { id: 'desarrollo', nombre: 'Desarrollo', seccion: 'desarrollo' },
                    { id: 'troubleshooting', nombre: 'Troubleshooting', seccion: 'troubleshooting' },
                    { id: 'prompts-fundamentos', nombre: 'Prompts: Fundamentos', seccion: 'prompts' },
                    { id: 'prompts-casos', nombre: 'Prompts: Casos', seccion: 'prompts' },
                    { id: 'prompts-peligrosos', nombre: 'Prompts: Peligrosos', seccion: 'prompts' },
                    { id: 'prompts', nombre: 'Prompts: General', seccion: 'prompts' }
                ];

                snapshot.forEach(doc => {
                    const data = doc.data();
                    const quizId = data.quizId;
                    
                    if (!quizzesStats[quizId]) {
                        quizzesStats[quizId] = {
                            completado: false,
                            totalIntentos: 0
                        };
                    }
                    
                    const porcentaje = data.porcentaje || 0;
                    quizzesStats[quizId].totalIntentos++;
                    
                    // Marcar como completado si hay al menos un intento con 100%
                    if (porcentaje === 100) {
                        quizzesStats[quizId].completado = true;
                    }
                });

                // Calcular progreso general (porcentaje de retos desbloqueados)
                let retosDesbloqueados = 0;
                todosLosQuizzes.forEach(quiz => {
                    const stats = quizzesStats[quiz.id];
                    if (stats && stats.completado) {
                        retosDesbloqueados++;
                    }
                });

                const promedioGeneral = Math.round((retosDesbloqueados / todosLosQuizzes.length) * 100);

                // Actualizar Dashboard Superior
                actualizarDashboardSuperior(quizzesStats, todosLosQuizzes, promedioGeneral, retosDesbloqueados);

                // Actualizar Secci贸n Mi Progreso
                const calificacionGeneral = document.getElementById('calificacion-general');
                const calificacionTexto = document.getElementById('calificacion-texto');
                const listaQuizzes = document.getElementById('lista-quizzes');

                if (calificacionGeneral) {
                    calificacionGeneral.style.width = promedioGeneral + '%';
                    calificacionGeneral.textContent = promedioGeneral + '%';
                }

                if (calificacionTexto) {
                    if (retosDesbloqueados === 0) {
                        calificacionTexto.textContent = 'Completa los retos para ver tu progreso';
                    } else {
                        calificacionTexto.textContent = `Progreso: ${retosDesbloqueados}/${todosLosQuizzes.length} retos desbloqueados (${promedioGeneral}%)`;
                    }
                }

                // Mostrar lista de quizzes con estad铆sticas (solo desbloqueo)
                if (listaQuizzes) {
                    let html = '<div class="row">';
                    todosLosQuizzesLista.forEach(quiz => {
                        const stats = quizzesStats[quiz.id];
                        if (stats && stats.completado) {
                            html += `
                                <div class="col-md-6 mb-3">
                                    <div class="quiz-badge completed">
                                        <i class="fas fa-check-circle me-2"></i>
                                        <strong>${quiz.nombre}</strong><br>
                                        <small>
                                             Desbloqueado | 
                                            Intentos: ${stats.totalIntentos}
                                        </small>
                                    </div>
                                </div>
                            `;
                        } else if (stats && stats.totalIntentos > 0) {
                            html += `
                                <div class="col-md-6 mb-3">
                                    <div class="quiz-badge pending">
                                        <i class="fas fa-clock me-2"></i>
                                        <strong>${quiz.nombre}</strong><br>
                                        <small>
                                             En Progreso | 
                                            Intentos: ${stats.totalIntentos}<br>
                                            <span style="color: #dc3545;">Necesitas 100%</span>
                                        </small>
                                    </div>
                                </div>
                            `;
                        } else {
                            html += `
                                <div class="col-md-6 mb-3">
                                    <div class="quiz-badge pending">
                                        <i class="fas fa-circle me-2"></i>
                                        ${quiz.nombre}: Pendiente
                                    </div>
                                </div>
                            `;
                        }
                    });
                    html += '</div>';
                    listaQuizzes.innerHTML = html;
                }
            } catch (error) {
                console.error('Error actualizando progreso:', error);
            }
        }

        // Funci贸n para navegar a un quiz
        window.irAQuiz = function(seccionId, quizId) {
            const seccion = document.getElementById(seccionId);
            if (seccion) {
                seccion.scrollIntoView({ behavior: 'smooth', block: 'start' });
                setTimeout(() => {
                    const quiz = document.querySelector(`[data-quiz-id="${quizId}"]`);
                    if (quiz) {
                        quiz.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }, 500);
            }
        };

        // Funci贸n para actualizar dashboard superior
        function actualizarDashboardSuperior(quizzesStats, todosLosQuizzes, promedioGeneral, retosDesbloqueados) {
            const dashboardContainer = document.getElementById('dashboard-quizzes');
            if (!dashboardContainer) return;

            let html = '<div class="row g-2">';
            
            todosLosQuizzes.forEach(quiz => {
                const stats = quizzesStats[quiz.id];
                const seccionId = quiz.seccion || quiz.id;
                const quizId = quiz.id;
                
                if (stats && stats.completado) {
                    // Reto desbloqueado (100%)
                    html += `
                        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                            <div class="quiz-progress-card" style="border-left: 4px solid #28a745; cursor: pointer; background: linear-gradient(135deg, rgba(40, 167, 69, 0.1) 0%, rgba(40, 167, 69, 0.05) 100%);" onclick="irAQuiz('${seccionId}', '${quizId}')">
                                <div class="quiz-progress-header">
                                    <h6 class="quiz-progress-title">${quiz.nombre}</h6>
                                    <button class="btn btn-sm btn-link p-0" onclick="event.stopPropagation(); irAQuiz('${seccionId}', '${quizId}')" style="color: var(--primary-color); text-decoration: none;" title="Ir al reto">
                                        <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                                <div class="quiz-progress-score">
                                    <span class="badge bg-success" style="font-size: 0.9rem; padding: 6px 12px;"> Desbloqueado</span>
                                </div>
                                <div class="quiz-progress-details">
                                    <small class="text-muted">
                                        <span class="reto-badge" style="font-size: 0.75rem; padding: 4px 8px;"> 100%</span><br>
                                        <i class="fas fa-redo"></i> ${stats.totalIntentos} intento${stats.totalIntentos > 1 ? 's' : ''}
                                    </small>
                                </div>
                            </div>
                        </div>
                    `;
                } else if (stats && stats.totalIntentos > 0) {
                    // Reto intentado pero no desbloqueado
                    html += `
                        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                            <div class="quiz-progress-card" style="border-left: 4px solid #ffc107; cursor: pointer;" onclick="irAQuiz('${seccionId}', '${quizId}')">
                                <div class="quiz-progress-header">
                                    <h6 class="quiz-progress-title">${quiz.nombre}</h6>
                                    <button class="btn btn-sm btn-link p-0" onclick="event.stopPropagation(); irAQuiz('${seccionId}', '${quizId}')" style="color: var(--primary-color); text-decoration: none;" title="Ir al reto">
                                        <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                                <div class="quiz-progress-score">
                                    <span class="badge bg-warning" style="font-size: 1rem; padding: 6px 12px;"> En Progreso</span>
                                </div>
                                <div class="quiz-progress-details">
                                    <small class="text-muted">
                                        <i class="fas fa-redo"></i> ${stats.totalIntentos} intento${stats.totalIntentos > 1 ? 's' : ''}<br>
                                        <span style="font-size: 0.8rem; color: #dc3545;">Necesitas 100%</span>
                                    </small>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // Reto no intentado
                    html += `
                        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
                            <div class="quiz-progress-card quiz-pending" style="border-left: 4px solid #ccc; cursor: pointer;" onclick="irAQuiz('${seccionId}', '${quizId}')">
                                <div class="quiz-progress-header">
                                    <h6 class="quiz-progress-title">${quiz.nombre}</h6>
                                    <button class="btn btn-sm btn-link p-0" onclick="event.stopPropagation(); irAQuiz('${seccionId}', '${quizId}')" style="color: var(--primary-color); text-decoration: none;" title="Ir al quiz">
                                        <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                                <div class="quiz-progress-score">
                                    <span class="badge bg-secondary">Pendiente</span>
                                </div>
                                <div class="quiz-progress-details">
                                    <small class="text-muted">A煤n no realizado</small>
                                </div>
                            </div>
                        </div>
                    `;
                }
            });

            // Agregar card de progreso general (barra de progreso)
            html += `
                <div class="col-12 mt-4">
                    <div class="quiz-progress-card" style="background: linear-gradient(135deg, var(--primary-color) 0%, #45a049 100%); color: white; border: none; padding: 20px;">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <h6 class="mb-0" style="color: white; font-size: 1.1rem;">
                                <i class="fas fa-trophy me-2"></i>Progreso General
                            </h6>
                            <span class="badge bg-light text-dark" style="font-size: 1.1rem; padding: 8px 14px; font-weight: bold;">
                                ${retosDesbloqueados}/${todosLosQuizzes.length} (${promedioGeneral}%)
                            </span>
                        </div>
                        <div class="progress" style="height: 25px; background-color: rgba(255, 255, 255, 0.3); border-radius: 12px;">
                            <div class="progress-bar bg-light" role="progressbar" style="width: ${promedioGeneral}%; font-weight: bold; color: var(--primary-color); display: flex; align-items: center; justify-content: center; font-size: 0.9rem;" aria-valuenow="${promedioGeneral}" aria-valuemin="0" aria-valuemax="100">
                                ${promedioGeneral}%
                            </div>
                        </div>
                        <small style="opacity: 0.9; margin-top: 8px; display: block;">
                            ${retosDesbloqueados === todosLosQuizzes.length ? ' 隆Todos los retos desbloqueados!' : `Faltan ${todosLosQuizzes.length - retosDesbloqueados} retos por desbloquear`}
                        </small>
                    </div>
                </div>
            `;

            html += '</div>';
            dashboardContainer.innerHTML = html;
        }

        // Cargar progreso al iniciar
        window.addEventListener('load', async () => {
            // Esperar a que auth se cargue
            await new Promise(resolve => setTimeout(resolve, 2000));
            await actualizarProgreso();
            // Verificar cooldowns de todos los quizzes despu茅s de autenticaci贸n
            setTimeout(() => {
                verificarCooldownsIniciales();
            }, 500);
        });
    </script>
</body>
</html>

