<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Script de Verificaci√≥n - Copiar</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #252526;
            padding: 20px;
            border-radius: 8px;
        }
        h1 {
            color: #4ec9b0;
        }
        .instructions {
            background: #1e1e1e;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #4ec9b0;
        }
        .code-block {
            background: #1e1e1e;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            border: 1px solid #3e3e42;
        }
        pre {
            margin: 0;
            color: #d4d4d4;
            font-size: 13px;
            line-height: 1.5;
        }
        .btn-copy {
            background: #0e639c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        .btn-copy:hover {
            background: #1177bb;
        }
        .success {
            color: #4ec9b0;
            margin-top: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìã Script de Verificaci√≥n del Sistema</h1>
        
        <div class="instructions">
            <h3>üìù Instrucciones:</h3>
            <ol>
                <li>Abre <strong>calendario.html</strong> o <strong>empleados.html</strong> en tu navegador</li>
                <li>Abre la consola del navegador (presiona <strong>F12</strong> o <strong>Ctrl+Shift+I</strong>)</li>
                <li>Haz clic en el bot√≥n "Copiar Script" de abajo</li>
                <li>Pega el c√≥digo en la consola y presiona <strong>Enter</strong></li>
            </ol>
        </div>

        <div class="code-block">
            <pre id="scriptCode">// Espera a que la p√°gina cargue completamente antes de ejecutar
setTimeout(async function() {
    console.log('\n' + '='.repeat(60));
    console.log('üîç VERIFICACI√ìN DEL SISTEMA');
    console.log('='.repeat(60) + '\n');

    const resultados = {
        exitosos: [],
        errores: [],
        advertencias: []
    };

    // 1. Verificar Firebase
    console.log('1Ô∏è‚É£ Verificando Firebase...');
    try {
        if (typeof firebase !== 'undefined' || window.db) {
            resultados.exitosos.push('‚úÖ Firebase SDK cargado');
            console.log('   ‚úÖ Firebase SDK cargado');
        } else {
            resultados.errores.push('‚ùå Firebase SDK no est√° disponible');
            console.log('   ‚ùå Firebase SDK no est√° disponible');
        }
    } catch (error) {
        resultados.errores.push(`‚ùå Error verificando Firebase: ${error.message}`);
        console.log(`   ‚ùå Error: ${error.message}`);
    }

    // 2. Verificar funciones de calendario
    console.log('\n2Ô∏è‚É£ Verificando funciones de calendario...');
    const funcionesCalendario = [
        'actualizarResumenFinanciero',
        'actualizarResumenFinancieroNew',
        'actualizarPrecioTotalServicios',
        'obtenerServiciosSeleccionados',
        'obtenerProductosSeleccionados'
    ];

    const paginaActual = window.location.pathname.split('/').pop() || '';
    const esCalendario = paginaActual.includes('calendario');

    if (!esCalendario) {
        console.log('   ‚ö†Ô∏è Estas funciones solo est√°n disponibles en calendario.html');
        console.log('   üí° Abre calendario.html para verificar estas funciones');
    }

    funcionesCalendario.forEach(func => {
        if (typeof window[func] === 'function') {
            resultados.exitosos.push(`‚úÖ Funci√≥n ${func} disponible`);
            console.log(`   ‚úÖ Funci√≥n ${func} disponible`);
        } else {
            if (esCalendario) {
                resultados.errores.push(`‚ùå Funci√≥n ${func} NO disponible`);
                console.log(`   ‚ùå Funci√≥n ${func} NO disponible`);
            } else {
                resultados.advertencias.push(`‚ö†Ô∏è Funci√≥n ${func} NO disponible (normal si no est√°s en calendario.html)`);
                console.log(`   ‚ö†Ô∏è Funci√≥n ${func} NO disponible`);
            }
        }
    });

    // 3. Verificar funciones de empleados
    console.log('\n3Ô∏è‚É£ Verificando funciones de empleados...');
    const funcionesEmpleados = [
        'cargarEmpleados',
        'mostrarEmpleados',
        'verificarCodigoDesbloqueo'
    ];

    const esEmpleados = paginaActual.includes('empleados');

    funcionesEmpleados.forEach(func => {
        if (typeof window[func] === 'function') {
            resultados.exitosos.push(`‚úÖ Funci√≥n ${func} disponible`);
            console.log(`   ‚úÖ Funci√≥n ${func} disponible`);
        } else {
            if (esEmpleados) {
                resultados.advertencias.push(`‚ö†Ô∏è Funci√≥n ${func} NO disponible`);
                console.log(`   ‚ö†Ô∏è Funci√≥n ${func} NO disponible`);
            } else {
                console.log(`   ‚ÑπÔ∏è Funci√≥n ${func} NO disponible (normal si no est√°s en empleados.html)`);
            }
        }
    });

    // 4. Verificar elementos DOM cr√≠ticos
    console.log('\n4Ô∏è‚É£ Verificando elementos DOM...');
    const elementosCriticos = [
        { id: 'editPrecioTotalServicios', desc: 'Input precio total servicios (editar)' },
        { id: 'newPrecioTotalServicios', desc: 'Input precio total servicios (nuevo)' },
        { id: 'editCostoServicio', desc: 'Input costo servicio (editar)' },
        { id: 'newCostoServicio', desc: 'Input costo servicio (nuevo)' },
        { id: 'totalServicios', desc: 'Display total servicios' },
        { id: 'totalCostos', desc: 'Display total costos' },
        { id: 'netoVenta', desc: 'Display neto venta' }
    ];

    elementosCriticos.forEach(elem => {
        const elemento = document.getElementById(elem.id);
        if (elemento) {
            resultados.exitosos.push(`‚úÖ Elemento ${elem.id} encontrado`);
            console.log(`   ‚úÖ ${elem.desc}: encontrado`);
        } else {
            if (esCalendario) {
                resultados.advertencias.push(`‚ö†Ô∏è Elemento ${elem.id} no encontrado`);
                console.log(`   ‚ö†Ô∏è ${elem.desc}: no encontrado`);
            } else {
                console.log(`   ‚ÑπÔ∏è ${elem.desc}: no encontrado (normal si no est√°s en calendario.html)`);
            }
        }
    });

    // 5. Verificar errores en consola
    console.log('\n5Ô∏è‚É£ Verificando errores en consola...');
    console.log('   ‚ÑπÔ∏è Revisa manualmente la consola para ver si hay errores en rojo');
    console.log('   ‚ÑπÔ∏è Los errores de "Tracking Prevention" son normales y no afectan el funcionamiento');

    // 6. Verificar p√°gina actual
    console.log('\n6Ô∏è‚É£ Informaci√≥n de la p√°gina actual...');
    console.log(`   üìÑ P√°gina actual: ${paginaActual}`);
    console.log(`   üìç URL completa: ${window.location.href}`);

    // Resumen final
    console.log('\n' + '='.repeat(60));
    console.log('üìä RESUMEN');
    console.log('='.repeat(60));
    console.log(`‚úÖ Exitosos: ${resultados.exitosos.length}`);
    console.log(`‚ùå Errores: ${resultados.errores.length}`);
    console.log(`‚ö†Ô∏è Advertencias: ${resultados.advertencias.length}`);
    console.log('='.repeat(60));

    if (resultados.errores.length === 0) {
        console.log('\n‚úÖ El sistema est√° funcionando correctamente');
    } else {
        console.log('\n‚ùå Se encontraron errores que requieren atenci√≥n:');
        resultados.errores.forEach(err => console.log(`   ${err}`));
    }

    if (resultados.advertencias.length > 0) {
        console.log('\n‚ö†Ô∏è Advertencias:');
        resultados.advertencias.forEach(adv => console.log(`   ${adv}`));
    }

    console.log('\nüí° NOTA: Algunas funciones y elementos solo est√°n disponibles en p√°ginas espec√≠ficas.');
    console.log('   - Funciones de calendario: solo en calendario.html');
    console.log('   - Funciones de empleados: solo en empleados.html');
    console.log('   - Para verificar Firebase Auth, necesitas estar autenticado\n');

    return resultados;
}, 3000); // Esperar 3 segundos antes de verificar</pre>
        </div>

        <button class="btn-copy" onclick="copiarScript()">üìã Copiar Script</button>
        <div class="success" id="successMsg">‚úÖ ¬°Script copiado al portapapeles!</div>
    </div>

    <script>
        function copiarScript() {
            const code = document.getElementById('scriptCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                const successMsg = document.getElementById('successMsg');
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 2000);
            }).catch(err => {
                alert('Error al copiar. Por favor, selecciona y copia el c√≥digo manualmente.');
            });
        }
    </script>
</body>
</html>
